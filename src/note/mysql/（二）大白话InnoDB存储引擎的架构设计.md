mysql,æ•°æ®åº“,sql


## 1ã€æ¦‚è¿° #

ä¸Šä¸€èŠ‚æˆ‘ä»¬å·²ç»åˆ†æžäº†MySQLæž¶æž„ä¸Šçš„æ•´ä½“è®¾è®¡åŽŸç†ï¼Œå¤§éƒ¨åˆ†äººåº”è¯¥å¯¹ä¸€æ¡SQLè¯­å¥çš„ä¸€æ­¥æ­¥æ‰§è¡Œæµç¨‹æœ‰äº†åˆæ­¥çš„æ•´ä½“äº†è§£ï¼Œå¯¹äºŽå…¶ä¸­çš„ç»†èŠ‚æˆ‘ä»¬ä¼šæ…¢æ…¢çš„åˆ†èŠ‚åŽ»è®²ã€‚

ç›¸ä¿¡å¤§éƒ¨åˆ†äººä½¿ç”¨MySQLï¼Œé€‰æ‹©çš„å­˜å‚¨å¼•æ“Žåº”è¯¥å°±æ˜¯**InnoDBå­˜å‚¨å¼•æ“Ž**ï¼Œæ‰€ä»¥åŽé¢çš„ç« èŠ‚ä¸»è¦åŸºäºŽInnoDBå­˜å‚¨å¼•æ“Žæ¥è®²ã€‚é‚£ä¹ˆä»Šå¤©æˆ‘ä»¬åŸºäºŽä¸€æ¡**æ›´æ–°è¯­å¥**çš„æ‰§è¡Œï¼Œæ¥åˆæ­¥çš„äº†è§£ä¸€ä¸‹InnoDBå­˜å‚¨å¼•æ“Žçš„æž¶æž„è®¾è®¡ã€‚

å‡å¦‚æˆ‘ä»¬éœ€è¦åœ¨ä¸šåŠ¡ç³»ç»Ÿéœ€è¦æ‰§è¡Œä¸€æ¡å¦‚ä¸‹çš„sqlæ¥æ›´æ–°æ•°æ®ï¼š

    update users set name='lisi' where id=2

é¦–å…ˆè®©æˆ‘ä»¬å›žæƒ³ä¸€ä¸‹è¿™ä¸ªsqlä¸€æ­¥æ­¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„ï¼Ÿå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š  
![ç¬‘å°æž«-www.xiaoxiaofeng.com](https://image.xiaoxiaofeng.site/spider/2022/11/2/xxf-1667354102127.jpg)  
å‰ä¸€èŠ‚æˆ‘ä»¬å·²ç»è®²è¿‡è¿™ä¸ªsqlæ‰§è¡Œè¿‡ç¨‹å¦‚ä¸‹ï¼Œé¦–å…ˆä¸šåŠ¡ç³»ç»Ÿé€šè¿‡è¿žæŽ¥æ± èŽ·å–ä¸€ä¸ªè¿žæŽ¥ï¼Œè¿žæŽ¥åˆ°mysqlæ•°æ®åº“ä¸Šï¼Œç„¶åŽä¼šç»è¿‡**SQLæŽ¥å£ã€è§£æžå™¨ã€ä¼˜åŒ–å™¨ã€æ‰§è¡Œå™¨å‡ ä¸ªçŽ¯èŠ‚**ï¼Œè§£æžSQLè¯­å¥ï¼Œç”Ÿæˆæ‰§è¡Œè®¡åˆ’ï¼Œç„¶åŽç”±æ‰§è¡Œå™¨è´Ÿè´£æŒ‰ç…§è¿™ä¸ªè®¡åˆ’ï¼ŒåŽ»è°ƒç”¨InnoDBå­˜å‚¨å¼•æ“Žçš„æŽ¥å£åŽ»æ‰§è¡ŒSQLã€‚

ä»Šå¤©æˆ‘ä»¬æ¥ä¸€èµ·æŽ¢ç´¢ä¸‹è¿™ä¸ªå­˜å‚¨å¼•æ“Žé‡Œçš„æž¶æž„è®¾è®¡ï¼Œä»¥åŠå¦‚ä½•åŸºäºŽå­˜å‚¨å¼•æ“Žå®Œæˆä¸€æ¡æ›´æ–°è¯­å¥çš„æ‰§è¡Œã€‚

## 2ã€InnoDBçš„é‡è¦å†…å­˜ç»“æž„ï¼šç¼“å†²æ±  #

ä»Šå¤©ç¬¬ä¸€ä¸ªé—ªäº®ç™»åœºçš„é‡è¦ç»„ä»¶æ˜¯ï¼š**ç¼“å†²æ± ï¼ˆBuffer Poolï¼‰**ã€‚ç¼“å†²æ± æ˜¯InnoDBå­˜å‚¨å¼•æ“Žä¸­æ”¾åœ¨å†…å­˜é‡Œçš„ä¸€ä¸ªç»„ä»¶ï¼Œè¿™é‡Œé¢ä¼šç¼“å­˜å¾ˆå¤šçš„æ•°æ®ï¼Œä»¥ä¾¿äºŽä»¥åŽåœ¨æŸ¥è¯¢çš„æ—¶å€™ï¼Œä¸‡ä¸€ä½ è¦æ˜¯å†…å­˜ç¼“å†²æ± é‡Œæœ‰æ•°æ®ï¼Œå°±å¯ä»¥ä¸ç”¨åŽ»æŸ¥ç£ç›˜äº†ï¼Œæˆ‘ä»¬çœ‹ä¸‹å›¾ï¼š  
![ç¬‘å°æž«-www.xiaoxiaofeng.com](https://image.xiaoxiaofeng.site/spider/2022/11/2/xxf-1667354103416.jpg)

æ‰€ä»¥å½“æˆ‘ä»¬çš„InnoDBå­˜å‚¨å¼•æ“Žè¦æ‰§è¡Œæ›´æ–°è¯­å¥çš„æ—¶å€™ ï¼Œæ¯”å¦‚å¯¹â€œid=2â€è¿™ä¸€è¡Œæ•°æ®è¿›è¡Œæ›´æ–°ï¼Œå…¶å®žä¼šå…ˆçœ‹çœ‹â€œid=2â€è¿™ä¸€è¡Œæ•°æ®æ˜¯å¦åœ¨å†…å­˜ç¼“å†²æ± é‡Œï¼Œå¦‚æžœä¸åœ¨çš„è¯ï¼Œé‚£ä¹ˆ**ä¼šç›´æŽ¥ä»Žç£ç›˜é‡ŒåŠ è½½åˆ°å†…å­˜ç¼“å†²æ± é‡Œæ¥**ï¼Œè€Œä¸”æŽ¥ç€è¿˜ä¼š**å¯¹è¿™è¡Œè®°å½•åŠ ç‹¬å é”**ã€‚  
![ç¬‘å°æž«-www.xiaoxiaofeng.com](https://image.xiaoxiaofeng.site/spider/2022/11/2/xxf-1667354104265.jpg)

## 3ã€undoæ—¥å¿—æ–‡ä»¶ï¼šå¦‚ä½•è®©ä½ æ›´æ–°çš„æ•°æ®å¯ä»¥å›žæ»šï¼Ÿ #

å…¶å®žæˆ‘ä»¬éƒ½åº”è¯¥çŸ¥é“ï¼Œæˆ‘ä»¬çŽ°åœ¨æ‰§è¡Œçš„æ˜¯ä¸€ä¸ªæ›´æ–°è¯­å¥ï¼Œä¸€èˆ¬éƒ½æ˜¯åœ¨ä¸€ä¸ªäº‹åŠ¡é‡Œè¿›è¡Œçš„ã€‚é‚£ä¹ˆäº‹åŠ¡æäº¤ä¹‹å‰ï¼Œå¦‚æžœä¸šåŠ¡æ‰§è¡Œå¤±è´¥ï¼Œæˆ‘ä»¬éœ€è¦å¯¹æ•°æ®è¿›è¡Œå›žæ»šçš„ï¼Œä¹Ÿå°±æ˜¯æŠŠâ€œid=2â€è¿™è¡Œæ•°æ®çš„nameï¼Œæ›´æ–°ä¸ºâ€œlisiâ€çš„æ–°å€¼å›žæ»šåˆ°ä¹‹å‰çš„â€œzhangsanâ€æ—§å€¼ã€‚

å¤§å®¶æ­¤æ—¶æƒ³ä¸‹è¦æ€Žä¹ˆè¿›è¡Œå›žæ»šå‘¢ï¼Ÿæœ€ç®€å•çš„åŠžæ³•å°±æ˜¯æŠŠè¿™æ¡æ•°æ®çš„æ—§å€¼â€œzhangsanâ€åœ¨æ›´æ–°ä¹‹å‰æ‰¾ä¸ªåœ°æ–¹å…ˆè®°å½•ä¸‹æ¥ï¼Œä»¥ä¾¿äºŽä»¥åŽçš„å›žæ»šã€‚

æ²¡é”™ï¼mysqlå°±æ˜¯è¿™æ ·åšçš„ï¼Œ**è®°å½•è¿™ä¸ªæ—§å€¼çš„ç»„ä»¶å«åšuodo log**ã€‚

æ­¤æ—¶ï¼Œå¯¹æˆ‘ä»¬æ¥è¯´ï¼Œâ€œid=2â€è¿™è¡Œæ•°æ®çš„nameåŽŸæ¥æ˜¯â€œzhangsanâ€ï¼ŒçŽ°åœ¨æˆ‘ä»¬å°†è¦æ›´æ–°ä¸ºâ€œlisiâ€ã€‚é‚£ä¹ˆæ­¤æ—¶æˆ‘ä»¬åœ¨æ›´æ–°å‰å¾—å…ˆæŠŠæ—§å€¼â€œzhangsanâ€å’Œâ€œid=2â€è¿™äº›ä¿¡æ¯ï¼Œ**å†™å…¥åˆ°undoæ—¥å¿—æ–‡ä»¶ä¸­åŽ»**ã€‚

æ‰€ä»¥è€ƒè™‘åˆ°æˆ‘ä»¬å¯èƒ½è¦å›žæ»šæ•°æ®åˆ°æ—§å€¼ï¼Œè¿™é‡Œä¼šæŠŠä½ æ›´æ–°å‰çš„å€¼å†™å…¥undoæ—¥å¿—æ–‡ä»¶ï¼Œæˆ‘ä»¬çœ‹ä¸‹å›¾ï¼š  
![ç¬‘å°æž«-www.xiaoxiaofeng.com](https://image.xiaoxiaofeng.site/spider/2022/11/2/xxf-1667354105074.jpg)

## 4ã€æ›´æ–°buffer poolä¸­çš„ç¼“å­˜æ•°æ® #

å½“æˆ‘ä»¬åšå®Œä¹‹å‰ä¸¤æ­¥ï¼š

1.  æŠŠè¦æ›´æ–°çš„é‚£è¡Œè®°å½•ä»Žç£ç›˜æ–‡ä»¶åŠ è½½åˆ°ç¼“å†²æ± ï¼ŒåŒæ—¶å¯¹è¿™è¡Œè®°å½•åŠ é”ä¹‹åŽ
2.  æ›´æ–°å‰çš„æ—§å€¼å†™å…¥undoæ—¥å¿—æ–‡ä»¶ä¹‹åŽ

æ­¤æ—¶æˆ‘ä»¬å°±å¯ä»¥æ­£å¼å¼€å§‹æ›´æ–°è¿™è¡Œè®°å½•äº†ï¼Œé‚£ä¹ˆæ›´æ–°çš„æ—¶å€™ï¼Œå­˜å‚¨å¼•æ“Žæ˜¯æ€Žä¹ˆåšçš„å‘¢ï¼Ÿå¤§å¤šæ•°äººéƒ½åº”è¯¥èƒ½æƒ³åˆ°ï¼š

 *  å…ˆæ›´æ–°å†…å­˜ç¼“å†²æ± ä¸­çš„è¿™æ¡è®°å½•ï¼Œæ­¤æ—¶è¿™ä¸ªæ•°æ®å°±æ˜¯è„æ•°æ®äº†ã€‚  
    psï¼šè¿™é‡Œæ‰€è°“çš„æ›´æ–°å†…å­˜ç¼“å†²æ± é‡Œçš„æ•°æ®ï¼Œæ„æ€å°±æ˜¯æŠŠå†…å­˜é‡Œçš„â€œid=2â€è¿™è¡Œæ•°æ®çš„nameå­—æ®µä¿®æ”¹ä¸ºâ€œlisiâ€ã€‚

é‚£ä¹ˆä¸ºä»€ä¹ˆè¯´æ­¤æ—¶è¿™è¡Œæ•°æ®å°±æ˜¯è„æ•°æ®äº†å‘¢ï¼Ÿ

å› ä¸ºè¿™ä¸ªæ—¶å€™ä»…ä»…åªæ˜¯æ›´æ–°äº†å†…å­˜ç¼“å†²æ± ä¸­æ•°æ®ï¼Œç£ç›˜ä¸Šâ€œid=2â€è¿™è¡Œæ•°æ®çš„nameå­—æ®µè¿˜æ˜¯â€œzhangsanâ€ï¼Œæ‰€ä»¥å°±ä¼šå«ä»–æ˜¯è„æ•°æ®ã€‚

å¦‚ä¸‹å›¾ï¼Œæ³¨æ„è®¤çœŸçœ‹æ‰§è¡Œçš„æ­¥éª¤çš„åºå·ï¼š  
![ç¬‘å°æž«-www.xiaoxiaofeng.com](https://image.xiaoxiaofeng.site/spider/2022/11/2/xxf-1667354105913.jpg)

## 5ã€Redo Log Bufferï¼šä¸‡ä¸€ç³»ç»Ÿå®•æœºï¼Œå¦‚ä½•é¿å…æ•°æ®ä¸¢å¤±ï¼Ÿ #

æŽ¥ç€æˆ‘ä»¬å†æ¥æ€è€ƒä¸€ä¸ªé—®é¢˜ï¼ŒæŒ‰ç…§ä¸Šå›¾çš„è¯´æ˜Žï¼ŒçŽ°åœ¨å·²ç»æŠŠå†…å­˜é‡Œçš„æ•°æ®è¿›è¡Œäº†ä¿®æ”¹ï¼Œä½†æ˜¯ç£ç›˜ä¸Šçš„æ•°æ®è¿˜æ²¡ä¿®æ”¹  
é‚£ä¹ˆæ­¤æ—¶ä¸‡ä¸€MySQLæ‰€åœ¨çš„æœºå™¨å®•æœºäº†ï¼Œå¿…ç„¶ä¼šå¯¼è‡´å†…å­˜é‡Œä¿®æ”¹è¿‡çš„æ•°æ®ä¸¢å¤±ï¼Œè¿™å¯æ€Žä¹ˆåŠžå‘¢ï¼Ÿ

è¿™ä¸ªæ—¶å€™ï¼Œå°±å¿…é¡»è¦æŠŠå¯¹å†…å­˜æ‰€åšçš„ä¿®æ”¹å†™å…¥åˆ°ä¸€ä¸ªåœ°æ–¹é‡ŒåŽ»ï¼Œè¿™ä¹Ÿæ˜¯å†…å­˜é‡Œçš„ä¸€ä¸ªç¼“å†²åŒºï¼Œç»„ä»¶åå­—å«**redoæ—¥å¿—**ã€‚  
**æ‰€è°“çš„redoæ—¥å¿—ï¼Œå°±æ˜¯è®°å½•ä¸‹æ¥ä½ å¯¹æ•°æ®åšäº†å“ªäº›ä¿®æ”¹**ï¼Œæ¯”å¦‚å¯¹â€œid=2è¿™è¡Œè®°å½•ä¿®æ”¹äº†nameå­—æ®µçš„å€¼ä¸ºlisiâ€ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªredoæ—¥å¿—ã€‚  
æˆ‘ä»¬å…ˆçœ‹ä¸‹å›¾çš„ç¤ºæ„ï¼š  
![ç¬‘å°æž«-www.xiaoxiaofeng.com](https://image.xiaoxiaofeng.site/spider/2022/11/2/xxf-1667354106875.jpg)  
è¿™ä¸ªredoæ—¥å¿—å…¶å®žæ˜¯**ç”¨æ¥åœ¨MySQLçªç„¶å®•æœºçš„æ—¶å€™ï¼Œç”¨æ¥æ¢å¤ä½ æ›´æ–°è¿‡çš„æ–°æ•°æ®**ï¼ŒåŽé¢ä¼šæœ‰ä¸“é—¨çš„ç« èŠ‚æ¥è®²è§£redoæ—¥å¿—ï¼ŒçŽ°åœ¨æˆ‘ä»¬ä»…éœ€è¦çŸ¥é“redoæ—¥å¿—é‡Œè®°å½•çš„æ˜¯ä»€ä¹ˆå’Œä¸»è¦ä½œç”¨å³å¯ã€‚

## 6ã€å¦‚æžœè¿˜æ²¡æäº¤äº‹åŠ¡ï¼ŒMySQLå®•æœºäº†æ€Žä¹ˆåŠžï¼Ÿ #

æˆ‘ä»¬éƒ½çŸ¥é“ï¼ŒInnoDBå­˜å‚¨å¼•æ“Žæ˜¯æ”¯æŒäº‹åŠ¡çš„ï¼Œå…¶å®žåœ¨æ•°æ®åº“ä¸­ï¼Œå“ªæ€•æ‰§è¡Œä¸€æ¡SQLè¯­å¥ï¼Œå…¶å®žä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„äº‹åŠ¡ï¼Œ**åªæœ‰å½“æˆ‘ä»¬æäº¤äº‹åŠ¡ä¹‹åŽï¼ŒSQLè¯­å¥æ‰ç®—æ‰§è¡Œç»“æŸ**ã€‚

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬ä»…æ˜¯å°†æ–°æ•°æ®å†™å…¥redoæ—¥å¿—ä¸­ï¼Œå…¶å®žè¿˜æ²¡æœ‰æäº¤äº‹åŠ¡ï¼Œé‚£ä¹ˆå¦‚æžœæ­¤æ—¶MySQLå´©æºƒï¼Œå¿…ç„¶å¯¼è‡´å†…å­˜é‡ŒBuffer Poolä¸­çš„ä¿®æ”¹è¿‡çš„æ•°æ®éƒ½ä¸¢å¤±ï¼ŒåŒæ—¶ä½ å†™å…¥Redo Log Bufferä¸­çš„redoæ—¥å¿—ä¹Ÿä¼šä¸¢å¤±ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š  
![ç¬‘å°æž«-www.xiaoxiaofeng.com](https://image.xiaoxiaofeng.site/spider/2022/11/2/xxf-1667354108467.jpg)  
é‚£ä¹ˆè¿™ä¸ªæ—¶å€™æ•°æ®ä¸¢å¤±è¦ç´§å—ï¼Ÿ

å…¶å®žæ˜¯ä¸è¦ç´§çš„ï¼Œå› ä¸ºä½ ä¸€æ¡æ›´æ–°è¯­å¥ï¼Œæ²¡æäº¤äº‹åŠ¡ï¼Œå°±ä»£è¡¨æ²¡æ‰§è¡ŒæˆåŠŸï¼Œä»ç„¶æ˜¯ä¿æŒç€æ•°æ®çš„ä¸€è‡´æ€§ã€‚å› ä¸ºæ­¤æ—¶MySQLå®•æœºè™½ç„¶å¯¼è‡´å†…å­˜é‡Œçš„æ•°æ®éƒ½ä¸¢å¤±äº†ï¼Œä½†æ˜¯ä½ ä¼šå‘çŽ°ï¼Œç£ç›˜ä¸Šçš„æ•°æ®ä¾ç„¶è¿˜åœç•™åœ¨åŽŸæ ·å­ã€‚

ä¹Ÿå°±æ˜¯è¯´ï¼Œâ€œid=2â€çš„é‚£è¡Œæ•°æ®çš„nameå­—æ®µçš„å€¼è¿˜æ˜¯è€çš„å€¼ï¼Œâ€œzhangsanâ€ï¼Œæ‰€ä»¥æ­¤æ—¶ä½ çš„è¿™ä¸ªäº‹åŠ¡å°±æ˜¯æ‰§è¡Œå¤±è´¥äº†ï¼Œæ²¡èƒ½æˆåŠŸå®Œæˆæ›´æ–°ï¼Œä½ ä¼šæ”¶åˆ°ä¸€ä¸ªæ•°æ®åº“çš„å¼‚å¸¸ã€‚ç„¶åŽå½“mysqlé‡å¯ä¹‹åŽï¼Œä½ ä¼šå‘çŽ°ä½ çš„æ•°æ®å¹¶æ²¡æœ‰ä»»ä½•å˜åŒ–ã€‚

æ‰€ä»¥æ­¤æ—¶å¦‚æžœmysqlæœåŠ¡å™¨å®•æœºï¼Œä¸ä¼šæœ‰ä»»ä½•çš„é—®é¢˜ã€‚

## 7ã€æäº¤äº‹åŠ¡çš„æ—¶å€™å°†redoæ—¥å¿—å†™å…¥ç£ç›˜ä¸­ #

ä¸Šé¢æ˜¯å› ä¸ºæ²¡æœ‰æäº¤äº‹åŠ¡ï¼Œæ‰€ä»¥mysqlæœåŠ¡å™¨å®•æœºå½±å“ä¸å¤§ã€‚ä½†æ˜¯æŽ¥ç€æˆ‘ä»¬å‡†å¤‡æäº¤äº‹åŠ¡äº†ï¼Œæ­¤æ—¶å¤§å®¶å¯èƒ½æƒ³åˆ°çš„æ˜¯æˆ‘ä»¬æ˜¯ä¸æ˜¯åº”è¯¥å°†redoæ—¥å¿—ä»Žå†…å­˜ä¸­å†™å…¥ç£ç›˜åŽ»ï¼Ÿä»Žè€Œæ¥é¿å…msyqlå®•æœºé€ æˆçš„æ•°æ®ä¸ä¸€è‡´ã€‚

æ²¡é”™ï¼ŒæŽ¥ç€æˆ‘ä»¬è¦æäº¤äº‹åŠ¡äº†ï¼Œæ­¤æ—¶å­˜å‚¨å¼•æ“Žæ˜¯è¦æŠŠredoæ—¥å¿—ä»Žredo log bufferé‡Œåˆ·å…¥åˆ°ç£ç›˜æ–‡ä»¶é‡ŒåŽ»ã€‚åœ¨æ­¤é¢å¤–è¡¥å……ä¸€ç‚¹ï¼Œå†…å­˜æ•°æ®å†™å…¥ç£ç›˜ä¸­ä¸€èˆ¬å¹¶ä¸æ˜¯ç›´æŽ¥å†™å…¥ç£ç›˜ï¼Œè€Œæ˜¯**å…ˆå†™å…¥ç£ç›˜çš„æ–‡ä»¶ç³»ç»Ÿç¼“å­˜ä¸­ï¼ˆos cacheï¼‰ï¼Œå†åˆ·å…¥ï¼ˆflushï¼‰ç£ç›˜ä¸­**ã€‚

InnoDBæä¾›äº†å‡ ç§åˆ·ç›˜ç­–ç•¥ï¼Œæ­¤æ—¶è¿™ä¸ªç­–ç•¥æ˜¯é€šè¿‡**innodb\_flush\_log\_at\_trx\_commit**æ¥é…ç½®çš„ï¼Œå®ƒæœ‰å‡ ä¸ªé€‰é¡¹å¦‚ä¸‹ï¼š

 *  **innodb\_flush\_log\_at\_trx\_commit=0**ï¼Œè¡¨ç¤ºæ¯éš”ä¸€ç§’æŠŠredo log bufferåˆ·åˆ°ç£ç›˜æ–‡ä»¶ç³»ç»Ÿä¸­(os cache)åŽ»ï¼Œå¹¶ä¸”è°ƒç”¨æ–‡ä»¶ç³»ç»Ÿçš„â€œflushâ€æ“ä½œå°†ç¼“å­˜åˆ·æ–°åˆ°ç£ç›˜ä¸ŠåŽ»ã€‚  
    ä¹Ÿå°±æ˜¯è¯´ä¸€ç§’ä¹‹å‰çš„æ—¥å¿—éƒ½ä¿å­˜åœ¨å†…å­˜ç¼“å†²åŒºï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æžœmysqlæœºå™¨å®•æŽ‰ï¼Œæœ€æžç«¯çš„æƒ…å†µæ˜¯å¯èƒ½ä¸¢å¤±1ç§’çš„æ•°æ®å˜æ›´ã€‚  
    ![ç¬‘å°æž«-www.xiaoxiaofeng.com](https://image.xiaoxiaofeng.site/spider/2022/11/2/xxf-1667354109437.jpg)
 *  **innodb\_flush\_log\_at\_trx\_commit=1**ï¼Œè¡¨ç¤ºåœ¨æ¯æ¬¡äº‹åŠ¡æäº¤çš„æ—¶å€™ï¼Œéƒ½ä¼šæŠŠredo log bufferåˆ·åˆ°ç£ç›˜æ–‡ä»¶ç³»ç»Ÿä¸­(os cache)åŽ»ï¼Œå¹¶ç«‹åˆ»è°ƒç”¨æ–‡ä»¶ç³»ç»Ÿçš„â€œflushâ€æ“ä½œå°†ç¼“å­˜åˆ·æ–°åˆ°ç£ç›˜ä¸ŠåŽ»ã€‚  
    **è¿™ä¸ªè®¾ç½®æ˜¯æœ€å®‰å…¨çš„è®¾ç½®ï¼Œèƒ½å¤Ÿä¿è¯ä¸è®ºæ˜¯MySQL Crash è¿˜æ˜¯OS Crashæˆ–è€…æ˜¯ä¸»æœºæ–­ç”µéƒ½ä¸ä¼šä¸¢å¤±ä»»ä½•å·²ç»æäº¤çš„æ•°æ®**ã€‚ä½†æ˜¯è¿™æ ·çš„è¯ï¼Œæ•°æ®åº“å¯¹ç£ç›˜IOçš„è¦æ±‚å°±éžå¸¸é«˜äº†ï¼Œå¦‚æžœåº•å±‚çš„ç¡¬ä»¶æ¯”è¾ƒå·®ï¼Œé‚£ä¹ˆMySQLæ•°æ®åº“çš„å¹¶å‘å¾ˆå¿«å°±ä¼šç”±äºŽç¡¬ä»¶IOçš„é—®é¢˜è€Œæ— æ³•æå‡ï¼Œä¼šå¤§å¤§é™ä½Žmysqlçš„æ€§èƒ½ã€‚  
    ![ç¬‘å°æž«-www.xiaoxiaofeng.com](https://image.xiaoxiaofeng.site/spider/2022/11/2/xxf-1667354111255.jpg)
 *  **innodb\_flush\_log\_at\_trx\_commit=2**ï¼Œè¡¨ç¤ºåœ¨æ¯æ¬¡äº‹åŠ¡æäº¤çš„æ—¶å€™ä¼šæŠŠredo log bufferåˆ·åˆ°ç£ç›˜æ–‡ä»¶ç³»ç»Ÿä¸­(os cache)åŽ»ï¼Œä½†å¹¶ä¸ä¼šç«‹å³åˆ·å†™åˆ°ç£ç›˜ï¼Œæ¯éš”1s å°†os cacheä¸­çš„æ•°æ®åˆ·æ–°åˆ°ç£ç›˜ã€‚  
    å¦‚æžœåªæ˜¯MySQLæ•°æ®åº“æŒ‚æŽ‰äº†ï¼ˆMySQL Crashï¼‰ï¼Œ**ç”±äºŽæ–‡ä»¶ç³»ç»Ÿæ²¡æœ‰é—®é¢˜ï¼Œé‚£ä¹ˆå¯¹åº”çš„äº‹åŠ¡æ•°æ®å¹¶æ²¡æœ‰ä¸¢å¤±**ã€‚åªæœ‰åœ¨æ•°æ®åº“æ‰€åœ¨çš„ä¸»æœºæ“ä½œç³»ç»ŸæŸåæˆ–è€…çªç„¶æŽ‰ç”µçš„æƒ…å†µä¸‹ï¼Œæ•°æ®åº“çš„äº‹åŠ¡æ•°æ®å¯èƒ½ä¸¢å¤±1ç§’ä¹‹ç±»çš„äº‹åŠ¡æ•°æ®ã€‚è¿™æ ·çš„å¥½å¤„ï¼Œå‡å°‘äº†äº‹åŠ¡æ•°æ®ä¸¢å¤±çš„æ¦‚çŽ‡ï¼Œè€Œå¯¹åº•å±‚ç¡¬ä»¶çš„IOè¦æ±‚ä¹Ÿæ²¡æœ‰é‚£ä¹ˆé«˜(log bufferå†™åˆ°æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œä¸€èˆ¬åªæ˜¯ä»Žlog bufferçš„å†…å­˜è½¬ç§»çš„æ–‡ä»¶ç³»ç»Ÿçš„å†…å­˜ç¼“å­˜(os cache)ä¸­ï¼Œå¯¹åº•å±‚IOæ²¡æœ‰åŽ‹åŠ›)ã€‚  
    ![ç¬‘å°æž«-www.xiaoxiaofeng.com](https://image.xiaoxiaofeng.site/spider/2022/11/2/xxf-1667354113396.jpg)

**æ€»ç»“å¦‚ä¸‹ï¼š**

    é¦–å…ˆéœ€è¦å¤§è‡´äº†è§£ä¸€ä¸‹mysqlæ—¥å¿—æ“ä½œæ­¥éª¤ï¼š
    log_buff ---> os cache --->OSåˆ·æ–° (flush)---> disk
    
    innodb_flush_log_at_trx_commit å‚æ•°è§£é‡Šï¼š
    0ï¼ˆå»¶è¿Ÿå†™ï¼‰ï¼š        log_buff  â€”> æ¯éš”1ç§’   â€”>  os cache  â€”>å®žæ—¶---â€”>  disk
    1ï¼ˆå®žæ—¶å†™ï¼Œå®žæ—¶åˆ·ï¼‰ï¼š log_buff  â€”>   å®žæ—¶    â€”>  os cache  â€”>å®žæ—¶---â€”>  disk
    2ï¼ˆå®žæ—¶å†™ï¼Œå»¶è¿Ÿåˆ·ï¼‰ï¼š log_buff  â€”>   å®žæ—¶    â€”>  os cache  â€”>æ¯éš”1ç§’â€”>  disk

å‡è®¾æ­¤æ—¶æäº¤äº‹åŠ¡æˆåŠŸä¹‹åŽï¼Œredoæ—¥å¿—ä¹Ÿå†™åœ¨ç£ç›˜æ–‡ä»¶é‡Œï¼Œæ­¤æ—¶ä½ è‚¯å®šä¼šæœ‰ä¸€æ¡redoæ—¥å¿—è®°å½•å¦‚ä¸‹å†…å®¹ï¼šâ€œæˆ‘æ­¤æ—¶å¯¹å“ªä¸ªæ•°æ®åšäº†ä¸€ä¸ªä»€ä¹ˆä¿®æ”¹ï¼Œæ¯”å¦‚nameå­—æ®µä¿®æ”¹ä¸ºlisiäº†â€ã€‚

ç„¶åŽå“ªæ€•æ­¤æ—¶buffer poolä¸­æ›´æ–°è¿‡çš„æ•°æ®è¿˜æ²¡åˆ·æ–°åˆ°ç£ç›˜é‡ŒåŽ»ï¼Œæ­¤æ—¶å†…å­˜é‡Œçš„æ•°æ®æ˜¯å·²ç»æ›´æ–°è¿‡çš„â€œname=lisiâ€ï¼Œç„¶åŽç£ç›˜ä¸Šçš„æ•°æ®è¿˜æ˜¯æ²¡æ›´æ–°è¿‡çš„â€œname=zhangsanâ€ã€‚

æˆ‘ä»¬çœ‹ä¸‹å›¾ï¼Œæäº¤äº‹åŠ¡ä¹‹åŽï¼Œå¯èƒ½å¤„äºŽçš„ä¸€ä¸ªçŠ¶æ€ï¼Œ**Buffer Poolå’Œredoæ—¥å¿—ä¸­éƒ½æ˜¯æ›´æ–°åŽçš„æ–°å€¼ï¼Œè€Œç£ç›˜ä¸­åˆ™æ˜¯æ—§å€¼**ã€‚  
![ç¬‘å°æž«-www.xiaoxiaofeng.com](https://image.xiaoxiaofeng.site/spider/2022/11/2/xxf-1667354115305.jpg)

**æ­¤æ—¶å¦‚æžœè¯´æäº¤äº‹åŠ¡åŽå¤„äºŽä¸Šå›¾çš„çŠ¶æ€ï¼Œç„¶åŽmysqlç³»ç»Ÿçªç„¶å´©æºƒäº†ï¼Œæ­¤æ—¶ä¼šå¦‚ä½•ï¼Ÿä¼šä¸¢å¤±æ•°æ®å—ï¼Ÿ**  
ç­”æ¡ˆæ˜¯**ä¸ä¼šä¸¢å¤±**ã€‚å› æ­¤ç­‰mysqlé‡å¯ä¹‹åŽï¼ŒinnoDBå¯ä»¥æ ¹æ®redoæ—¥å¿—åŽ»æ¢å¤ä¹‹å‰åšè¿‡çš„ä¿®æ”¹ï¼Œå¦‚ä¸‹å›¾ï¼š  
![ç¬‘å°æž«-www.xiaoxiaofeng.com](https://image.xiaoxiaofeng.site/spider/2022/11/2/xxf-1667354116197.jpg)  
é‚£ä¹ˆç£ç›˜ä¸­æ•°æ®ä»€ä¹ˆæ—¶å€™ä¼šæ›´æ–°ä¼šæ–°å€¼ï¼Œå¹¶ä¸”æ€Žä¹ˆæ›´æ–°ä¼šæ–°å€¼ï¼Œè¯·çœ‹ä¸‹ä¸€ç« èŠ‚ã€‚  

## å…³äºŽç¬‘å°æž«ðŸ’•

> æœ¬ç« åˆ°è¿™é‡Œç»“æŸäº†ï¼Œå–œæ¬¢çš„æœ‹å‹å…³æ³¨ä¸€ä¸‹æˆ‘å‘¦ï¼Œå¤§ä¼™çš„æ”¯æŒï¼Œå°±æ˜¯æˆ‘åšæŒå†™ä¸‹åŽ»çš„åŠ¨åŠ›ã€‚
>
> å¾®ä¿¡å…¬ä¼—å·ï¼šç¬‘å°æž«
>
> ç¬‘å°æž«ä¸ªäººåšå®¢ï¼š[https://www.xiaoxiaofeng.com](https://www.xiaoxiaofeng.com)
>
> CSDNï¼š[https://zhangfz.blog.csdn.net](https://zhangfz.blog.csdn.net)



