MySQLæ˜¯å¦‚ä½•åŸºäºŽå†·çƒ­æ•°æ®åˆ†ç¦»çš„æ–¹æ¡ˆï¼Œæ¥ä¼˜åŒ–LRUç®—æ³•



## 1ã€LRUé“¾è¡¨æ·˜æ±°ç¼“å­˜é¡µçš„é—®é¢˜ #

å‰é¢ç« èŠ‚å·²ç»è®²è¿‡Buffer Poolçš„ç¼“å­˜é¡µå…¨éƒ¨ç”¨å…‰äº†ï¼Œä¼šæŠŠLRUé“¾è¡¨å°¾éƒ¨çš„ç¼“å­˜é¡µæ•°æ®åˆ·å…¥ç£ç›˜ï¼Œè…¾å‡ºç©ºé—²é¡µã€‚æ–°åŠ è½½çš„æ•°æ®ä¼šæ”¾åœ¨LRUé“¾è¡¨å¤´éƒ¨ï¼Œåˆšè®¿é—®çš„æ•°æ®ä¹Ÿä¼šç§»åŠ¨åˆ°LRUé“¾è¡¨çš„å¤´éƒ¨ã€‚

ä½†æ˜¯è¿™æ ·çš„ä¸€ä¸ªLRUæœºåˆ¶åœ¨å®žé™…è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œä¼šæœ‰é—®é¢˜å—ï¼Ÿ

### 1.1 MySQLçš„é¢„è¯»æœºåˆ¶å¸¦æ¥çš„é—®é¢˜ ##

é¦–å…ˆä¼šå¸¦æ¥éšæ‚£çš„å°±æ˜¯MySQLçš„é¢„è¯»æœºåˆ¶ï¼Œè¿™ä¸ªæ‰€è°“**é¢„è¯»æœºåˆ¶ï¼Œå°±æ˜¯å½“MySQLä»Žç£ç›˜ä¸ŠåŠ è½½ä¸€ä¸ªæ•°æ®é¡µçš„æ—¶å€™ï¼Œå¯èƒ½ä¼šè¿žå¸¦ç€æŠŠè¿™ä¸ªæ•°æ®é¡µç›¸é‚»çš„å…¶ä»–æ•°æ®é¡µï¼Œä¹ŸåŠ è½½åˆ°ç¼“å­˜é‡ŒåŽ»**ã€‚

ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾çŽ°åœ¨æœ‰ä¸¤ä¸ªç©ºé—²ç¼“å­˜é¡µï¼Œç„¶åŽåœ¨åŠ è½½ä¸€ä¸ªæ•°æ®é¡µçš„æ—¶å€™ï¼Œè¿žå¸¦ç€æŠŠå®ƒç›¸é‚»çš„ä¸€ä¸ªæ•°æ®é¡µä¹ŸåŠ è½½åˆ°ç¼“å­˜é‡ŒåŽ»äº†ï¼Œæ­£å¥½æ¯ä¸ªæ•°æ®é¡µæ”¾å…¥ä¸€ä¸ªç©ºé—²ç¼“å­˜é¡µï¼

ä½†æ˜¯æŽ¥ä¸‹æ¥ï¼Œå®žé™…ä¸Šåªæœ‰ä¸€ä¸ªç¼“å­˜é¡µæ˜¯è¢«è®¿é—®äº†ï¼Œå¦å¤–ä¸€ä¸ªé€šè¿‡é¢„è¯»æœºåˆ¶åŠ è½½çš„ç¼“å­˜é¡µï¼Œå…¶å®žå¹¶æ²¡æœ‰ä»»ä½•è®¿é—®ï¼Œä½†æ­¤æ—¶è¿™ä¸¤ä¸ªç¼“å­˜é¡µå¯éƒ½åœ¨LRUé“¾è¡¨çš„å¤´éƒ¨ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š  
![ç¬‘å°æž«-www.xiaoxiaofeng.com](https://image.xiaoxiaofeng.site/spider/2022/11/2/xxf-1667354751512.jpg)

ä»Žä¸Šå›¾å¯ä»¥çœ‹åˆ°ï¼Œå‰ä¸¤ä¸ªç¼“å­˜é¡µéƒ½æ˜¯åˆšåŠ è½½è¿›æ¥çš„ï¼Œä½†æ˜¯æ­¤æ—¶ç¬¬äºŒä¸ªç¼“å­˜é¡µæ˜¯é€šè¿‡é¢„è¯»æœºåˆ¶æŽå¸¦ç€åŠ è½½è¿›æ¥çš„ï¼Œå®ƒä¹Ÿè¢«æ”¾åˆ°äº†é“¾è¡¨çš„å‰é¢ï¼Œä½†æ˜¯å®žé™…æ²¡äººè®¿é—®å®ƒã€‚é™¤äº†ç¬¬äºŒä¸ªç¼“å­˜é¡µä¹‹å¤–ï¼Œç¬¬ä¸€ä¸ªç¼“å­˜é¡µï¼Œä»¥åŠå°¾å·´ä¸Šä¸¤ä¸ªç¼“å­˜é¡µï¼Œéƒ½æ˜¯ä¸€ç›´æœ‰äººè®¿é—®çš„é‚£ç§ç¼“å­˜é¡µã€‚

åœ¨è¿™ä¸ªæ—¶å€™ï¼Œå‡å¦‚æ²¡æœ‰ç©ºé—²ç¼“å­˜é¡µäº†ï¼Œé‚£ä¹ˆæ­¤æ—¶è¦åŠ è½½æ–°çš„æ•°æ®é¡µäº†ï¼Œå°±è¦ä»ŽLRUé“¾è¡¨çš„å°¾éƒ¨æŠŠæ‰€è°“çš„â€œæœ€è¿‘æœ€å°‘ä½¿ç”¨çš„ä¸€ä¸ªç¼“å­˜é¡µâ€ç»™æ‹¿å‡ºæ¥ï¼Œåˆ·å…¥ç£ç›˜ï¼Œç„¶åŽè…¾å‡ºæ¥ä¸€ä¸ªç©ºé—²ç¼“å­˜é¡µäº†ã€‚è€Œå¦‚æžœä½ æŠŠä¸Šå›¾ä¸­LRUå°¾éƒ¨çš„é‚£ä¸ªç¼“å­˜é¡µåˆ·å…¥ç£ç›˜ç„¶åŽæ¸…ç©ºï¼Œä½ è§‰å¾—åˆç†å—ï¼Ÿ

è¿™æ˜¯ç»å¯¹ä¸åˆç†çš„ï¼Œæœ€åˆç†çš„åè€Œæ˜¯æŠŠä¸Šå›¾ä¸­LRUé“¾è¡¨çš„ç¬¬äºŒä¸ªé€šè¿‡é¢„è¯»æœºåˆ¶åŠ è½½è¿›æ¥çš„ç¼“å­˜é¡µç»™åˆ·å…¥ç£ç›˜å’Œæ¸…ç©ºï¼Œæ¯•ç«Ÿå®ƒå‡ ä¹Žæ˜¯æ²¡ä»€ä¹ˆäººä¼šè®¿é—®çš„ï¼

### 1.2 å“ªäº›æƒ…å†µä¸‹ä¼šè§¦å‘MySQLçš„é¢„è¯»æœºåˆ¶ï¼Ÿ ##

çŽ°åœ¨æˆ‘ä»¬å·²ç»ç†è§£äº†é¢„è¯»æœºåˆ¶ä¸€ä¸‹å­æŠŠç›¸é‚»çš„æ•°æ®é¡µåŠ è½½è¿›ç¼“å­˜ï¼Œæ”¾å…¥LRUé“¾è¡¨å‰é¢çš„éšæ‚£äº†ï¼Œé¢„è¯»æœºåˆ¶åŠ è½½è¿›æ¥çš„ç¼“å­˜é¡µå¯èƒ½æ ¹æœ¬ä¸ä¼šæœ‰äººè®¿é—®ï¼Œç»“æžœå®ƒå´æ”¾åœ¨äº†LRUé“¾è¡¨çš„å‰é¢ï¼Œæ­¤æ—¶å¯èƒ½ä¼šæŠŠLRUå°¾éƒ¨çš„é‚£äº›è¢«é¢‘ç¹è®¿é—®çš„ç¼“å­˜é¡µåˆ·å…¥ç£ç›˜ä¸­ï¼

æ‰€ä»¥æˆ‘ä»¬æ¥çœ‹çœ‹ï¼Œåˆ°åº•å“ªäº›æƒ…å†µä¸‹ä¼šè§¦å‘MySQLçš„é¢„è¯»æœºåˆ¶å‘¢ï¼Ÿ

 *  MySQLæœ‰ä¸€ä¸ªå‚æ•°æ˜¯innodb\_read\_ahead\_thresholdï¼Œé»˜è®¤å€¼æ˜¯56ï¼Œæ„æ€å°±æ˜¯**å¦‚æžœé¡ºåºçš„è®¿é—®äº†ä¸€ä¸ªåŒºé‡Œçš„å¤šä¸ªæ•°æ®é¡µï¼Œè®¿é—®çš„æ•°æ®é¡µçš„æ•°é‡è¶…è¿‡äº†è¿™ä¸ªé˜ˆå€¼ï¼Œæ­¤æ—¶å°±ä¼šè§¦å‘é¢„è¯»æœºåˆ¶ï¼ŒæŠŠä¸‹ä¸€ä¸ªç›¸é‚»åŒºä¸­çš„æ‰€æœ‰æ•°æ®é¡µéƒ½åŠ è½½åˆ°ç¼“å­˜é‡ŒåŽ»**ï¼›
 *  MySQLè¿˜æœ‰å¦å¤–ä¸€ä¸ªåœºæ™¯ä¼šè§¦å‘é¢„è¯»æœºåˆ¶ï¼Œ**å¦‚æžœBuffer Poolé‡Œç¼“å­˜äº†ä¸€ä¸ªåŒºé‡Œçš„13ä¸ªè¿žç»­çš„æ•°æ®é¡µï¼Œè€Œä¸”è¿™äº›æ•°æ®é¡µéƒ½æ˜¯æ¯”è¾ƒé¢‘ç¹ä¼šè¢«è®¿é—®çš„ï¼Œæ­¤æ—¶å°±ä¼šç›´æŽ¥è§¦å‘é¢„è¯»æœºåˆ¶ï¼ŒæŠŠè¿™ä¸ªåŒºé‡Œçš„å…¶ä»–çš„æ•°æ®é¡µéƒ½åŠ è½½åˆ°ç¼“å­˜é‡ŒåŽ»**ã€‚è¿™ä¸ªæœºåˆ¶æ˜¯é€šè¿‡å‚æ•°innodb\_random\_read\_aheadæ¥æŽ§åˆ¶çš„ï¼Œé»˜è®¤å€¼æ˜¯OFFï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ªé»˜è®¤è§„åˆ™æ˜¯å…³é—­çš„ã€‚

æ‰€ä»¥é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸»è¦æ˜¯ç¬¬ä¸€ä¸ªè§„åˆ™å¯èƒ½ä¼šè§¦å‘é¢„è¯»æœºåˆ¶ï¼Œä¸€ä¸‹å­æŠŠå¾ˆå¤šç›¸é‚»åŒºé‡Œçš„æ•°æ®é¡µåŠ è½½åˆ°ç¼“å­˜é‡ŒåŽ»ï¼Œè¿™äº›ç¼“å­˜é¡µå¦‚æžœä¸€ä¸‹å­éƒ½æ”¾åœ¨LRUé“¾è¡¨çš„å‰é¢ï¼Œè€Œä¸”å®ƒä»¬å…¶å®žå¹¶æ²¡ä»€ä¹ˆäººä¼šè®¿é—®çš„è¯ï¼Œé‚£å°±ä¼šå¦‚ä¸Šå›¾ï¼Œå¯¼è‡´æœ¬æ¥å°±åœ¨ç¼“å­˜é‡Œçš„ä¸€äº›é¢‘ç¹è¢«è®¿é—®çš„ç¼“å­˜é¡µåœ¨LRUé“¾è¡¨çš„å°¾éƒ¨ã€‚

è¿™æ ·çš„è¯ï¼Œä¸€æ—¦è¦æŠŠä¸€äº›ç¼“å­˜é¡µæ·˜æ±°æŽ‰ï¼Œåˆ·å…¥ç£ç›˜ï¼Œè…¾å‡ºæ¥ç©ºé—²ç¼“å­˜é¡µï¼Œå°±ä¼šå¦‚ä¸Šæ‰€è¿°ï¼ŒæŠŠLRUé“¾è¡¨å°¾éƒ¨ä¸€äº›é¢‘ç¹è¢«è®¿é—®çš„ç¼“å­˜é¡µç»™åˆ·å…¥ç£ç›˜å’Œæ¸…ç©ºæŽ‰äº†ï¼è¿™æ˜¯å®Œå…¨ä¸åˆç†çš„ï¼Œå¹¶ä¸åº”è¯¥è¿™æ ·ï¼

é‚£ä¹ˆå¯èƒ½æœ‰äººé—®äº†ï¼ŒMySQLä¸ºä»€ä¹ˆè¦è®¾è®¡ä¸€ä¸ªé¢„è¯»æœºåˆ¶ï¼Œä¸ºä»€ä¹ˆè¦æŠŠç›¸é‚»çš„æ•°æ®é¡µä¸€èµ·å†™å…¥Buffer Poolä¸­åŽ»å‘¢ï¼Ÿ  
å…¶å®žé“ç†å¾ˆç®€å•ï¼Œ**ä¸ºäº†å‡å°‘ç£ç›˜IOï¼Œæå‡æ€§èƒ½**ã€‚MySQLè®¾è®¡äº†é¢„è¯»æœºåˆ¶ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æžœåœ¨ä¸€ä¸ªåŒºå†…ï¼Œä½ é¡ºåºè¯»å–äº†å¥½å¤šæ•°æ®é¡µäº†ï¼Œæ¯”å¦‚æ•°æ®é¡µ01~æ•°æ®é¡µ56éƒ½è¢«ä½ ä¾æ¬¡é¡ºåºè¯»å–äº†ï¼ŒMySQLä¼šåˆ¤æ–­ï¼Œä½ å¯èƒ½æŽ¥ç€ä¼šç»§ç»­é¡ºåºè¯»å–åŽé¢çš„æ•°æ®é¡µã€‚

é‚£ä¹ˆæ­¤æ—¶ä»–å°±å¹²è„†æå‰æŠŠåŽç»­çš„ä¸€å¤§å †æ•°æ®é¡µï¼ˆæ¯”å¦‚æ•°æ®é¡µ57~æ•°æ®é¡µ72ï¼‰éƒ½è¯»å–åˆ°Buffer Poolé‡ŒåŽ»ï¼Œé‚£ä¹ˆåŽç»­ä½ å†è¯»å–æ•°æ®é¡µ60çš„æ—¶å€™ï¼Œæ˜¯ä¸æ˜¯å°±å¯ä»¥ç›´æŽ¥ä»ŽBuffer Poolé‡Œæ‹¿åˆ°æ•°æ®äº†ï¼Ÿ

å½“ç„¶ç†æƒ³æ˜¯ä¸Šè¿°é‚£æ ·ï¼Œè€Œäº‹å®žæ˜¯ä½ é¢„è¯»çš„ä¸€å¤§å †æ•°æ®é¡µè¦æ˜¯å æ®äº†LRUé“¾è¡¨çš„å‰é¢éƒ¨åˆ†ï¼Œå¯èƒ½è¿™äº›é¢„è¯»çš„æ•°æ®é¡µåŽ‹æ ¹å„¿åŽç»­æ²¡äººä¼šä½¿ç”¨ï¼Œé‚£è¿™ä¸ªé¢„è¯»æœºåˆ¶å°±æ˜¯åœ¨æ£ä¹±äº†ã€‚

## 1.3 å¦å¤–ä¸€ç§å¯èƒ½å¯¼è‡´é¢‘ç¹è¢«è®¿é—®çš„ç¼“å­˜é¡µè¢«æ·˜æ±°çš„åœºæ™¯ ##

æŽ¥ç€æˆ‘ä»¬è®²å¦å¤–ä¸€ç§å¯èƒ½å¯¼è‡´é¢‘ç¹è¢«è®¿é—®çš„ç¼“å­˜é¡µè¢«æ·˜æ±°çš„åœºæ™¯ï¼Œé‚£å°±æ˜¯**å…¨è¡¨æ‰«æ**ï¼Œæ„æ€å°±æ˜¯ç±»ä¼¼å¦‚ä¸‹çš„SQLè¯­å¥ï¼š

    SELECT * FROM USERS;

æ­¤æ—¶æŸ¥è¯¢æ²¡åŠ ä»»ä½•ä¸€ä¸ªwhereæ¡ä»¶ï¼Œä¼šå¯¼è‡´ç›´æŽ¥ä¸€ä¸‹å­æŠŠè¿™ä¸ªè¡¨é‡Œæ‰€æœ‰çš„æ•°æ®é¡µï¼Œéƒ½ä»Žç£ç›˜åŠ è½½åˆ°Buffer Poolé‡ŒåŽ»ã€‚è¿™ä¸ªæ—¶å€™å¯èƒ½ä¼šä¸€ä¸‹å­å°±æŠŠè¿™ä¸ªè¡¨çš„æ‰€æœ‰æ•°æ®é¡µéƒ½ä¸€ä¸€è£…å…¥å„ä¸ªç¼“å­˜é¡µé‡ŒåŽ»ï¼

æ­¤æ—¶å¯èƒ½LRUé“¾è¡¨ä¸­æŽ’åœ¨å‰é¢çš„ä¸€å¤§ä¸²ç¼“å­˜é¡µï¼Œéƒ½æ˜¯å…¨è¡¨æ‰«æåŠ è½½è¿›æ¥çš„ç¼“å­˜é¡µï¼é‚£ä¹ˆå¦‚æžœè¿™æ¬¡å…¨è¡¨æ‰«æè¿‡åŽï¼ŒåŽç»­å‡ ä¹Žæ²¡ç”¨åˆ°è¿™ä¸ªè¡¨é‡Œçš„æ•°æ®å‘¢ï¼Ÿæ­¤æ—¶LRUé“¾è¡¨çš„å°¾éƒ¨ï¼Œå¯èƒ½å…¨éƒ¨éƒ½æ˜¯ä¹‹å‰ä¸€ç›´è¢«é¢‘ç¹è®¿é—®çš„é‚£äº›ç¼“å­˜é¡µï¼

ç„¶åŽå½“ä½ è¦æ·˜æ±°æŽ‰ä¸€äº›ç¼“å­˜é¡µè…¾å‡ºç©ºé—´çš„æ—¶å€™ï¼Œå°±ä¼šæŠŠLRUé“¾è¡¨å°¾éƒ¨ä¸€ç›´è¢«é¢‘ç¹è®¿é—®çš„ç¼“å­˜é¡µç»™æ·˜æ±°æŽ‰äº†ï¼Œè€Œç•™ä¸‹äº†ä¹‹å‰å…¨è¡¨æ‰«æåŠ è½½è¿›æ¥çš„å¤§é‡çš„ä¸ç»å¸¸è®¿é—®çš„ç¼“å­˜é¡µï¼Œè¿™æ ·ä¹Ÿæ˜¯ç»å¯¹ä¸åˆç†çš„ï¼

## 2ã€åŸºäºŽå†·çƒ­æ•°æ®åˆ†ç¦»ä¼˜åŒ–LRUç®—æ³• #

æ‰€ä»¥ä¸ºäº†è§£å†³ä¸Šä¸€è®²æˆ‘ä»¬è¯´çš„ç®€å•çš„LRUé“¾è¡¨çš„é—®é¢˜ï¼ŒçœŸæ­£MySQLåœ¨è®¾è®¡LRUé“¾è¡¨çš„æ—¶å€™ï¼Œé‡‡å–çš„å®žé™…ä¸Šæ˜¯å†·çƒ­æ•°æ®åˆ†ç¦»çš„æ€æƒ³ã€‚

ä¹‹å‰ä¸€ç³»åˆ—çš„é—®é¢˜ï¼Œè¯´ç™½äº†ï¼Œä¸éƒ½æ˜¯å› ä¸ºæ‰€æœ‰ç¼“å­˜é¡µéƒ½æ··åœ¨ä¸€ä¸ªLRUé“¾è¡¨é‡Œï¼Œæ‰å¯¼è‡´çš„ä¹ˆï¼Ÿ

æ‰€ä»¥**çœŸæ­£çš„LRUé“¾è¡¨ï¼Œä¼šè¢«æ‹†åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼Œä¸€éƒ¨åˆ†æ˜¯çƒ­æ•°æ®ï¼Œä¸€éƒ¨åˆ†æ˜¯å†·æ•°æ®ï¼Œè¿™ä¸ªå†·çƒ­æ•°æ®çš„æ¯”ä¾‹æ˜¯ç”±innodb\_old\_blocks\_pctå‚æ•°æŽ§åˆ¶çš„ï¼Œé»˜è®¤å€¼æ˜¯37ï¼Œä¹Ÿå°±æ˜¯è¯´å†·æ•°æ®å æ¯”37%**ã€‚

è¿™ä¸ªæ—¶å€™ï¼ŒLRUé“¾è¡¨å®žé™…ä¸Šçœ‹èµ·æ¥æ˜¯ä¸‹é¢è¿™æ ·å­çš„ã€‚  
![ç¬‘å°æž«-www.xiaoxiaofeng.com](https://image.xiaoxiaofeng.site/spider/2022/11/2/xxf-1667354753439.jpg)

### 2.1 æ•°æ®é¡µç¬¬ä¸€æ¬¡è¢«åŠ è½½åˆ°ç¼“å­˜æ”¾åœ¨å“ªä¸ªä½ç½®ï¼Ÿ ##

é¦–å…ˆæ•°æ®é¡µç¬¬ä¸€æ¬¡è¢«åŠ è½½åˆ°ç¼“å­˜çš„æ—¶å€™ï¼Œè¿™ä¸ªæ—¶å€™ç¼“å­˜é¡µä¼šè¢«æ”¾åœ¨LRUé“¾è¡¨çš„å“ªä¸ªä½ç½®å‘¢ï¼Ÿ

å®žé™…ä¸Šè¿™ä¸ªæ—¶å€™ï¼Œ**ç¼“å­˜é¡µä¼šè¢«æ”¾åœ¨å†·æ•°æ®åŒºåŸŸçš„é“¾è¡¨å¤´éƒ¨**ï¼Œæˆ‘ä»¬çœ‹ä¸‹é¢çš„å›¾ï¼Œä¹Ÿå°±æ˜¯ç¬¬ä¸€æ¬¡æŠŠä¸€ä¸ªæ•°æ®é¡µåŠ è½½åˆ°ç¼“å­˜é¡µä¹‹åŽï¼Œè¿™ä¸ªç¼“å­˜é¡µå®žé™…ä¸Šæ˜¯è¢«æ”¾åœ¨ä¸‹å›¾ç®­å¤´çš„ä½ç½®ï¼Œä¹Ÿå°±æ˜¯å†·æ•°æ®åŒºåŸŸçš„é“¾è¡¨å¤´éƒ¨ä½ç½®ã€‚  
![ç¬‘å°æž«-www.xiaoxiaofeng.com](https://image.xiaoxiaofeng.site/spider/2022/11/2/xxf-1667354755283.jpg)

### 2.2 å†·æ•°æ®åŒºåŸŸçš„ç¼“å­˜é¡µä»€ä¹ˆæ—¶å€™ä¼šè¢«æ”¾å…¥åˆ°çƒ­æ•°æ®åŒºåŸŸï¼Ÿ ##

æŽ¥ç€æˆ‘ä»¬æ¥æ€è€ƒä¸€ä¸ªé—®é¢˜ï¼Œç¬¬ä¸€æ¬¡è¢«åŠ è½½äº†æ•°æ®çš„ç¼“å­˜é¡µï¼Œéƒ½ä¼šä¸åœçš„ç§»åŠ¨åˆ°å†·æ•°æ®åŒºåŸŸçš„é“¾è¡¨å¤´éƒ¨ï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºã€‚

é‚£ä¹ˆè¦çŸ¥é“ï¼Œå†·æ•°æ®åŒºåŸŸçš„ç¼“å­˜é¡µè‚¯å®šæ˜¯ä¼šè¢«ä½¿ç”¨çš„ï¼Œé‚£ä¹ˆå†·æ•°æ®åŒºåŸŸçš„ç¼“å­˜é¡µä»€ä¹ˆæ—¶å€™ä¼šæ”¾åˆ°çƒ­æ•°æ®åŒºåŸŸå‘¢ï¼Ÿ

å®žé™…ä¸Šè‚¯å®šå¾ˆå¤šäººä¼šæƒ³ï¼Œåªè¦å¯¹å†·æ•°æ®åŒºåŸŸçš„ç¼“å­˜é¡µè¿›è¡Œäº†ä¸€æ¬¡è®¿é—®ï¼Œå°±ç«‹é©¬æŠŠè¿™ä¸ªç¼“å­˜é¡µæ”¾åˆ°çƒ­æ•°æ®åŒºåŸŸçš„å¤´éƒ¨è¡Œä¸è¡Œå‘¢ï¼Ÿå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚  
![ç¬‘å°æž«-www.xiaoxiaofeng.com](https://image.xiaoxiaofeng.site/spider/2022/11/2/xxf-1667354756836.jpg)

å…¶å®žè¿™ä¹Ÿæ˜¯ä¸åˆç†çš„ï¼Œå¦‚æžœä½ åˆšåŠ è½½äº†ä¸€ä¸ªæ•°æ®é¡µåˆ°é‚£ä¸ªç¼“å­˜é¡µï¼Œå®ƒæ˜¯åœ¨å†·æ•°æ®åŒºåŸŸçš„é“¾è¡¨å¤´éƒ¨ï¼Œç„¶åŽç«‹é©¬ï¼ˆåœ¨1msä»¥å†…ï¼‰å°±è®¿é—®äº†ä¸€ä¸‹è¿™ä¸ªç¼“å­˜é¡µï¼Œä¹‹åŽå°±å†ä¹Ÿä¸è®¿é—®ä»–äº†å‘¢ï¼Ÿéš¾é“è¿™ç§æƒ…å†µä½ ä¹Ÿè¦æŠŠé‚£ä¸ªç¼“å­˜é¡µæ”¾åˆ°çƒ­æ•°æ®åŒºåŸŸçš„å¤´éƒ¨å—ï¼Ÿ

æ‰€ä»¥MySQLè®¾å®šäº†ä¸€ä¸ªè§„åˆ™ï¼Œè®¾è®¡äº†ä¸€ä¸ªinnodb\_old\_blocks\_timeå‚æ•°ï¼Œé»˜è®¤å€¼1000ï¼Œä¹Ÿå°±æ˜¯1000æ¯«ç§’ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ**å¿…é¡»æ˜¯ä¸€ä¸ªæ•°æ®é¡µè¢«åŠ è½½åˆ°ç¼“å­˜é¡µä¹‹åŽï¼Œåœ¨1sä¹‹åŽï¼Œå¦‚æžœè®¿é—®äº†è¿™ä¸ªç¼“å­˜é¡µï¼Œå®ƒæ‰ä¼šè¢«æŒªåŠ¨åˆ°çƒ­æ•°æ®åŒºåŸŸçš„é“¾è¡¨å¤´éƒ¨åŽ»**ã€‚

å› ä¸ºå‡è®¾ä½ åŠ è½½äº†ä¸€ä¸ªæ•°æ®é¡µåˆ°ç¼“å­˜åŽ»ï¼Œç„¶åŽè¿‡äº†1sä¹‹åŽä½ è¿˜è®¿é—®äº†è¿™ä¸ªç¼“å­˜é¡µï¼Œè¯´æ˜Žä½ åŽç»­å¾ˆå¯èƒ½ä¼šç»å¸¸è¦è®¿é—®å®ƒï¼Œè¿™ä¸ªæ—¶é—´é™åˆ¶å°±æ˜¯1sï¼Œå› æ­¤åªæœ‰1såŽä½ è®¿é—®äº†è¿™ä¸ªç¼“å­˜é¡µï¼Œå®ƒæ‰ä¼šç»™ä½ æŠŠç¼“å­˜é¡µæ”¾åˆ°çƒ­æ•°æ®åŒºåŸŸçš„é“¾è¡¨å¤´éƒ¨åŽ»ã€‚  
![ç¬‘å°æž«-www.xiaoxiaofeng.com](https://image.xiaoxiaofeng.site/spider/2022/11/2/xxf-1667354757913.jpg)  
æ‰€ä»¥æˆ‘ä»¬çœ‹ä¸Šé¢çš„å›¾ï¼Œæ–‡å­—è¯´æ˜Žåšäº†ä¸€ç‚¹æ”¹åŠ¨ï¼Œæ˜¯æ•°æ®åŠ è½½åˆ°ç¼“å­˜é¡µä¹‹åŽè¿‡äº†1sï¼Œä½ å†è®¿é—®è¿™ä¸ªç¼“å­˜é¡µï¼Œä»–å°±ä¼šè¢«æ”¾å…¥çƒ­æ•°æ®åŒºåŸŸçš„é“¾è¡¨å¤´éƒ¨ï¼Œå¦‚æžœæ˜¯ä½ æ•°æ®åˆšåŠ è½½åˆ°ç¼“å­˜é¡µï¼Œåœ¨1så†…ä½ å°±è®¿é—®ç¼“å­˜é¡µï¼Œæ­¤æ—¶ä»–æ˜¯ä¸ä¼šæŠŠè¿™ä¸ªç¼“å­˜é¡µæ”¾å…¥çƒ­æ•°æ®åŒºåŸŸçš„å¤´éƒ¨çš„ã€‚

## 3ã€åŸºäºŽå†·çƒ­æ•°æ®åˆ†ç¦»ä¼˜åŒ–åŽçš„LRUé“¾è¡¨ï¼Œæ˜¯å¦‚ä½•è§£å†³ä¹‹å‰çš„é—®é¢˜çš„ï¼Ÿ #

çŽ°åœ¨æˆ‘ä»¬å·²ç»çœ‹å®Œäº†LRUé“¾è¡¨çš„å†·çƒ­æ•°æ®åˆ†ç¦»çš„æ–¹æ¡ˆï¼Œé‚£ä¹ˆæˆ‘ä»¬æŽ¥ç€çœ‹è¿™ä¸ªå†·çƒ­æ•°æ®åˆ†ç¦»ä¹‹åŽçš„LRUé“¾è¡¨ï¼Œä»–æ˜¯å¦‚ä½•è§£å†³ä¹‹å‰é‡åˆ°çš„ä¸€å¤§å †é—®é¢˜çš„ï¼Ÿ

é¦–å…ˆæˆ‘ä»¬æ€è€ƒä¸€ä¸‹ï¼Œåœ¨è¿™æ ·çš„ä¸€ä¸ªLRUé“¾è¡¨æ–¹æ¡ˆä¸‹ï¼Œé¢„è¯»æœºåˆ¶ä»¥åŠå…¨è¡¨æ‰«æåŠ è½½è¿›æ¥çš„ä¸€å¤§å †ç¼“å­˜é¡µï¼Œä»–ä»¬ä¼šæ”¾åœ¨å“ªé‡Œï¼Ÿ

æ˜Žæ˜¾æ˜¯**æ”¾åœ¨LRUé“¾è¡¨çš„å†·æ•°æ®åŒºåŸŸçš„å‰é¢**ï¼

å‡è®¾è¿™ä¸ªæ—¶å€™çƒ­æ•°æ®åŒºåŸŸå·²ç»æœ‰å¾ˆå¤šè¢«é¢‘ç¹è®¿é—®çš„ç¼“å­˜é¡µäº†ï¼Œä½ ä¼šå‘çŽ°çƒ­æ•°æ®åŒºåŸŸè¿˜æ˜¯å­˜æ”¾è¢«é¢‘ç¹è®¿é—®çš„ç¼“å­˜é¡µçš„ï¼Œåªè¦çƒ­æ•°æ®åŒºåŸŸæœ‰ç¼“å­˜é¡µè¢«è®¿é—®ï¼Œå®ƒè¿˜æ˜¯ä¼šè¢«ç§»åŠ¨åˆ°çƒ­æ•°æ®åŒºåŸŸçš„é“¾è¡¨å¤´éƒ¨åŽ»ã€‚

æ‰€ä»¥æ­¤æ—¶ä½ çœ‹ä¸‹å›¾ï¼Œä½ ä¼šå‘çŽ°ï¼Œé¢„è¯»æœºåˆ¶å’Œå…¨è¡¨æ‰«æåŠ è½½è¿›æ¥çš„ä¸€å¤§å †ç¼“å­˜é¡µï¼Œæ­¤æ—¶éƒ½åœ¨å†·æ•°æ®åŒºåŸŸé‡Œï¼Œè·Ÿçƒ­æ•°æ®åŒºåŸŸé‡Œçš„é¢‘ç¹è®¿é—®çš„ç¼“å­˜é¡µï¼Œæ˜¯ç‹¬ç«‹éš”ç¦»å¼€çš„ï¼Œç›¸äº’ä¹‹é—´æ²¡å…³ç³»çš„ï¼  
![ç¬‘å°æž«-www.xiaoxiaofeng.com](https://image.xiaoxiaofeng.site/spider/2022/11/2/xxf-1667354758998.jpg)

### 3.1 é¢„è¯»æœºåˆ¶å’Œå…¨è¡¨æ‰«æåŠ è½½è¿›æ¥çš„ç¼“å­˜é¡µï¼Œèƒ½è¿›çƒ­æ•°æ®åŒºåŸŸå—ï¼Ÿ ##

æŽ¥ç€æˆ‘ä»¬çœ‹ç¬¬äºŒä¸ªé—®é¢˜ï¼Œé¢„è¯»æœºåˆ¶å’Œå…¨è¡¨æ‰«ææœºåˆ¶åŠ è½½è¿›æ¥çš„ç¼“å­˜é¡µï¼Œä»€ä¹ˆæ—¶å€™èƒ½è¿›çƒ­æ•°æ®åŒºåŸŸå‘¢ï¼Ÿ

å¦‚æžœä½ ä»…ä»…æ˜¯ä¸€ä¸ªå…¨è¡¨æ‰«æçš„æŸ¥è¯¢ï¼Œæ­¤æ—¶ä½ è‚¯å®šæ˜¯åœ¨1så†…å°±æŠŠä¸€å¤§å †ç¼“å­˜é¡µåŠ è½½è¿›æ¥ï¼Œç„¶åŽå°±è®¿é—®äº†è¿™äº›ç¼“å­˜é¡µä¸€ä¸‹ï¼Œé€šå¸¸è¿™äº›æ“ä½œ1så†…å°±ç»“æŸäº†ã€‚

æ‰€ä»¥åŸºäºŽç›®å‰çš„ä¸€ä¸ªæœºåˆ¶ï¼Œå¯ä»¥ç¡®å®šçš„æ˜¯ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œé‚£äº›ç¼“å­˜é¡µæ˜¯ä¸ä¼šä»Žå†·æ•°æ®åŒºåŸŸè½¬ç§»åˆ°çƒ­æ•°æ®åŒºåŸŸçš„ï¼

é™¤éž**åœ¨å†·æ•°æ®åŒºåŸŸé‡Œçš„ç¼“å­˜é¡µï¼Œåœ¨1sä¹‹åŽè¿˜è¢«äººè®¿é—®äº†ï¼Œé‚£ä¹ˆæ­¤æ—¶å®ƒä»¬å°±ä¼šåˆ¤å®šä¸ºæœªæ¥å¯èƒ½ä¼šè¢«é¢‘ç¹è®¿é—®çš„ç¼“å­˜é¡µï¼Œç„¶åŽç§»åŠ¨åˆ°çƒ­æ•°æ®åŒºåŸŸçš„é“¾è¡¨å¤´éƒ¨åŽ»**ï¼

### 3.2 å¦‚æžœæ­¤æ—¶ç¼“å­˜é¡µä¸å¤Ÿäº†ï¼Œéœ€è¦æ·˜æ±°ä¸€äº›ç¼“å­˜ï¼Œä¼šæ€Žä¹ˆæ ·ï¼Ÿ ##

é‚£å°±å¾ˆç®€å•äº†ï¼Œç›´æŽ¥å°±æ˜¯å¯ä»¥æ‰¾åˆ°LRUé“¾è¡¨ä¸­çš„å†·æ•°æ®åŒºåŸŸçš„å°¾éƒ¨çš„ç¼“å­˜é¡µï¼Œä»–ä»¬è‚¯å®šæ˜¯ä¹‹å‰è¢«åŠ è½½è¿›æ¥çš„ï¼Œè€Œä¸”åŠ è½½è¿›æ¥1sè¿‡åŽéƒ½æ²¡äººè®¿é—®è¿‡ï¼Œè¯´æ˜Žè¿™ä¸ªç¼“å­˜é¡µåŽ‹æ ¹å„¿å°±æ²¡äººæ„¿æ„åŽ»è®¿é—®ä»–ï¼ä»–å°±æ˜¯å†·æ•°æ®ï¼

æ‰€ä»¥æ­¤æ—¶å°±**ç›´æŽ¥æ·˜æ±°å†·æ•°æ®åŒºåŸŸçš„å°¾éƒ¨çš„ç¼“å­˜é¡µï¼Œåˆ·å…¥ç£ç›˜å°±å¯ä»¥äº†**ï¼Œæˆ‘ä»¬çœ‹ä¸‹å›¾ã€‚  
![ç¬‘å°æž«-www.xiaoxiaofeng.com](https://image.xiaoxiaofeng.site/spider/2022/11/2/xxf-1667354760114.jpg)

### 3.3 ä¹‹å‰çš„ä¸€å¤§å †é—®é¢˜è§£å†³äº†å—ï¼Ÿ ##

åœ¨è¿™æ ·çš„ä¸€å¥—ç¼“å­˜é¡µåˆ†å†·çƒ­æ•°æ®çš„åŠ è½½æ–¹æ¡ˆï¼Œä»¥åŠå†·æ•°æ®è½¬åŒ–ä¸ºçƒ­æ•°æ®çš„æ—¶é—´é™åˆ¶æ–¹æ¡ˆï¼Œè¿˜æœ‰å°±æ˜¯æ·˜æ±°ç¼“å­˜é¡µçš„æ—¶å€™ä¼˜å…ˆæ·˜æ±°å†·æ•°æ®åŒºåŸŸçš„æ–¹æ¡ˆï¼ŒåŸºäºŽè¿™å¥—æ–¹æ¡ˆï¼Œå¤§å®¶ä¼šå‘çŽ°ï¼Œä¹‹å‰å‘çŽ°çš„é—®é¢˜ï¼Œå®Œç¾Žçš„è¢«è§£å†³äº†ã€‚

å› ä¸ºé‚£ç§é¢„è¯»æœºåˆ¶ä»¥åŠå…¨è¡¨æ‰«ææœºåˆ¶åŠ è½½è¿›æ¥çš„æ•°æ®é¡µï¼Œå¤§éƒ¨åˆ†éƒ½ä¼šåœ¨1sä¹‹å†…è®¿é—®ä¸€ä¸‹ï¼Œä¹‹åŽå¯èƒ½å°±å†ä¹Ÿä¸è®¿é—®äº†ï¼Œæ‰€ä»¥è¿™ç§ç¼“å­˜é¡µåŸºæœ¬ä¸Šéƒ½ä¼šç•™åœ¨å†·æ•°æ®åŒºåŸŸé‡Œã€‚ç„¶åŽé¢‘ç¹è®¿é—®çš„ç¼“å­˜é¡µè¿˜æ˜¯ä¼šç•™åœ¨çƒ­æ•°æ®åŒºåŸŸé‡Œã€‚

å½“ä½ è¦æ·˜æ±°ç¼“å­˜çš„æ—¶å€™ï¼Œä¼˜å…ˆå°±æ˜¯ä¼šé€‰æ‹©å†·æ•°æ®åŒºåŸŸçš„å°¾éƒ¨çš„ç¼“å­˜é¡µï¼Œè¿™å°±æ˜¯éžå¸¸åˆç†çš„äº†ï¼Œå®ƒä¸ä¼šè®©åˆšåŠ è½½è¿›æ¥çš„ç¼“å­˜é¡µå æ®LRUé“¾è¡¨çš„å¤´éƒ¨ï¼Œé¢‘ç¹è®¿é—®çš„ç¼“å­˜é¡µåœ¨LRUé“¾è¡¨çš„å°¾éƒ¨ï¼Œæ·˜æ±°çš„æ—¶å€™æ·˜æ±°å°¾éƒ¨çš„é¢‘ç¹è®¿é—®çš„ç¼“å­˜é¡µäº†ï¼

è¿™å°±æ˜¯LRUé“¾è¡¨å†·çƒ­æ•°æ®åˆ†ç¦»çš„ä¸€å¥—æœºåˆ¶ã€‚

### 3.4 æ€»ç»“ ##

é€šè¿‡è¿™å‡ ç¯‡æ–‡ç« çš„å­¦ä¹ ï¼Œæˆ‘ä»¬å·²ç»å½»åº•æžå®šäº†LRUé“¾è¡¨çš„è®¾è®¡æœºåˆ¶ï¼ŒåˆšåŠ è½½æ•°æ®çš„ç¼“å­˜é¡µéƒ½æ˜¯æ”¾å†·æ•°æ®åŒºåŸŸçš„å¤´éƒ¨çš„ï¼Œ1sè¿‡åŽè¢«è®¿é—®äº†æ‰ä¼šæ”¾çƒ­æ•°æ®åŒºåŸŸçš„å¤´éƒ¨ï¼Œçƒ­æ•°æ®åŒºåŸŸçš„ç¼“å­˜é¡µè¢«è®¿é—®äº†ï¼Œå°±ä¼šè‡ªåŠ¨æ”¾åˆ°å¤´éƒ¨åŽ»ã€‚

è¿™æ ·çš„è¯ï¼Œå®žé™…ä¸Šå†·æ•°æ®åŒºåŸŸæ”¾çš„éƒ½æ˜¯åŠ è½½è¿›æ¥çš„ç¼“å­˜é¡µï¼Œæœ€å¤šåœ¨1så†…è¢«è®¿é—®è¿‡ï¼Œä¹‹åŽå°±å†ä¹Ÿæ²¡è®¿é—®è¿‡çš„å†·æ•°æ®ç¼“å­˜é¡µï¼

è€ŒåŠ è½½è¿›æ¥ä¹‹åŽåœ¨1sè¿‡åŽè¿˜ç»å¸¸è¢«è®¿é—®çš„ç¼“å­˜é¡µï¼Œéƒ½æ”¾åœ¨äº†çƒ­æ•°æ®åŒºåŸŸé‡Œï¼Œå®ƒä»¬è¿›è¡Œäº†å†·çƒ­æ•°æ®çš„éš”ç¦»ï¼

è¿™æ ·çš„è¯ï¼Œåœ¨æ·˜æ±°ç¼“å­˜çš„æ—¶å€™ï¼Œä¸€å®šæ˜¯ä¼˜å…ˆæ·˜æ±°å†·æ•°æ®åŒºåŸŸå‡ ä¹Žä¸æ€Žä¹ˆè¢«è®¿é—®çš„ç¼“å­˜é¡µçš„ï¼  
å…¶å®žå¥½å¤šç¼“å­˜éƒ½æ˜¯åŸºäºŽå†·çƒ­æ•°æ®éš”ç¦»æ€æƒ³å®Œæˆçš„ï¼Œä¹Ÿå¸Œæœ›å¤§å®¶å¥½å¥½å¸æ”¶è¿™ç§å†·çƒ­æ•°æ®éš”ç¦»çš„æ€æƒ³ï¼Œå°½å¯èƒ½è®©çƒ­æ•°æ®å’Œå†·æ•°æ®åˆ†å¼€ï¼Œé¿å…å†·æ•°æ®å½±å“çƒ­æ•°æ®çš„è®¿é—®ï¼

## å…³äºŽç¬‘å°æž«ðŸ’•

> æœ¬ç« åˆ°è¿™é‡Œç»“æŸäº†ï¼Œå–œæ¬¢çš„æœ‹å‹å…³æ³¨ä¸€ä¸‹æˆ‘å‘¦ï¼Œå¤§ä¼™çš„æ”¯æŒï¼Œå°±æ˜¯æˆ‘åšæŒå†™ä¸‹åŽ»çš„åŠ¨åŠ›ã€‚
>
> å¾®ä¿¡å…¬ä¼—å·ï¼šç¬‘å°æž«
>
> ç¬‘å°æž«ä¸ªäººåšå®¢ï¼š[https://www.xiaoxiaofeng.com](https://www.xiaoxiaofeng.com)
>
> CSDNï¼š[https://zhangfz.blog.csdn.net](https://zhangfz.blog.csdn.net)
>

