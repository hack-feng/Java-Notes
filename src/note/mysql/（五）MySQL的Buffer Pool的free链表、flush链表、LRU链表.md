MySQLçš„Buffer Poolçš„freeé“¾è¡¨ã€flushé“¾è¡¨ã€LRUé“¾è¡¨

## 1ã€æ•°æ®åº“å¯åŠ¨çš„æ—¶å€™ï¼Œæ˜¯å¦‚ä½•åˆå§‹åŒ–Buffer Poolçš„å‘¢ï¼Ÿ #

å‰é¢æˆ‘ä»¬å·²ç»è®²è¿‡MySQLæ•°æ®åº“çš„Buffer Poolåˆ°åº•é•¿æˆä»€ä¹ˆæ ·ï¼Œå…¶å®žç®€å•ç‚¹è¯´ï¼ŒBuffer Poolé‡Œé¢å°±æ˜¯ä¼šåŒ…å«å¾ˆå¤šä¸ªç¼“å­˜é¡µï¼ŒåŒæ—¶æ¯ä¸ªç¼“å­˜é¡µè¿˜æœ‰ä¸€ä¸ªæè¿°æ•°æ®ï¼Œä¹Ÿå¯ä»¥å«åšæ˜¯æŽ§åˆ¶æ•°æ®ï¼Œä½†æ˜¯ä¸€èˆ¬å¤§å®¶éƒ½å«åšæè¿°æ•°æ®ï¼Œæˆ–è€…ç¼“å­˜é¡µçš„å…ƒæ•°æ®ã€‚

é‚£ä¹ˆåœ¨æ•°æ®åº“å¯åŠ¨çš„æ—¶å€™ï¼Œä»–æ˜¯å¦‚ä½•åˆå§‹åŒ–Buffer Poolçš„å‘¢ï¼Ÿ

 *  å…¶å®žè¿™ä¸ªä¹Ÿå¾ˆç®€å•ï¼Œæ•°æ®åº“åªè¦ä¸€å¯åŠ¨ï¼Œå°±ä¼šæŒ‰ç…§ä½ è®¾ç½®çš„Buffer Poolå¤§å°ï¼Œç¨å¾®å†åŠ å¤§ä¸€ç‚¹ï¼ŒåŽ»æ‰¾æ“ä½œç³»ç»Ÿç”³è¯·ä¸€å—å†…å­˜åŒºåŸŸï¼Œä½œä¸ºBuffer Poolçš„å†…å­˜åŒºåŸŸã€‚
 *  ç„¶åŽå½“å†…å­˜åŒºåŸŸç”³è¯·å®Œæ¯•ä¹‹åŽï¼Œæ•°æ®åº“å°±ä¼šæŒ‰ç…§é»˜è®¤çš„ç¼“å­˜é¡µçš„16KBçš„å¤§å°ä»¥åŠå¯¹åº”çš„800ä¸ªå­—èŠ‚å·¦å³çš„æè¿°æ•°æ®çš„å¤§å°ï¼Œ**åœ¨Buffer Poolä¸­åˆ’åˆ†å‡ºæ¥ä¸€ä¸ªä¸€ä¸ªçš„ç¼“å­˜é¡µå’Œä¸€ä¸ªä¸€ä¸ªçš„ä»–ä»¬å¯¹åº”çš„æè¿°æ•°æ®**ã€‚

ç„¶åŽå½“æ•°æ®åº“æŠŠBuffer Poolåˆ’åˆ†å®Œæ¯•ä¹‹åŽï¼Œçœ‹èµ·æ¥å°±æ˜¯ä¹‹å‰æˆ‘ä»¬çœ‹åˆ°çš„é‚£å¼ å›¾äº†ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚  
![ç¬‘å°æž«-www.xiaoxiaofeng.com](https://image.xiaoxiaofeng.site/spider/2022/11/2/xxf-1667354593601.jpg)  
åªä¸è¿‡è¿™ä¸ªæ—¶å€™ï¼Œ**Buffer Poolä¸­çš„ä¸€ä¸ªä¸€ä¸ªçš„ç¼“å­˜é¡µéƒ½æ˜¯ç©ºçš„**ï¼Œé‡Œé¢ä»€ä¹ˆéƒ½æ²¡æœ‰ï¼Œè¦ç­‰æ•°æ®åº“è¿è¡Œèµ·æ¥ä¹‹åŽï¼Œå½“æˆ‘ä»¬è¦å¯¹æ•°æ®æ‰§è¡Œå¢žåˆ æ”¹æŸ¥çš„æ“ä½œçš„æ—¶å€™ï¼Œæ‰ä¼šæŠŠæ•°æ®å¯¹åº”çš„é¡µä»Žç£ç›˜æ–‡ä»¶é‡Œè¯»å–å‡ºæ¥ï¼Œæ”¾å…¥Buffer Poolä¸­çš„ç¼“å­˜é¡µä¸­ã€‚

## 2ã€Buffer Poolçš„freeé“¾è¡¨ #

### 2.1 æˆ‘ä»¬æ€Žä¹ˆçŸ¥é“å“ªäº›ç¼“å­˜é¡µæ˜¯ç©ºé—²çš„å‘¢ï¼Ÿ ##

æŽ¥ç€æ¥çœ‹ä¸‹ä¸€ä¸ªé—®é¢˜ï¼Œå½“æ•°æ®åº“è¿è¡Œèµ·æ¥ä¹‹åŽï¼Œæˆ‘ä»¬çš„ç³»ç»Ÿè‚¯å®šä¼šä¸åœçš„æ‰§è¡Œå¢žåˆ æ”¹æŸ¥çš„æ“ä½œï¼Œ**æ­¤æ—¶å°±éœ€è¦ä¸åœçš„ä»Žç£ç›˜ä¸Šè¯»å–ä¸€ä¸ªä¸€ä¸ªçš„æ•°æ®é¡µæ”¾å…¥Buffer Poolä¸­çš„å¯¹åº”çš„ç¼“å­˜é¡µé‡ŒåŽ»ï¼ŒæŠŠæ•°æ®ç¼“å­˜èµ·æ¥**ï¼Œé‚£ä¹ˆä»¥åŽå°±å¯ä»¥åœ¨å†…å­˜é‡Œå¯¹è¿™ä¸ªæ•°æ®æ‰§è¡Œå¢žåˆ æ”¹æŸ¥äº†ã€‚

ä½†æ˜¯æ­¤æ—¶åœ¨ä»Žç£ç›˜ä¸Šè¯»å–æ•°æ®é¡µæ”¾å…¥Buffer Poolä¸­çš„ç¼“å­˜é¡µçš„æ—¶å€™ï¼Œå¿…ç„¶æ¶‰åŠåˆ°ä¸€ä¸ªé—®é¢˜ï¼Œé‚£å°±æ˜¯å“ªäº›ç¼“å­˜é¡µæ˜¯ç©ºé—²çš„ï¼Ÿ

å› ä¸ºé»˜è®¤æƒ…å†µä¸‹ç£ç›˜ä¸Šçš„æ•°æ®é¡µå’Œç¼“å­˜é¡µæ˜¯ä¸€ ä¸€å¯¹åº”èµ·æ¥çš„ï¼Œéƒ½æ˜¯16KBï¼Œä¸€ä¸ªæ•°æ®é¡µå¯¹åº”ä¸€ä¸ªç¼“å­˜é¡µã€‚æ•°æ®é¡µåªèƒ½åŠ è½½åˆ°ç©ºé—²çš„ç¼“å­˜é¡µé‡Œï¼Œæ‰€ä»¥MySqlå¿…é¡»è¦çŸ¥é“Buffer Poolä¸­å“ªäº›ç¼“å­˜é¡µæ˜¯ç©ºé—²çš„çŠ¶æ€ï¼Ÿ

MySQLæ•°æ®åº“ä¼šä¸ºBuffer Poolè®¾è®¡äº†ä¸€ä¸ª**freeé“¾è¡¨ï¼Œæ˜¯ä¸€ä¸ªåŒå‘é“¾è¡¨æ•°æ®ç»“æž„ï¼Œè¿™ä¸ªfreeé“¾è¡¨é‡Œï¼Œæ¯ä¸ªèŠ‚ç‚¹å°±æ˜¯ä¸€ä¸ªç©ºé—²çš„ç¼“å­˜é¡µçš„æè¿°æ•°æ®å—çš„åœ°å€**ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåªè¦ä½ ä¸€ä¸ªç¼“å­˜é¡µæ˜¯ç©ºé—²çš„ï¼Œé‚£ä¹ˆå®ƒçš„æè¿°æ•°æ®å—å°±ä¼šè¢«æ”¾å…¥è¿™ä¸ªfreeé“¾è¡¨ä¸­ã€‚

åˆšå¼€å§‹æ•°æ®åº“å¯åŠ¨çš„æ—¶å€™ï¼Œæ‰€æœ‰çš„ç¼“å­˜é¡µéƒ½æ˜¯ç©ºé—²çš„ï¼Œå› ä¸ºæ­¤æ—¶å¯èƒ½æ˜¯ä¸€ä¸ªç©ºçš„æ•°æ®åº“ï¼Œä¸€æ¡æ•°æ®éƒ½æ²¡æœ‰ï¼Œæ‰€ä»¥æ­¤æ—¶æ‰€æœ‰ç¼“å­˜é¡µçš„æè¿°æ•°æ®å—ï¼Œéƒ½ä¼šè¢«æ”¾å…¥è¿™ä¸ªfreeé“¾è¡¨ä¸­ã€‚

å‡è®¾æ•°æ®æ­¤æ—¶æ€»å…±æœ‰3ä¸ªæ•°æ®é¡µï¼Œé‚£ä¹ˆå®ƒçš„freeé“¾è¡¨å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š  
![ç¬‘å°æž«-www.xiaoxiaofeng.com](https://image.xiaoxiaofeng.site/spider/2022/11/2/xxf-1667354594422.jpg)

 *  å¤§å®¶å¯ä»¥çœ‹åˆ°ä¸Šé¢å‡ºçŽ°äº†ä¸€ä¸ªfreeé“¾è¡¨ï¼Œè¿™ä¸ªfreeé“¾è¡¨é‡Œé¢å°±æ˜¯å„ä¸ªç¼“å­˜é¡µçš„æè¿°æ•°æ®å—ï¼Œåªè¦ç¼“å­˜é¡µæ˜¯ç©ºé—²çš„ï¼Œé‚£ä¹ˆä»–ä»¬å¯¹åº”çš„æè¿°æ•°æ®å—å°±ä¼šåŠ å…¥åˆ°è¿™ä¸ªfreeé“¾è¡¨ä¸­ï¼Œ**æ¯ä¸ªèŠ‚ç‚¹éƒ½ä¼šåŒå‘é“¾æŽ¥è‡ªå·±çš„å‰åŽèŠ‚ç‚¹ï¼Œç»„æˆä¸€ä¸ªåŒå‘é“¾è¡¨**ã€‚
 *  é™¤æ­¤ä¹‹å¤–ï¼Œè¿™ä¸ª**freeé“¾è¡¨æœ‰ä¸€ä¸ªåŸºç¡€èŠ‚ç‚¹ï¼Œå®ƒä¼šå¼•ç”¨é“¾è¡¨çš„å¤´èŠ‚ç‚¹å’Œå°¾èŠ‚ç‚¹ï¼Œé‡Œé¢è¿˜å­˜å‚¨äº†é“¾è¡¨ä¸­æœ‰å¤šå°‘ä¸ªæè¿°æ•°æ®å—çš„èŠ‚ç‚¹**ï¼Œä¹Ÿå°±æ˜¯æœ‰å¤šå°‘ä¸ªç©ºé—²çš„ç¼“å­˜é¡µã€‚
 *  è¿™é‡Œè¦ç»™å¤§å®¶è®²æ˜Žç™½ä¸€ç‚¹ï¼Œè¿™ä¸ªfreeé“¾è¡¨ï¼Œå…¶å®žå°±æ˜¯å’±ä»¬æ‰€å­¦çš„æ•°æ®ç»“æž„ä¸­çš„åŒå‘é“¾è¡¨ã€‚å®ƒæœ¬èº«å…¶å®žå°±æ˜¯ç”±Buffer Poolé‡Œçš„æè¿°æ•°æ®å—ç»„æˆçš„ï¼Œä½ å¯ä»¥è®¤ä¸ºæ˜¯**æ¯ä¸ªæè¿°æ•°æ®å—é‡Œéƒ½æœ‰ä¸¤ä¸ªæŒ‡é’ˆï¼Œä¸€ä¸ªæ˜¯free\_preï¼Œä¸€ä¸ªæ˜¯free\_nextï¼Œåˆ†åˆ«æŒ‡å‘è‡ªå·±çš„ä¸Šä¸€ä¸ªfreeé“¾è¡¨çš„èŠ‚ç‚¹ï¼Œä»¥åŠä¸‹ä¸€ä¸ªfreeé“¾è¡¨çš„èŠ‚ç‚¹**ã€‚
 *  **é€šè¿‡Buffer Poolä¸­çš„æè¿°æ•°æ®å—çš„free\_preå’Œfree\_nextä¸¤ä¸ªæŒ‡é’ˆï¼Œå°±å¯ä»¥æŠŠæ‰€æœ‰çš„æè¿°æ•°æ®å—ä¸²æˆä¸€ä¸ªfreeé“¾è¡¨**ã€‚ä¸Šé¢ä¸ºäº†ç”»å›¾éœ€è¦ï¼Œå‡å¦‚æ•°æ®åº“æ€»å…±æœ‰3ä¸ªç©ºé—²çš„æè¿°æ•°æ®å—ï¼Œå±•ç¤ºä»–ä»¬ä¹‹é—´çš„æŒ‡é’ˆå¼•ç”¨å…³ç³»ã€‚
 *  å¯¹äºŽfreeé“¾è¡¨è€Œè¨€ï¼Œåªæœ‰ä¸€ä¸ªåŸºç¡€èŠ‚ç‚¹æ˜¯ä¸å±žäºŽBuffer Poolçš„ï¼Œå®ƒæ˜¯40å­—èŠ‚å¤§å°çš„ä¸€ä¸ªèŠ‚ç‚¹ï¼Œé‡Œé¢å°±å­˜æ”¾äº†freeé“¾è¡¨çš„å¤´èŠ‚ç‚¹çš„åœ°å€ï¼Œå°¾èŠ‚ç‚¹çš„åœ°å€ï¼Œè¿˜æœ‰freeé“¾è¡¨é‡Œå½“å‰æœ‰å¤šå°‘ä¸ªèŠ‚ç‚¹ã€‚

### 2.2 å¦‚ä½•å°†ç£ç›˜ä¸Šçš„é¡µè¯»å–åˆ°Buffer Poolçš„ç¼“å­˜é¡µä¸­åŽ»ï¼Ÿ ##

å¥½äº†ï¼Œæœ‰äº†freeé“¾è¡¨ï¼Œå½“éœ€è¦æŠŠç£ç›˜ä¸Šçš„æ•°æ®é¡µè¯»å–åˆ°Buffer Poolä¸­çš„ç¼“å­˜é¡µé‡ŒåŽ»çš„æ—¶å€™ï¼Œæ˜¯æ€Žæ ·ä¸€ä¸ªæ“ä½œè¿‡ç¨‹å‘¢ï¼Ÿ

å…¶å®žæœ‰äº†freeé“¾è¡¨ä¹‹åŽï¼Œè¿™ä¸ªæ“ä½œå°±å¾ˆç®€å•äº†ã€‚

 *  é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ä»Žfreeé“¾è¡¨é‡ŒèŽ·å–ä¸€ä¸ªæè¿°æ•°æ®å—ï¼Œç„¶åŽå°±å¯ä»¥èŽ·å–åˆ°è¿™ä¸ªæè¿°æ•°æ®å—å¯¹åº”çš„ç©ºé—²ç¼“å­˜é¡µï¼›
 *  æŽ¥ç€æˆ‘ä»¬å°±å¯ä»¥æŠŠç£ç›˜ä¸Šçš„æ•°æ®é¡µè¯»å–åˆ°å¯¹åº”çš„ç¼“å­˜é¡µé‡ŒåŽ»ï¼ŒåŒæ—¶æŠŠç›¸å…³çš„ä¸€äº›æè¿°æ•°æ®å†™å…¥ç¼“å­˜é¡µçš„æè¿°æ•°æ®å—é‡ŒåŽ»ï¼Œæ¯”å¦‚è¿™ä¸ªæ•°æ®é¡µæ‰€å±žçš„è¡¨ç©ºé—´ä¹‹ç±»çš„ä¿¡æ¯ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š  
    ![ç¬‘å°æž«-www.xiaoxiaofeng.com](https://image.xiaoxiaofeng.site/spider/2022/11/2/xxf-1667354595277.jpg)
 *  æœ€åŽæŠŠé‚£ä¸ªæè¿°æ•°æ®å—ä»Žfreeé“¾è¡¨é‡ŒåŽ»é™¤å°±å¯ä»¥äº†ã€‚ç§»é™¤åŽï¼Œé“¾è¡¨å˜åŒ–å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š  
    ![ç¬‘å°æž«-www.xiaoxiaofeng.com](https://image.xiaoxiaofeng.site/spider/2022/11/2/xxf-1667354596363.jpg)

### 2.3 MySQLæ€Žä¹ˆçŸ¥é“æŸä¸ªæ•°æ®é¡µæœ‰æ²¡æœ‰è¢«ç¼“å­˜ï¼Ÿ ##

æŽ¥ç€æˆ‘ä»¬æ¥çœ‹ä¸‹ä¸€ä¸ªé—®é¢˜ï¼šMySQLæ€Žä¹ˆçŸ¥é“æŸä¸ªæ•°æ®é¡µæœ‰æ²¡æœ‰è¢«ç¼“å­˜ï¼Ÿ

æˆ‘ä»¬åœ¨æ‰§è¡Œå¢žåˆ æ”¹æŸ¥çš„æ—¶å€™ï¼Œè‚¯å®šæ˜¯å…ˆçœ‹çœ‹è¿™ä¸ªæ•°æ®é¡µæœ‰æ²¡æœ‰è¢«ç¼“å­˜ï¼Œå¦‚æžœæ²¡è¢«ç¼“å­˜å°±èµ°ä¸Šé¢çš„é€»è¾‘ï¼Œä»Žfreeé“¾è¡¨ä¸­æ‰¾åˆ°ä¸€ä¸ªç©ºé—²çš„ç¼“å­˜é¡µï¼Œä»Žç£ç›˜ä¸Šè¯»å–æ•°æ®é¡µå†™å…¥ç¼“å­˜é¡µï¼Œå†™å…¥æè¿°æ•°æ®ï¼Œä»Žfreeé“¾è¡¨ä¸­ç§»é™¤è¿™ä¸ªæè¿°æ•°æ®å—ã€‚

ä½†æ˜¯å¦‚æžœæ•°æ®é¡µå·²ç»è¢«ç¼“å­˜äº†ï¼Œé‚£ä¹ˆå°±ä¼šç›´æŽ¥ä½¿ç”¨äº†ã€‚æ‰€ä»¥å…¶å®žæ•°æ®åº“è¿˜ä¼šæœ‰ä¸€ä¸ªå“ˆå¸Œè¡¨æ•°æ®ç»“æž„ï¼Œä»–ä¼šç”¨è¡¨ç©ºé—´å·+æ•°æ®é¡µå·ï¼Œä½œä¸ºä¸€ä¸ªkeyï¼Œç„¶åŽç¼“å­˜é¡µçš„åœ°å€ä½œä¸ºvalueã€‚å½“ä½ è¦ä½¿ç”¨ä¸€ä¸ªæ•°æ®é¡µçš„æ—¶å€™ï¼Œ**é€šè¿‡â€œè¡¨ç©ºé—´å·+æ•°æ®é¡µå·â€ä½œä¸ºkeyåŽ»è¿™ä¸ªå“ˆå¸Œè¡¨é‡ŒæŸ¥ä¸€ä¸‹ï¼Œå¦‚æžœæ²¡æœ‰å°±è¯»å–æ•°æ®é¡µï¼Œå¦‚æžœå·²ç»æœ‰äº†ï¼Œå°±è¯´æ˜Žæ•°æ®é¡µå·²ç»è¢«ç¼“å­˜äº†**ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š  
![ç¬‘å°æž«-www.xiaoxiaofeng.com](https://image.xiaoxiaofeng.site/spider/2022/11/2/xxf-1667354597697.jpg)  
MySQLå¼•å…¥äº†ä¸€ä¸ªæ•°æ®é¡µç¼“å­˜å“ˆå¸Œè¡¨çš„ç»“æž„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯æ¬¡ä½ è¯»å–ä¸€ä¸ªæ•°æ®é¡µåˆ°ç¼“å­˜ä¹‹åŽï¼Œéƒ½ä¼šåœ¨è¿™ä¸ªå“ˆå¸Œè¡¨ä¸­å†™å…¥ä¸€ä¸ªkey-valueå¯¹ï¼Œkeyå°±æ˜¯è¡¨ç©ºé—´å·+æ•°æ®é¡µå·ï¼Œvalueå°±æ˜¯ç¼“å­˜é¡µçš„åœ°å€ï¼Œé‚£ä¹ˆä¸‹æ¬¡å¦‚æžœä½ å†ä½¿ç”¨è¿™ä¸ªæ•°æ®é¡µï¼Œå°±å¯ä»¥ä»Žå“ˆå¸Œè¡¨é‡Œç›´æŽ¥è¯»å–å‡ºæ¥å®ƒå·²ç»è¢«æ”¾å…¥ä¸€ä¸ªç¼“å­˜é¡µäº†ã€‚

## 3ã€Buffer Poolçš„flushé“¾è¡¨ #

### 3.1 ä¸ºä»€ä¹ˆä¼šæœ‰è„æ•°æ®é¡µï¼Ÿ ##

å‰é¢çš„ç« èŠ‚æˆ‘ä»¬ä¹Ÿè®²è¿‡ï¼Œä½ è¦æ›´æ–°çš„æ•°æ®é¡µéƒ½ä¼šåœ¨Buffer Poolçš„ç¼“å­˜é¡µé‡Œï¼Œä¾›ä½ åœ¨å†…å­˜ä¸­ç›´æŽ¥æ‰§è¡Œå¢žåˆ æ”¹çš„æ“ä½œã€‚æ¯”å¦‚å‰é¢è®²çš„å¦‚ä¸‹æ›´æ–°æ“ä½œï¼š

    update users set name='lisi' where id=2

mysqlè‚¯å®šä¼šåŽ»æ›´æ–°Buffer Poolçš„ç¼“å­˜é¡µä¸­çš„æ•°æ®ï¼Œæ­¤æ—¶ä¸€æ—¦æ›´æ–°äº†ç¼“å­˜é¡µä¸­çš„æ•°æ®ï¼Œé‚£ä¹ˆç¼“å­˜é¡µé‡Œçš„æ•°æ®å’Œç£ç›˜ä¸Šçš„æ•°æ®é¡µé‡Œçš„æ•°æ®ï¼Œæ˜¯ä¸æ˜¯å°±ä¸ä¸€è‡´äº†ï¼Ÿ

è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±è¯´ç¼“å­˜é¡µæ˜¯è„æ•°æ®ï¼Œè„é¡µï¼Œå¦‚ä¸‹å›¾ã€‚è¿™ä¸ªå‰é¢å·²ç»è®²çš„å¾ˆæ˜Žç™½ï¼Œè¿™é‡Œä¸åšè¿‡å¤šé‡å¤è®²è§£ã€‚  
![ç¬‘å°æž«-www.xiaoxiaofeng.com](https://image.xiaoxiaofeng.site/spider/2022/11/2/xxf-1667354599170.jpg)

### 3.2 è„é¡µæ€Žä¹ˆåˆ·å›žç£ç›˜å‘¢ï¼Ÿ ##

æˆ‘ä»¬éƒ½æ˜¯çŸ¥é“ä¸€ç‚¹çš„ï¼Œæœ€ç»ˆè¿™äº›åœ¨å†…å­˜é‡Œæ›´æ–°çš„è„é¡µçš„æ•°æ®ï¼Œéƒ½æ˜¯è¦è¢«åˆ·æ–°å›žç£ç›˜æ–‡ä»¶çš„ã€‚

ä½†æ˜¯è¿™é‡Œå°±æœ‰ä¸€ä¸ªé—®é¢˜äº†ï¼Œä¸å¯èƒ½æ‰€æœ‰çš„ç¼“å­˜é¡µéƒ½åˆ·å›žç£ç›˜çš„ï¼Œå› ä¸ºæœ‰çš„ç¼“å­˜é¡µå¯èƒ½æ˜¯å› ä¸ºæŸ¥è¯¢çš„æ—¶å€™è¢«è¯»å–åˆ°Buffer Poolé‡ŒåŽ»çš„ï¼Œå¯èƒ½æ ¹æœ¬æ²¡ä¿®æ”¹è¿‡ï¼**é‚£mysqlæ˜¯æ€Žä¹ˆåˆ¤æ–­å“ªäº›ç¼“å­˜é¡µéœ€è¦åˆ·å›žç£ç›˜çš„å‘¢ï¼Ÿ**

æ‰€ä»¥mysqlæ•°æ®åº“åœ¨è¿™é‡Œå¼•å…¥äº†å¦å¤–ä¸€ä¸ªè·Ÿfreeé“¾è¡¨ç±»ä¼¼çš„flushé“¾è¡¨ã€‚

**flushé“¾è¡¨ä¹Ÿæ˜¯ç”±æè¿°æ•°æ®å—ç»„æˆï¼Œå‡¡æ˜¯è¢«ä¿®æ”¹è¿‡çš„ç¼“å­˜é¡µï¼Œéƒ½ä¼šæŠŠå®ƒçš„æè¿°æ•°æ®å—åŠ å…¥åˆ°flushé“¾è¡¨ä¸­åŽ»**ã€‚flushçš„æ„æ€å°±æ˜¯è¿™äº›éƒ½æ˜¯è„é¡µï¼ŒåŽç»­éƒ½æ˜¯è¦flushåˆ·æ–°åˆ°ç£ç›˜ä¸ŠåŽ»çš„ã€‚

æ‰€ä»¥flushé“¾è¡¨çš„ç»“æž„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè·Ÿfreeé“¾è¡¨å‡ ä¹Žæ˜¯ä¸€æ ·çš„ï¼Œ**åªä¸è¿‡æ˜¯è„é¡µå¯¹åº”çš„æè¿°æ•°æ®å—ç»„æˆçš„é“¾è¡¨**ï¼Œè¿™é‡Œå°±ä¸è¯¦ç»†ä»‹ç»äº†ã€‚  
![ç¬‘å°æž«-www.xiaoxiaofeng.com](https://image.xiaoxiaofeng.site/spider/2022/11/2/xxf-1667354600284.jpg)  
å¥½å¤šäººçœ‹ä¸Šå›¾è®¤ä¸ºflushé“¾è¡¨æ˜¯æŠŠæè¿°æ•°æ®åº“åˆå¤åˆ¶äº†ä¸€ä»½ï¼Œè¿™æ˜¯é”™è¯¯çš„ï¼

flushé“¾è¡¨å’Œfreeé“¾è¡¨ç±»ä¼¼ï¼Œè¿™é‡Œæ–¹ä¾¿å±•ç¤ºï¼Œå•ç‹¬å¤åˆ¶ä¸€ä»½æè¿°æ•°æ®ï¼Œåªæ˜¯æ–¹ä¾¿å¤§å®¶ç†è§£ã€‚å…¶å®žå†…å­˜ä¸­ä»…æœ‰ä¸€ä»½æè¿°æ•°æ®ã€‚

### 3.3 flushé“¾è¡¨çš„æ€»ç»“ ##

è®²åˆ°è¿™é‡Œï¼Œå¤§å®¶éƒ½åº”è¯¥æ˜Žç™½äº†ï¼Œ**å½“msyqlæ›´æ–°ç¼“å­˜é¡µçš„æ—¶å€™ï¼Œé€šè¿‡å˜æ¢ç¼“å­˜é¡µä¸­çš„æè¿°æ•°æ®å—çš„flushé“¾è¡¨çš„æŒ‡é’ˆï¼Œå°±å¯ä»¥æŠŠè„é¡µçš„æè¿°æ•°æ®å—ç»„æˆä¸€ä¸ªåŒå‘é“¾è¡¨ï¼Œä¹Ÿå°±æ˜¯flushé“¾è¡¨**ï¼Œè€Œä¸”flushé“¾è¡¨çš„åŸºç¡€èŠ‚ç‚¹ä¼šæŒ‡å‘èµ·å§‹èŠ‚ç‚¹å’Œå°¾å·´èŠ‚ç‚¹ã€‚

**é€šè¿‡è¿™ä¸ªflushé“¾è¡¨ï¼Œå°±å¯ä»¥è®°å½•ä¸‹æ¥å“ªäº›ç¼“å­˜é¡µæ˜¯è„é¡µäº†ï¼**

## 4ã€Buffer Poolçš„LRUé“¾è¡¨ #

### 4.1 å½“Buffer Poolä¸­ç¼“å­˜é¡µä¸å¤Ÿäº†æ€Žä¹ˆåŠžï¼Ÿ ##

ä¹‹å‰æˆ‘ä»¬å·²ç»ç»™å¤§å®¶è®²è§£äº†Buffer Poolä¸­çš„ç¼“å­˜é¡µçš„åˆ’åˆ†ï¼ŒåŒ…æ‹¬freeé“¾è¡¨çš„ä½¿ç”¨ï¼Œç„¶åŽç£ç›˜ä¸Šçš„æ•°æ®é¡µæ˜¯å¦‚ä½•åŠ è½½åˆ°ç¼“å­˜é¡µé‡ŒåŽ»çš„ï¼ŒåŒ…æ‹¬å¯¹ç¼“å­˜é¡µä¿®æ”¹ä¹‹åŽï¼Œå½¢æˆå†…å­˜é‡Œçš„è„é¡µï¼Œflushé“¾è¡¨æ˜¯å¦‚ä½•ç”¨æ¥è®°è½½è„æ•°æ®é¡µçš„ã€‚

æˆ‘ä»¬æŽ¥ç€æ¥åˆ†æžBuffer Poolçš„å·¥ä½œåŽŸç†ï¼Œé¦–å…ˆæ¥æ€è€ƒä¸€ä¸ªé—®é¢˜ï¼Œå½“ä½ è¦æ‰§è¡ŒCRUDæ“ä½œçš„æ—¶å€™ï¼Œæ— è®ºæ˜¯æŸ¥è¯¢æ•°æ®ï¼Œè¿˜æ˜¯ä¿®æ”¹æ•°æ®ï¼Œå®žé™…ä¸Šéƒ½ä¼šæŠŠç£ç›˜ä¸Šçš„æ•°æ®é¡µåŠ è½½åˆ°ç¼“å­˜é¡µé‡Œæ¥ï¼Œè¿™ä¸ªå¤§å®¶éƒ½æ˜¯æ²¡æœ‰é—®é¢˜çš„å§ï¼Ÿ

é‚£ä¹ˆåœ¨åŠ è½½æ•°æ®åˆ°ç¼“å­˜é¡µçš„æ—¶å€™ï¼Œå¿…ç„¶æ˜¯è¦åŠ è½½åˆ°ç©ºé—²çš„ç¼“å­˜é¡µé‡ŒåŽ»çš„ï¼Œæ‰€ä»¥å¿…é¡»è¦ä»Žfreeé“¾è¡¨ä¸­æ‰¾ä¸€ä¸ªç©ºé—²çš„ç¼“å­˜é¡µï¼Œç„¶åŽæŠŠç£ç›˜ä¸Šçš„æ•°æ®é¡µåŠ è½½åˆ°é‚£ä¸ªç©ºé—²çš„ç¼“å­˜é¡µé‡ŒåŽ»ã€‚

é‚£ä¹ˆå¤§å®¶é€šè¿‡ä¹‹å‰çš„å­¦ä¹ è‚¯å®šéƒ½çŸ¥é“äº†ï¼Œéšç€ä½ ä¸åœçš„æŠŠç£ç›˜ä¸Šçš„æ•°æ®é¡µåŠ è½½åˆ°ç©ºé—²çš„ç¼“å­˜é¡µé‡ŒåŽ»ï¼Œfreeé“¾è¡¨ä¸­çš„ç©ºé—²ç¼“å­˜é¡µæ˜¯ä¸æ˜¯ä¼šè¶Šæ¥è¶Šå°‘ï¼Ÿå› ä¸ºåªè¦ä½ æŠŠä¸€ä¸ªæ•°æ®é¡µåŠ è½½åˆ°ä¸€ä¸ªç©ºé—²ç¼“å­˜é¡µé‡ŒåŽ»ï¼Œfreeé“¾è¡¨ä¸­å°±ä¼šå‡å°‘ä¸€ä¸ªç©ºé—²ç¼“å­˜é¡µã€‚

æ‰€ä»¥ï¼Œ**å½“ä½ ä¸åœçš„æŠŠç£ç›˜ä¸Šçš„æ•°æ®é¡µåŠ è½½åˆ°ç©ºé—²ç¼“å­˜é¡µé‡ŒåŽ»ï¼Œfreeé“¾è¡¨ä¸­ä¸åœçš„ç§»é™¤ç©ºé—²ç¼“å­˜é¡µï¼Œè¿Ÿæ—©æœ‰é‚£ä¹ˆä¸€çž¬é—´ï¼Œä½ ä¼šå‘çŽ°freeé“¾è¡¨ä¸­å·²ç»æ²¡æœ‰ç©ºé—²ç¼“å­˜é¡µäº†ã€‚**

è¿™ä¸ªæ—¶å€™ï¼Œå½“ä½ è¿˜è¦åŠ è½½æ•°æ®é¡µåˆ°ä¸€ä¸ªç©ºé—²ç¼“å­˜é¡µçš„æ—¶å€™ï¼Œæ€Žä¹ˆåŠžå‘¢ï¼Ÿå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š  
![ç¬‘å°æž«-www.xiaoxiaofeng.com](https://image.xiaoxiaofeng.site/spider/2022/11/2/xxf-1667354601540.jpg)

### 4.2 å¦‚æžœè¦æ·˜æ±°æŽ‰ä¸€äº›ç¼“å­˜æ•°æ®ï¼Œæ·˜æ±°è°ï¼Ÿ ##

é’ˆå¯¹ä¸Šè¿°çš„é—®é¢˜ï¼Œå¤§å®¶æ¥æ€è€ƒä¸‹ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æžœæ‰€æœ‰çš„ç¼“å­˜é¡µéƒ½è¢«å¡žäº†æ•°æ®äº†ï¼Œæ­¤æ—¶æ— æ³•ä»Žç£ç›˜ä¸ŠåŠ è½½æ–°çš„æ•°æ®é¡µåˆ°ç¼“å­˜é¡µé‡ŒåŽ»äº†ï¼Œé‚£ä¹ˆæ­¤æ—¶ä½ åªæœ‰ä¸€ä¸ªåŠžæ³•ï¼Œå°±æ˜¯æ·˜æ±°æŽ‰ä¸€äº›ç¼“å­˜é¡µã€‚

é‚£ä»€ä¹ˆå«æ·˜æ±°ç¼“å­˜é¡µå‘¢ï¼Ÿ

é¡¾åæ€ä¹‰ï¼Œä½ å¿…é¡»æŠŠä¸€ä¸ªç¼“å­˜é¡µé‡Œè¢«ä¿®æ”¹è¿‡çš„æ•°æ®ï¼Œç»™ä»–åˆ·åˆ°ç£ç›˜ä¸Šçš„æ•°æ®é¡µé‡ŒåŽ»ï¼Œç„¶åŽè¿™ä¸ªç¼“å­˜é¡µå°±å¯ä»¥æ¸…ç©ºäº†ï¼Œè®©ä»–é‡æ–°å˜æˆä¸€ä¸ªç©ºé—²çš„ç¼“å­˜é¡µã€‚

æŽ¥ç€ä½ å†æŠŠç£ç›˜ä¸Šä½ éœ€è¦çš„æ–°çš„æ•°æ®é¡µåŠ è½½åˆ°è¿™ä¸ªè…¾å‡ºæ¥çš„ç©ºé—²ç¼“å­˜é¡µä¸­åŽ»ï¼Œå¦‚ä¸‹å›¾ã€‚

![ç¬‘å°æž«-www.xiaoxiaofeng.com](https://image.xiaoxiaofeng.site/spider/2022/11/2/xxf-1667354603079.jpg)  
é‚£ä¹ˆä¸‹ä¸€ä¸ªé—®é¢˜æ¥äº†ï¼Œå¦‚æžœè¦æŠŠä¸€ä¸ªç¼“å­˜é¡µé‡Œçš„æ•°æ®åˆ·å…¥ç£ç›˜ï¼Œè…¾å‡ºæ¥ä¸€ä¸ªç©ºé—²ç¼“å­˜é¡µï¼Œé‚£ä¹ˆåº”è¯¥æŠŠå“ªä¸ªç¼“å­˜é¡µçš„æ•°æ®ç»™åˆ·å…¥ç£ç›˜å‘¢ï¼Ÿ

### 4.3 ç¼“å­˜å‘½ä¸­çŽ‡æ¦‚å¿µ ##

è¦è§£ç­”è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å°±å¾—å¼•å…¥ä¸€ä¸ªç¼“å­˜å‘½ä¸­çŽ‡çš„æ¦‚å¿µã€‚

 *  å‡è®¾çŽ°åœ¨æœ‰ä¸¤ä¸ªç¼“å­˜é¡µï¼Œä¸€ä¸ªç¼“å­˜é¡µçš„æ•°æ®ï¼Œç»å¸¸ä¼šè¢«ä¿®æ”¹å’ŒæŸ¥è¯¢ï¼Œæ¯”å¦‚åœ¨100æ¬¡è¯·æ±‚ä¸­ï¼Œæœ‰30æ¬¡éƒ½æ˜¯åœ¨æŸ¥è¯¢å’Œä¿®æ”¹è¿™ä¸ªç¼“å­˜é¡µé‡Œçš„æ•°æ®ã€‚é‚£ä¹ˆæ­¤æ—¶æˆ‘ä»¬å¯ä»¥è¯´è¿™ç§æƒ…å†µä¸‹ï¼Œç¼“å­˜å‘½ä¸­çŽ‡å¾ˆé«˜ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸º100æ¬¡è¯·æ±‚ä¸­ï¼Œ30æ¬¡éƒ½å¯ä»¥æ“ä½œç¼“å­˜ï¼Œä¸éœ€è¦ä»Žç£ç›˜åŠ è½½æ•°æ®ï¼Œè¿™ä¸ªç¼“å­˜å‘½ä¸­çŽ‡å°±æ¯”è¾ƒé«˜äº†ã€‚
 *  å¦å¤–ä¸€ä¸ªç¼“å­˜é¡µé‡Œçš„æ•°æ®ï¼Œå°±æ˜¯åˆšä»Žç£ç›˜åŠ è½½åˆ°ç¼“å­˜é¡µä¹‹åŽï¼Œè¢«ä¿®æ”¹å’ŒæŸ¥è¯¢è¿‡1æ¬¡ï¼Œä¹‹åŽ100æ¬¡è¯·æ±‚ä¸­æ²¡æœ‰ä¸€æ¬¡æ˜¯ä¿®æ”¹å’ŒæŸ¥è¯¢è¿™ä¸ªç¼“å­˜é¡µçš„æ•°æ®çš„ï¼Œé‚£ä¹ˆæ­¤æ—¶æˆ‘ä»¬å°±è¯´ç¼“å­˜å‘½ä¸­çŽ‡æœ‰ç‚¹ä½Žï¼Œå› ä¸ºå¤§éƒ¨åˆ†è¯·æ±‚å¯èƒ½è¿˜éœ€è¦èµ°ç£ç›˜æŸ¥è¯¢æ•°æ®ï¼Œä»–ä»¬è¦æ“ä½œçš„æ•°æ®ä¸åœ¨ç¼“å­˜ä¸­ã€‚

æ‰€ä»¥é’ˆå¯¹ä¸Šè¿°ä¸¤ä¸ªç¼“å­˜é¡µï¼Œå‡è®¾æ­¤æ—¶è®©ä½ åšä¸€ä¸ªæŠ‰æ‹©ï¼Œè¦æŠŠå…¶ä¸­ç¼“å­˜é¡µçš„æ•°æ®åˆ·å…¥åˆ°ç£ç›˜åŽ»ï¼Œè…¾å‡ºæ¥ä¸€ä¸ªç©ºé—²çš„ç¼“å­˜é¡µï¼Œæ­¤æ—¶ä½ ä¼šé€‰æ‹©è°ï¼Ÿ

é‚£è¿˜ç”¨æƒ³ä¹ˆï¼Œå½“ç„¶æ˜¯é€‰æ‹©ç¬¬äºŒä¸ªç¼“å­˜é¡µåˆ·å…¥ç£ç›˜ä¸­äº†ï¼å› ä¸ºç¬¬äºŒä¸ªç¼“å­˜é¡µï¼ŒåŽ‹æ ¹å„¿å°±æ²¡ä»€ä¹ˆäººæ¥ä½¿ç”¨ä»–é‡Œé¢çš„æ•°æ®ï¼Œç»“æžœè¿™äº›æ•°æ®è¿˜ç©ºå æ®äº†ä¸€ä¸ªç¼“å­˜é¡µï¼Œè¿™ä¸æ˜¯ç™½ç™½æµªè´¹ç¼“å­˜é¡µå—ï¼Ÿ

### 4.4 å¼•å…¥LRUé“¾è¡¨æ¥åˆ¤æ–­å“ªäº›ç¼“å­˜é¡µæ˜¯ä¸å¸¸ç”¨çš„ ##

æŽ¥ç€æˆ‘ä»¬å°±è¦è§£å†³ä¸‹ä¸€ä¸ªé—®é¢˜äº†ï¼Œå°±æ˜¯ä½ æ€Žä¹ˆçŸ¥é“å“ªäº›ç¼“å­˜é¡µç»å¸¸è¢«è®¿é—®ï¼Œå“ªäº›ç¼“å­˜é¡µå¾ˆå°‘è¢«è®¿é—®ï¼Ÿ

æ­¤æ—¶å°±è¦å¼•å…¥ä¸€ä¸ªæ–°çš„LRUé“¾è¡¨äº†ï¼Œè¿™ä¸ªæ‰€è°“çš„LRUå°±æ˜¯Least Recently Usedï¼Œ**æœ€è¿‘æœ€å°‘ä½¿ç”¨**çš„æ„æ€ã€‚

**é€šè¿‡è¿™ä¸ªLRUé“¾è¡¨ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“å“ªäº›ç¼“å­˜é¡µæ˜¯æœ€è¿‘æœ€å°‘è¢«ä½¿ç”¨çš„ï¼Œé‚£ä¹ˆå½“ä½ ç¼“å­˜é¡µéœ€è¦è…¾å‡ºæ¥ä¸€ä¸ªåˆ·å…¥ç£ç›˜çš„æ—¶å€™ï¼Œä¸å°±å¯ä»¥é€‰æ‹©é‚£ä¸ªLRUé“¾è¡¨ä¸­æœ€è¿‘æœ€å°‘è¢«ä½¿ç”¨çš„ç¼“å­˜é¡µäº†ä¹ˆ**ï¼Ÿ

è¿™ä¸ªLRUé“¾è¡¨å¤§è‡´æ˜¯æ€Žä¹ˆä¸ªå·¥ä½œåŽŸç†å‘¢ï¼Ÿ

ç®€å•æ¥è¯´ï¼Œæˆ‘ä»¬çœ‹ä¸‹å›¾ï¼Œå‡è®¾æˆ‘ä»¬ä»Žç£ç›˜åŠ è½½ä¸€ä¸ªæ•°æ®é¡µåˆ°ç¼“å­˜é¡µçš„æ—¶å€™ï¼Œå°±æŠŠè¿™ä¸ªç¼“å­˜é¡µçš„æè¿°æ•°æ®å—æ”¾åˆ°LRUé“¾è¡¨å¤´éƒ¨åŽ»ï¼Œé‚£ä¹ˆåªè¦æœ‰æ•°æ®çš„ç¼“å­˜é¡µï¼Œä»–éƒ½ä¼šåœ¨LRUé‡Œäº†ï¼Œè€Œä¸”æœ€è¿‘è¢«åŠ è½½æ•°æ®çš„ç¼“å­˜é¡µï¼Œéƒ½ä¼šæ”¾åˆ°LRUé“¾è¡¨çš„å¤´éƒ¨åŽ»ã€‚  
![ç¬‘å°æž«-www.xiaoxiaofeng.com](https://image.xiaoxiaofeng.site/spider/2022/11/2/xxf-1667354604106.jpg)  
ç„¶åŽå‡è®¾æŸä¸ªç¼“å­˜é¡µçš„æè¿°æ•°æ®å—æœ¬æ¥åœ¨LRUé“¾è¡¨çš„å°¾éƒ¨ï¼ŒåŽç»­ä½ åªè¦æŸ¥è¯¢æˆ–è€…ä¿®æ”¹äº†è¿™ä¸ªç¼“å­˜é¡µçš„æ•°æ®ï¼Œä¹Ÿè¦æŠŠè¿™ä¸ªç¼“å­˜é¡µæŒªåŠ¨åˆ°LRUé“¾è¡¨çš„å¤´éƒ¨åŽ»ï¼Œä¹Ÿå°±æ˜¯è¯´æœ€è¿‘è¢«è®¿é—®è¿‡çš„ç¼“å­˜é¡µï¼Œä¸€å®šåœ¨LRUé“¾è¡¨çš„å¤´éƒ¨ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š  
![ç¬‘å°æž«-www.xiaoxiaofeng.com](https://image.xiaoxiaofeng.site/spider/2022/11/2/xxf-1667354605805.jpg)  
é‚£ä¹ˆè¿™æ ·çš„è¯ï¼Œå½“ä½ çš„ç¼“å­˜é¡µæ²¡æœ‰ä¸€ä¸ªç©ºé—²çš„æ—¶å€™ï¼Œä½ æ˜¯ä¸æ˜¯è¦æ‰¾å‡ºæ¥é‚£ä¸ªæœ€è¿‘æœ€å°‘è¢«è®¿é—®çš„ç¼“å­˜é¡µåŽ»åˆ·å…¥ç£ç›˜ï¼Ÿ**æ­¤æ—¶ä½ å°±ç›´æŽ¥åœ¨LRUé“¾è¡¨çš„å°¾éƒ¨æ‰¾åˆ°ä¸€ä¸ªç¼“å­˜é¡µï¼Œå®ƒä¸€å®šæ˜¯æœ€è¿‘æœ€å°‘è¢«è®¿é—®çš„é‚£ä¸ªç¼“å­˜é¡µï¼**

**ç„¶åŽä½ å°±æŠŠLRUé“¾è¡¨å°¾éƒ¨çš„é‚£ä¸ªç¼“å­˜é¡µåˆ·å…¥ç£ç›˜ä¸­ï¼Œç„¶åŽæŠŠä½ éœ€è¦çš„ç£ç›˜æ•°æ®é¡µåŠ è½½åˆ°è…¾å‡ºæ¥çš„ç©ºé—²ç¼“å­˜é¡µä¸­å°±å¯ä»¥äº†ï¼**

## å…³äºŽç¬‘å°æž«ðŸ’•

> æœ¬ç« åˆ°è¿™é‡Œç»“æŸäº†ï¼Œå–œæ¬¢çš„æœ‹å‹å…³æ³¨ä¸€ä¸‹æˆ‘å‘¦ï¼Œå¤§ä¼™çš„æ”¯æŒï¼Œå°±æ˜¯æˆ‘åšæŒå†™ä¸‹åŽ»çš„åŠ¨åŠ›ã€‚
>
> å¾®ä¿¡å…¬ä¼—å·ï¼šç¬‘å°æž«
>
> ç¬‘å°æž«ä¸ªäººåšå®¢ï¼š[https://www.xiaoxiaofeng.com](https://www.xiaoxiaofeng.com)
>
> CSDNï¼š[https://zhangfz.blog.csdn.net](https://zhangfz.blog.csdn.net)
>

