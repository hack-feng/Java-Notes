## åŠŸèƒ½èƒŒæ™¯

ç®€å•çš„è¯´ä¸‹è¿™ä¸ªåŠŸèƒ½çš„èƒŒæ™¯éœ€æ±‚å§ï¼Œæœ‰ç±»ä¼¼éœ€æ±‚çš„å¯ä»¥å¤ç”¨

* å®ç°excelå¯¼å…¥ï¼ˆåºŸè¯...ï¼‰
* å¤šä¸ªsheeté¡µä¸€èµ·å¯¼å…¥
* ç¬¬ä¸€ä¸ªsheeté¡µæ•°æ®è¡¨å¤´ä¿¡æ¯æœ‰ä¸¤è¡Œï¼Œä½†åªéœ€æ ¹æ®ç¬¬äºŒè¡Œå¯¼å…¥
* å¦‚æœæŠ¥é”™ï¼Œæ ¹æ®ä¸åŒçš„sheeté¡µè¿”å›å¤šä¸ªListè®°å½•æŠ¥é”™åŸå› 
* æ•°æ®é‡ç¨å¾®æœ‰äº›å¤§ï¼ˆå¤šä¸ªsheeté¡µæ€»é‡50wå·¦å³ï¼‰



## é¡¹ç›®å¼•å…¥ä¾èµ–

gradle:
~~~
compile "com.alibaba:easyexcel:3.1.0"
~~~

maven:
~~~xml
<dependency>
    <groupId>com.alibaba</groupId>
    <artifactId>easyexcel</artifactId>
    <version>3.1.0</version>
</dependency>
~~~

æ³¨æ„ï¼š 3+ç‰ˆæœ¬çš„çš„easyexcelï¼Œä½¿ç”¨poi 5+ç‰ˆæœ¬æ—¶ï¼Œéœ€è¦æ‰‹åŠ¨æ’é™¤ï¼špoi-ooxml-schemasï¼Œä¾‹å¦‚ï¼š
~~~xml
<dependency>
    <groupId>com.alibaba</groupId>
    <artifactId>easyexcel</artifactId>
    <version>3.1.0</version>
    <exclusions>
        <exclusion>
            <artifactId>poi-ooxml-schemas</artifactId>
            <groupId>org.apache.poi</groupId>
        </exclusion>
    </exclusions>
</dependency>
~~~

## Excelæ¨¡æ¿ 

è¿™é‡Œæ¼”ç¤ºä¸€ä¸‹ä¸¤ä¸ªsheeté¡µï¼Œç¬¬ä¸€ä¸ªsheeté¡µå–ç¬¬äºŒè¡Œæ ‡é¢˜ï¼Œç¬¬äºŒä¸ªsheeté¡µå–ç¬¬ä¸€è¡Œæ ‡é¢˜çš„excelæ“ä½œï¼Œåªä¸ºæ¼”ç¤ºï¼Œç‰¹æ®Šçš„å¯ä»¥æ ¹æ®è¿™ä¸ªå®é™…æƒ…å†µè¿›è¡Œæ‹“å±•ã€‚ğŸ¾

![image-20220607103913456](https://s2.loli.net/2022/07/21/qtRmr3ikFsfhB5o.png)

![image-20220607104050544](https://s2.loli.net/2022/07/21/ZeT42zm7b8Pk5Bl.png)

[ç‚¹å‡»ä¸‹è½½æ¨¡æ¿ï¼ˆhttp://file.xiaoxiaofeng.site/blog/image/ç¬‘å°æ«æµ‹è¯•å¯¼å…¥.xlsï¼‰](http://file.xiaoxiaofeng.site/blog/image/ç¬‘å°æ«æµ‹è¯•å¯¼å…¥.xls)

## é¡¹ç›®ç¼–ç 

åœ¨config.beanåŒ…ä¸‹æ–°å»º`excel`åŒ…ï¼Œç”¨äºå­˜æ”¾excelå¤„ç†ç›¸å…³çš„ä»£ç 

* åœ¨excelåŒ…ä¸‹å®šä¹‰é€šç”¨çš„`CommonExcel.java`å¯¹è±¡ï¼Œåªè¦ç”¨äºè®°å½•è¡Œå·

~~~java
package com.maple.demo.config.bean.excel;

import com.alibaba.excel.annotation.ExcelIgnore;
import lombok.Data;

/**
 * @author ç¬‘å°æ«
 * @date 2022/7/22
 */
@Data
public class CommonExcel {
    
    /**
     * è¡Œå·
     */
    @ExcelIgnore
    private Integer rowIndex;

}
~~~

* åœ¨excelåŒ…ä¸‹å®šä¹‰ç»é”€å•†ä¿¡æ¯å¯¹è±¡`ImportCompany.java`ï¼Œä»£ç å¦‚ä¸‹ï¼š

@ExcelProperty å¯¹ç”¨çš„æ˜¯excelçš„æ ‡é¢˜åç§°ï¼Œå¦‚æœä¸åŠ @ExcelPropertyï¼Œé»˜è®¤å¯¹åº”åˆ—å·

~~~java
package com.maple.demo.config.bean.excel;

import com.alibaba.excel.annotation.ExcelProperty;
import lombok.Data;
import java.util.Date;

/**
 * @author ç¬‘å°æ«
 * @date 2022/7/22
 */
@Data
public class ImportCompany {

    // -------------------- åŸºæœ¬ä¿¡æ¯ start -------------

    @ExcelProperty("å…¬å¸åç§°")
    private String companyName;

    @ExcelProperty("çœä»½")
    private String province;

    @ExcelProperty("æˆç«‹æ—¶é—´")
    private Date startDate;

    @ExcelProperty("ä¼ä¸šçŠ¶æ€")
    private String entStatus;

    @ExcelProperty("æ³¨å†Œåœ°å€")
    private String registerAddress;

    // ---------------- åŸºæœ¬ä¿¡æ¯ end ---------------------

    // ---------------- ç»è¥ä¿¡æ¯ start ---------------------

    @ExcelProperty("å‘˜å·¥æ•°")
    private String employeeMaxCount;

    @ExcelProperty("ç»è¥è§„æ¨¡")
    private String newManageScaleName;

    @ExcelProperty("æ‰€å±åŒºåŸŸçœ")
    private String businessProvinceName;

    @ExcelProperty("æ‰€å±åŒºåŸŸå¸‚")
    private String businessCityName;

    @ExcelProperty("æ‰€å±åŒºåŸŸåŒºå¿")
    private String businessAreaName;

    // ---------------- ç»è¥ä¿¡æ¯ end ---------------------
}
~~~

* åœ¨excelåŒ…ä¸‹å®šä¹‰è”ç³»äººä¿¡æ¯å¯¹è±¡`ImportContact.java`ï¼Œä»£ç å¦‚ä¸‹ï¼š

~~~java
package com.maple.demo.config.bean.excel;

import com.alibaba.excel.annotation.ExcelProperty;
import lombok.Data;

/**
 * @author ç¬‘å°æ«
 * @date 2022/7/22
 */
@Data
public class ImportContact {
    @ExcelProperty("å…¬å¸åç§°")
    private String companyName;

    @ExcelProperty("å§“å")
    private String name;

    @ExcelProperty("èº«ä»½è¯å·ç ")
    private String idCard;

    @ExcelProperty("ç”µè¯å·ç ")
    private String mobile;

    @ExcelProperty("èŒä½")
    private String contactPostName;
}
~~~

* åœ¨listeneråŒ…ä¸‹å®šä¹‰excelå¤„ç†çš„ç›‘å¬å™¨`ImportExcelListener.java`ï¼Œä»£ç å¦‚ä¸‹ï¼š

~~~java
package com.maple.demo.listener;

import com.alibaba.excel.context.AnalysisContext;
import com.alibaba.excel.exception.ExcelDataConvertException;
import com.alibaba.excel.read.listener.ReadListener;
import com.alibaba.excel.read.metadata.holder.ReadRowHolder;
import com.alibaba.excel.util.ListUtils;
import com.maple.demo.config.bean.excel.CommonExcel;
import lombok.extern.slf4j.Slf4j;
import org.apache.commons.collections4.CollectionUtils;

import java.util.List;
import java.util.function.Consumer;

/**
 * @author ç¬‘å°æ«
 * @date 2022/7/22
 */
@Slf4j
public class ImportExcelListener<T> implements ReadListener<T> {

    /**
     * é»˜è®¤ä¸€æ¬¡è¯»å–1000æ¡ï¼Œå¯æ ¹æ®å®é™…ä¸šåŠ¡å’ŒæœåŠ¡å™¨è°ƒæ•´
     */
    private static final int BATCH_COUNT = 1000;
    /**
     * Temporary storage of data
     */
    private List<T> cachedDataList = ListUtils.newArrayListWithExpectedSize(BATCH_COUNT);

    private final List<String> errorMsgList;

    /**
     * consumer
     */
    private final Consumer<List<T>> consumer;

    public ImportExcelListener(Consumer<List<T>> consumer, List<String> errorMsgList) {
        this.consumer = consumer;
        this.errorMsgList = errorMsgList;
    }

    @Override
    public void invoke(T data, AnalysisContext context) {
        // è®°å½•è¡Œå·
        if (data instanceof CommonExcel) {
            ReadRowHolder readRowHolder = context.readRowHolder();
            ((CommonExcel) data).setRowIndex(readRowHolder.getRowIndex() + 1);
        }
        cachedDataList.add(data);
        if (cachedDataList.size() >= BATCH_COUNT) {
            consumer.accept(cachedDataList);
            cachedDataList = ListUtils.newArrayListWithExpectedSize(BATCH_COUNT);
        }
    }

    @Override
    public void doAfterAllAnalysed(AnalysisContext context) {
        if (CollectionUtils.isNotEmpty(cachedDataList)) {
            consumer.accept(cachedDataList);
        }
    }

    /**
     * åœ¨è½¬æ¢å¼‚å¸¸ è·å–å…¶ä»–å¼‚å¸¸ä¸‹ä¼šè°ƒç”¨æœ¬æ¥å£ã€‚æŠ›å‡ºå¼‚å¸¸åˆ™åœæ­¢è¯»å–ã€‚å¦‚æœè¿™é‡Œä¸æŠ›å‡ºå¼‚å¸¸åˆ™ ç»§ç»­è¯»å–ä¸‹ä¸€è¡Œã€‚
     */
    @Override
    public void onException(Exception exception, AnalysisContext context) {
        // å¦‚æœæ˜¯æŸä¸€ä¸ªå•å…ƒæ ¼çš„è½¬æ¢å¼‚å¸¸ èƒ½è·å–åˆ°å…·ä½“è¡Œå·
        String errorMsg = String.format("%sï¼Œ ç¬¬%dè¡Œè§£æå¼‚å¸¸", context.readSheetHolder().getReadSheet().getSheetName(),
                context.readRowHolder().getRowIndex() + 1);
        if (exception instanceof ExcelDataConvertException) {
            ExcelDataConvertException excelDataConvertException = (ExcelDataConvertException) exception;
            errorMsg = String.format("ç¬¬%dè¡Œï¼Œç¬¬%dåˆ—æ•°æ®è§£æå¼‚å¸¸",
                    excelDataConvertException.getRowIndex() + 1,
                    excelDataConvertException.getColumnIndex() + 1);
            log.error("{}ï¼Œ ç¬¬{}è¡Œï¼Œç¬¬{}åˆ—è§£æå¼‚å¸¸ï¼Œæ•°æ®ä¸º:{}",
                    context.readSheetHolder().getReadSheet().getSheetName(),
                    excelDataConvertException.getRowIndex() + 1,
                    excelDataConvertException.getColumnIndex() + 1,
                    excelDataConvertException.getCause().getMessage());
        } else {
            log.error(errorMsg + exception.getMessage());
        }
        errorMsgList.add(errorMsg);
    }
}
~~~

* ç¼–å†™controllerè¿›è¡Œæµ‹è¯•ï¼Œä»£ç å¦‚ä¸‹ï¼š

~~~
.readSheet(0)  è¯»å–å“ªä¸ªsheeté¡µï¼Œé»˜è®¤ä»0å¼€å§‹

.head(ExcelCompany.class) å¯¹åº”å®šä¹‰çš„sheeté¡µå¯¹è±¡ï¼Œä¸åŒçš„sheeté¡µä½¿ç”¨å¯¹åº”çš„å¯¹è±¡

.registerReadListener ä½¿ç”¨çš„ç›‘å¬å™¨ï¼Œè¿™é‡Œå®šä¹‰çš„æ—¶é€šç”¨çš„ï¼Œæ ¹æ®ä¸åŒçš„ä¸šåŠ¡é€»è¾‘ï¼Œå¯ä»¥å®šä¹‰ä¸åŒçš„ç›‘å¬å™¨å¤„ç†ï¼Œå¦‚éœ€ç‰¹æ®Šçš„è¿”å›å¤„ç†ï¼Œå¯ä»¥å®šä¹‰å¤šä¸ªå‚æ•°çš„æ„é€ å™¨ï¼Œåœ¨ç›‘å¬å™¨é‡Œé¢å¤„ç†è¿”å›

.headRowNumber(2) æ ‡é¢˜è¡Œåœ¨ç¬¬å‡ è¡Œ
~~~

~~~java
package com.maple.demo.controller;

import com.alibaba.excel.EasyExcelFactory;
import com.alibaba.excel.ExcelReader;
import com.alibaba.excel.read.metadata.ReadSheet;
import com.alibaba.fastjson.JSON;
import com.maple.demo.config.bean.excel.ImportCompany;
import com.maple.demo.config.bean.excel.ImportContact;
import com.maple.demo.listener.ImportExcelListener;
import io.swagger.annotations.Api;
import lombok.extern.slf4j.Slf4j;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;
import org.springframework.web.multipart.MultipartFile;

import java.io.IOException;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

/**
 * @author ç¬‘å°æ«
 * @date 2022/7/22
 */
@Slf4j
@RestController
@RequestMapping("/example")
@Api(tags = "å®ä¾‹æ¼”ç¤º-å¯¼å…¥Excel")
public class TestImportExcelController {

    @PostMapping("/importExcel")
    public Map<String, List<String>> importExcel(@RequestParam(value = "file") MultipartFile file) {
        List<String> companyErrorList = new ArrayList<>();
        List<String> contactErrorList = new ArrayList<>();
        try (ExcelReader excelReader = EasyExcelFactory.read(file.getInputStream()).build()) {
            // å…¬å¸ä¿¡æ¯æ„é€ å™¨
            ReadSheet dealerSheet = EasyExcelFactory
                    .readSheet(0)
                    .head(ImportCompany.class)
                    .registerReadListener(new ImportExcelListener<ImportCompany>(data -> {
                        // å¤„ç†ä½ çš„ä¸šåŠ¡é€»è¾‘ï¼Œæœ€å¥½æŠ½å‡ºä¸€ä¸ªæ–¹æ³•å•ç‹¬å¤„ç†é€»è¾‘
                        log.info("å…¬å¸ä¿¡æ¯æ•°æ®----------------------------------------------");
                        log.info("å…¬å¸ä¿¡æ¯æ•°æ®ï¼š" + JSON.toJSONString(data));
                        log.info("å…¬å¸ä¿¡æ¯æ•°æ®----------------------------------------------");
                    }, companyErrorList))
                    .headRowNumber(2)
                    .build();

            // è”ç³»äººä¿¡æ¯æ„é€ å™¨
            ReadSheet contactSheet = EasyExcelFactory
                    .readSheet(1)
                    .head(ImportContact.class)
                    .registerReadListener(new ImportExcelListener<ImportContact>(data -> {
                        // å¤„ç†ä½ çš„ä¸šåŠ¡é€»è¾‘ï¼Œæœ€å¥½æŠ½å‡ºä¸€ä¸ªæ–¹æ³•å•ç‹¬å¤„ç†é€»è¾‘
                        log.info("è”ç³»äººä¿¡æ¯æ•°æ®------------------------------------------");
                        log.info("è”ç³»äººä¿¡æ¯æ•°æ®ï¼š" + JSON.toJSONString(data));
                        log.info("è”ç³»äººä¿¡æ¯æ•°æ®------------------------------------------");
                    }, contactErrorList))
                    .build();

            // è¿™é‡Œæ³¨æ„ ä¸€å®šè¦æŠŠsheet1 sheet2 ä¸€èµ·ä¼ è¿›å»ï¼Œä¸ç„¶æœ‰ä¸ªé—®é¢˜å°±æ˜¯03ç‰ˆçš„excel ä¼šè¯»å–å¤šæ¬¡ï¼Œæµªè´¹æ€§èƒ½
            excelReader.read(dealerSheet, contactSheet);
        } catch (IOException e) {
            log.error("å¤„ç†excelå¤±è´¥ï¼Œ" + e.getMessage());
        }
        Map<String, List<String>> result = new HashMap<>(16);
        result.put("company", companyErrorList);
        result.put("contact", contactErrorList);
        log.info("å¯¼å…¥excelå®Œæˆï¼Œè¿”å›ç»“æœå¦‚ä¸‹ï¼š" + JSON.toJSONString(result));
        return result;
    }
}
~~~

## æµ‹è¯•ç»“æœ

å› ä¸ºéœ€è¦ä¸Šä¼ excelæ–‡ä»¶ï¼Œè¿™é‡Œé€šè¿‡postmanè¿›è¡Œè°ƒç”¨ï¼Œideaæ§åˆ¶å°æ‰“å°ç»“æœå¦‚ä¸‹ï¼š

![image-20220721173544417](https://s2.loli.net/2022/07/21/ceo6fQab8XPdzSr.png)

postmanè¿”å›çš„ç»“æœæ•°æ®å¦‚ä¸‹ï¼š

~~~json
{
    "msg": "",
    "obj": {
        "contact": [],
        "company": []
    },
    "result": "0000",
    "serverTime": 1654569757952
}
~~~

æ¨¡æ‹Ÿä¸€ä¸‹ï¼Œæ•°æ®è½¬æ¢é”™è¯¯çš„åœºæ™¯ï¼Œæ•…æ„æŠŠæ—¶é—´å†™é”™ï¼Œå¦‚ä¸‹å›¾ï¼š

![image-20220607104425421](https://s2.loli.net/2022/07/21/fwXTaM6nHUOuAq5.png)

é€šè¿‡postmanè¿›è¡Œè°ƒç”¨ï¼Œideaæ§åˆ¶å°æ‰“å°ç»“æœå¦‚ä¸‹ï¼š

![image-20220721173754295](https://s2.loli.net/2022/07/21/nTuDNIWy1AOerUK.png)

> åœ¨controlleræ·»åŠ `@RequestMapping("/example")`å¯ä»¥é¿å…tokenæ ¡éªŒï¼Œåœ¨æ‹¦æˆªå™¨é‡Œé¢å·²ç»æ”¾å¼€äº†`/example/**`çš„è¯·æ±‚ã€‚

postmanè¿”å›çš„ç»“æœæ•°æ®å¦‚ä¸‹ï¼š

![image-20220721173710993](https://s2.loli.net/2022/07/21/DWwYNSkcunhBF9v.png)

## ç›¸å…³å±æ€§è§£è¯»

### æ³¨è§£

- `ExcelProperty` æŒ‡å®šå½“å‰å­—æ®µå¯¹åº”excelä¸­çš„é‚£ä¸€åˆ—ã€‚å¯ä»¥æ ¹æ®åå­—æˆ–è€…Indexå»åŒ¹é…ã€‚å½“ç„¶ä¹Ÿå¯ä»¥ä¸å†™ï¼Œé»˜è®¤ç¬¬ä¸€ä¸ªå­—æ®µå°±æ˜¯index=0ï¼Œä»¥æ­¤ç±»æ¨ã€‚åƒä¸‡æ³¨æ„ï¼Œè¦ä¹ˆå…¨éƒ¨ä¸å†™ï¼Œè¦ä¹ˆå…¨éƒ¨ç”¨indexï¼Œè¦ä¹ˆå…¨éƒ¨ç”¨åå­—å»åŒ¹é…ã€‚åƒä¸‡åˆ«ä¸‰ä¸ªæ··ç€ç”¨ï¼Œé™¤éä½ éå¸¸äº†è§£æºä»£ç ä¸­ä¸‰ä¸ªæ··ç€ç”¨æ€ä¹ˆå»æ’åºçš„ã€‚
- `ExcelIgnore` é»˜è®¤æ‰€æœ‰å­—æ®µéƒ½ä¼šå’Œexcelå»åŒ¹é…ï¼ŒåŠ äº†è¿™ä¸ªæ³¨è§£ä¼šå¿½ç•¥è¯¥å­—æ®µ
- `DateTimeFormat` æ—¥æœŸè½¬æ¢ï¼Œç”¨`String`å»æ¥æ”¶excelæ—¥æœŸæ ¼å¼çš„æ•°æ®ä¼šè°ƒç”¨è¿™ä¸ªæ³¨è§£ã€‚é‡Œé¢çš„`value`å‚ç…§`java.text.SimpleDateFormat`
- `NumberFormat` æ•°å­—è½¬æ¢ï¼Œç”¨`String`å»æ¥æ”¶excelæ•°å­—æ ¼å¼çš„æ•°æ®ä¼šè°ƒç”¨è¿™ä¸ªæ³¨è§£ã€‚é‡Œé¢çš„`value`å‚ç…§`java.text.DecimalFormat`
- `ExcelIgnoreUnannotated` é»˜è®¤ä¸åŠ `ExcelProperty` çš„æ³¨è§£çš„éƒ½ä¼šå‚ä¸è¯»å†™ï¼ŒåŠ äº†ä¸ä¼šå‚ä¸

### å‚æ•°

#### é€šç”¨å‚æ•°

`ReadWorkbook`,`ReadSheet` éƒ½ä¼šæœ‰çš„å‚æ•°ï¼Œå¦‚æœä¸ºç©ºï¼Œé»˜è®¤ä½¿ç”¨ä¸Šçº§ã€‚

- `converter` è½¬æ¢å™¨ï¼Œé»˜è®¤åŠ è½½äº†å¾ˆå¤šè½¬æ¢å™¨ã€‚ä¹Ÿå¯ä»¥è‡ªå®šä¹‰ã€‚
- `readListener` ç›‘å¬å™¨ï¼Œåœ¨è¯»å–æ•°æ®çš„è¿‡ç¨‹ä¸­ä¼šä¸æ–­çš„è°ƒç”¨ç›‘å¬å™¨ã€‚
- `headRowNumber` éœ€è¦è¯»çš„è¡¨æ ¼æœ‰å‡ è¡Œå¤´æ•°æ®ã€‚é»˜è®¤æœ‰ä¸€è¡Œå¤´ï¼Œä¹Ÿå°±æ˜¯è®¤ä¸ºç¬¬äºŒè¡Œå¼€å§‹èµ·ä¸ºæ•°æ®ã€‚
- `head`  ä¸`clazz`äºŒé€‰ä¸€ã€‚è¯»å–æ–‡ä»¶å¤´å¯¹åº”çš„åˆ—è¡¨ï¼Œä¼šæ ¹æ®åˆ—è¡¨åŒ¹é…æ•°æ®ï¼Œå»ºè®®ä½¿ç”¨classã€‚
- `clazz` ä¸`head`äºŒé€‰ä¸€ã€‚è¯»å–æ–‡ä»¶çš„å¤´å¯¹åº”çš„classï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æ³¨è§£ã€‚å¦‚æœä¸¤ä¸ªéƒ½ä¸æŒ‡å®šï¼Œåˆ™ä¼šè¯»å–å…¨éƒ¨æ•°æ®ã€‚
- `autoTrim` å­—ç¬¦ä¸²ã€è¡¨å¤´ç­‰æ•°æ®è‡ªåŠ¨trim
- `password` è¯»çš„æ—¶å€™æ˜¯å¦éœ€è¦ä½¿ç”¨å¯†ç 

#### ReadWorkbookï¼ˆç†è§£æˆexcelå¯¹è±¡ï¼‰å‚æ•°

- `excelType` å½“å‰excelçš„ç±»å‹ é»˜è®¤ä¼šè‡ªåŠ¨åˆ¤æ–­
- `inputStream` ä¸`file`äºŒé€‰ä¸€ã€‚è¯»å–æ–‡ä»¶çš„æµï¼Œå¦‚æœæ¥æ”¶åˆ°çš„æ˜¯æµå°±åªç”¨ï¼Œä¸ç”¨æµå»ºè®®ä½¿ç”¨`file`å‚æ•°ã€‚å› ä¸ºä½¿ç”¨äº†`inputStream` easyexcelä¼šå¸®å¿™åˆ›å»ºä¸´æ—¶æ–‡ä»¶ï¼Œæœ€ç»ˆè¿˜æ˜¯`file`
- `file` ä¸`inputStream`äºŒé€‰ä¸€ã€‚è¯»å–æ–‡ä»¶çš„æ–‡ä»¶ã€‚
- `autoCloseStream` è‡ªåŠ¨å…³é—­æµã€‚
- `readCache` é»˜è®¤å°äº5Mç”¨ å†…å­˜ï¼Œè¶…è¿‡5Mä¼šä½¿ç”¨ `EhCache`,è¿™é‡Œä¸å»ºè®®ä½¿ç”¨è¿™ä¸ªå‚æ•°ã€‚
- `useDefaultListener` `@since 2.1.4` é»˜è®¤ä¼šåŠ å…¥`ModelBuildEventListener` æ¥å¸®å¿™è½¬æ¢æˆä¼ å…¥`class`çš„å¯¹è±¡ï¼Œè®¾ç½®æˆ`false`åå°†ä¸ä¼šååŠ©è½¬æ¢å¯¹è±¡ï¼Œè‡ªå®šä¹‰çš„ç›‘å¬å™¨ä¼šæ¥æ”¶åˆ°`Map<Integer,CellData>`å¯¹è±¡ï¼Œå¦‚æœè¿˜æƒ³ç»§ç»­æ¥å¬åˆ°`class`å¯¹è±¡ï¼Œè¯·è°ƒç”¨`readListener`æ–¹æ³•ï¼ŒåŠ å…¥è‡ªå®šä¹‰çš„`beforeListener`ã€ `ModelBuildEventListener`ã€ è‡ªå®šä¹‰çš„`afterListener`å³å¯ã€‚

#### ReadSheetï¼ˆå°±æ˜¯excelçš„ä¸€ä¸ªSheetï¼‰å‚æ•°

- `sheetNo` éœ€è¦è¯»å–Sheetçš„ç¼–ç ï¼Œå»ºè®®ä½¿ç”¨è¿™ä¸ªæ¥æŒ‡å®šè¯»å–å“ªä¸ªSheet
- `sheetName` æ ¹æ®åå­—å»åŒ¹é…Sheet,excel 2003ä¸æ”¯æŒæ ¹æ®åå­—å»åŒ¹é…

## å†™åœ¨æœ€å

æœ¬æ–‡åªæ˜¯ç”¨åˆ°éƒ¨åˆ†åŠŸèƒ½ï¼Œç®€å•çš„åšäº†ä¸€ä¸‹æ€»ç»“ï¼Œæ›´å¤šçš„åŠŸèƒ½ï¼Œå¯ä»¥å»å®˜ç½‘æŸ¥é˜…ã€‚

å®˜æ–¹æ–‡æ¡£ï¼šhttps://www.yuque.com/easyexcel/doc/read

ä½¿ç”¨EasyExcelå¯¼å‡ºexcelï¼š