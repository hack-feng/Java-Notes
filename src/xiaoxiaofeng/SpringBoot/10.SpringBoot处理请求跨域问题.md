ä¸Šä¸€ç¯‡[9.SpirngBootç”¨æˆ·ç™»å½•æ‹¦æˆªå™¨]()åˆšåˆšè¯´è¿‡ä½¿ç”¨æ‹¦æˆªå™¨å¯¹ç”¨æˆ·ç™»å½•çŠ¶æ€è¿›è¡Œæ‹¦æˆªï¼Œæœ¬æ–‡å°±é¡ºä¾¿è¯´è¯´ä½¿ç”¨æ‹¦æˆªå™¨å¤„ç†è·¨åŸŸé—®é¢˜å§ã€‚

æˆ‘ä»¬æœ¬ç³»åˆ—åº”è¯¥ä¸ä¼šé‡åˆ°è·¨åŸŸé—®é¢˜ï¼Œä½†æ—¥å¸¸å·¥ä½œä¸­ï¼Œä¸€ä¸ªæ–°é¡¹ç›®å’Œå‰ç«¯å°ä¼™ä¼´è”è°ƒæ—¶è¿˜æ˜¯è¦å¤„ç†è·¨åŸŸé—®é¢˜çš„ï¼Œæœ¬æ–‡å°±ä¸€èµ·ç®€å•çš„çœ‹ä¸€ä¸‹ï¼Œä»¥åŽé‡åˆ°äº†è·¨åŸŸé—®é¢˜ä¹Ÿå¯ä»¥å¿«é€Ÿè§£å†³ã€‚

## ä»€ä¹ˆæ˜¯è·¨åŸŸ

CORSå…¨ç§°Cross-Origin Resource Sharingï¼Œæ„ä¸ºè·¨åŸŸèµ„æºå…±äº«ã€‚å½“ä¸€ä¸ªèµ„æºåŽ»è®¿é—®å¦ä¸€ä¸ªä¸åŒåŸŸåæˆ–è€…åŒåŸŸåä¸åŒç«¯å£çš„èµ„æºæ—¶ï¼Œå°±ä¼šå‘å‡ºè·¨åŸŸè¯·æ±‚ã€‚å¦‚æžœæ­¤æ—¶å¦ä¸€ä¸ªèµ„æºä¸å…è®¸å…¶è¿›è¡Œè·¨åŸŸèµ„æºè®¿é—®ï¼Œé‚£ä¹ˆè®¿é—®å°±ä¼šé‡åˆ°è·¨åŸŸé—®é¢˜ã€‚

è·¨åŸŸæŒ‡çš„æ˜¯ç”±äºŽæµè§ˆå™¨çš„å®‰å…¨æ€§é™åˆ¶ï¼Œä¸å…è®¸å‰ç«¯é¡µé¢è®¿é—®åè®®ä¸åŒã€åŸŸåä¸åŒã€ç«¯å£å·ä¸åŒçš„httpæŽ¥å£ï¼Œä¾‹å¦‚æˆ‘æœ¬åœ°åˆ›å»ºä¸€ä¸ªhtmlï¼Œé‡Œé¢å†™ä¸€ä¸ªajaxè¯·æ±‚è®¿é—®æˆ‘æœåŠ¡å™¨SpringBootåº”ç”¨æä¾›çš„æŽ¥å£ï¼š`192.168.1.11:8080/getUser`
åˆ™ä¼šå‡ºæŠ¥ `No 'Access-Control-Allow-Origin' header is present on the requested resource. `é”™è¯¯ã€‚

## SpringBootæ€Žä¹ˆè§£å†³è·¨åŸŸ

> åœ¨springbootä¸­å¯ä»¥é‡‡ç”¨å¤šç§æ–¹å¼è§£å†³è·¨åŸŸé—®é¢˜ï¼Œä¾‹å¦‚ï¼šå¯ä»¥åœ¨ç±»æˆ–æ–¹æ³•ä¸Šæ·»åŠ `@CrossOrigin` æ³¨è§£ã€‚è¿˜æœ‰ä¸€ç§å°±æ˜¯å…¨å±€é…ç½®ï¼Œå…¨å±€é…ç½®éœ€è¦æ·»åŠ è‡ªå®šä¹‰ç±»å®žçŽ° `WebMvcConfigurer` æŽ¥å£ï¼Œç„¶åŽå®žçŽ°æŽ¥å£ä¸­çš„ `addCorsMappings` æ–¹æ³•ã€‚

* addMappingï¼šè¡¨ç¤ºå¯¹å“ªç§æ ¼å¼çš„è¯·æ±‚è·¯å¾„è¿›è¡Œè·¨åŸŸå¤„ç†ã€‚
* allowedHeadersï¼šè¡¨ç¤ºå…è®¸çš„è¯·æ±‚å¤´ï¼Œé»˜è®¤å…è®¸æ‰€æœ‰çš„è¯·æ±‚å¤´ä¿¡æ¯ã€‚
* allowedMethodsï¼šè¡¨ç¤ºå…è®¸çš„è¯·æ±‚æ–¹æ³•ï¼Œé»˜è®¤æ˜¯ GETã€POST å’Œ HEADã€‚è¿™é‡Œé…ç½®ä¸º * è¡¨ç¤ºæ”¯æŒæ‰€æœ‰çš„è¯·æ±‚æ–¹æ³•ã€‚
* maxAgeï¼šè¡¨ç¤ºæŽ¢æµ‹è¯·æ±‚çš„æœ‰æ•ˆæœŸ
* allowedOrigins è¡¨ç¤ºæ”¯æŒçš„åŸŸ

è¯¦ç»†ä»£ç å¦‚ä¸‹ðŸ‘‡ðŸ‘‡

~~~java
package com.maple.demo.filter;

import org.springframework.core.annotation.Order;
import org.springframework.http.HttpHeaders;

import javax.servlet.*;
import javax.servlet.annotation.WebFilter;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;

/**
 * è·¨åŸŸæ‹¦æˆª.
 *
 * @author ç¬‘å°æž«
 * @date 2022-07-21 19:23:08
 * @since JDK 1.8
 */
@WebFilter(filterName = "corsFilter", urlPatterns = "/*")
@Order(0)
public class CorsFilter implements Filter {

    private static final String HEADER_ORIGIN = "Origin";
    private static final String METHOD_OPTIONS = "OPTIONS";

    @Override
    public void doFilter(ServletRequest req, ServletResponse res, FilterChain chain) throws IOException, ServletException {
        final HttpServletRequest request = (HttpServletRequest) req;
        final HttpServletResponse response = (HttpServletResponse) res;
        if (request.getHeader(HEADER_ORIGIN) != null) {
            response.setHeader(HttpHeaders.ACCESS_CONTROL_ALLOW_ORIGIN, request.getHeader(HEADER_ORIGIN));
        }

        response.setHeader(HttpHeaders.ACCESS_CONTROL_ALLOW_CREDENTIALS, "true");
        // å¦‚æžœå…è®¸æ‰€æœ‰è¯·æ±‚æ–¹å¼ï¼Œç”¨*
        response.setHeader(HttpHeaders.ACCESS_CONTROL_ALLOW_METHODS, "GET, POST, PUT, DELETE, OPTIONS");
        response.setHeader(HttpHeaders.ACCESS_CONTROL_MAX_AGE, "3600");
        // å¦‚æžœå…è®¸æ‰€æœ‰headerï¼Œç”¨*
        response.setHeader(HttpHeaders.ACCESS_CONTROL_ALLOW_HEADERS, "Authorization, Content-Type, Accept, X-Requested-With, remember-me");
        response.setHeader(HttpHeaders.ACCESS_CONTROL_EXPOSE_HEADERS, "Content-Disposition");

        if (METHOD_OPTIONS.equalsIgnoreCase(request.getMethod())) {
            response.setStatus(HttpServletResponse.SC_OK);
            return;
        }
        chain.doFilter(req, res);
    }
}
~~~

## å…³äºŽç¬‘å°æž«

> æœ¬ç« åˆ°è¿™é‡Œç»“æŸäº†ï¼Œå–œæ¬¢çš„æœ‹å‹å…³æ³¨ä¸€ä¸‹æˆ‘å‘¦ï¼Œå¤§ä¼™çš„æ”¯æŒï¼Œå°±æ˜¯æˆ‘åšæŒå†™ä¸‹åŽ»çš„åŠ¨åŠ›ã€‚
> è€è§„çŸ©ï¼Œæ‡‚äº†å°±ç‚¹èµžæ”¶è—ï¼›ä¸æ‡‚å°±é—®ï¼Œæ—¥å¸¸åœ¨çº¿ï¼Œæˆ‘ä¼šå°±ä¼šå›žå¤å“ˆ~
> åŽç»­æ–‡ç« ä¼šé™†ç»­æ›´æ–°ï¼Œæ–‡æ¡£ä¼šåŒæ­¥åœ¨å¾®ä¿¡å…¬ä¼—å·ã€ä¸ªäººåšå®¢ã€CSDNå’ŒGitHubä¿æŒåŒæ­¥æ›´æ–°ã€‚
> å¾®ä¿¡å…¬ä¼—å·ï¼šç¬‘å°æž«
> ç¬‘å°æž«ä¸ªäººåšå®¢ï¼š[https://www.xiaoxiaofeng.site](https://www.xiaoxiaofeng.site)
> CSDNï¼š[https://zhangfz.blog.csdn.net](https://zhangfz.blog.csdn.net)
> GitHubæ–‡æ¡£ï¼š[https://github.com/hack-feng/Java-Notes](https://github.com/hack-feng/Java-Notes) 
