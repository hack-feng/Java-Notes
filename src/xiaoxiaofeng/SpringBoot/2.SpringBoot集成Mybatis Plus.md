## 2. é›†æˆMybatis PlusğŸ‘‰ğŸ¼

### 2.1 é…ç½®åŸºç¡€ä¾èµ–âš™ï¸

é¦–å…ˆï¼Œé¡¹ç›®ä¸­ä¼šä½¿ç”¨åˆ°mysqlã€mybatis-plusã€druidæ•°æ®è¿æ¥æ± ç­‰ç­‰åŠŸèƒ½ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±ä¸€ä¸€è®²è§£ä¸€ä¸‹ã€‚

å®Œæ•´çš„pom.xmlæ–‡ä»¶å¦‚ä¸‹ï¼š

| ä¾èµ–åç§°                                  | ä¾èµ–æè¿°                                  | ç‰ˆæœ¬    |
| ----------------------------------------- | ----------------------------------------- | ------- |
| mysql-connector-java:mysql-connector-java | mysqlé©±åŠ¨                                 | 8.0.29  |
| com.alibaba:druid                         | é˜¿é‡Œå·´å·´Druidæ•°æ®åº“è¿æ¥æ±                  | 1.2.11  |
| com.baomidou:mybatis-plus-boot-starter    | mybatis-plusçš„ä¾èµ–                        | 3.5.2   |
| com.baomidou:mybatis-plus-generator       | mybatis-plusçš„è‡ªåŠ¨ç”Ÿæˆä»£ç æ’ä»¶            | 3.5.2   |
| org.apache.velocity:velocity-engine-core  | Java çš„æ¨¡æ¿å¼•æ“æ¡†æ¶ï¼Œç”¨äºä»£ç è‡ªåŠ¨ç”Ÿæˆ     | 2.3     |
| org.projectlombok:lombok                  | ä»£ç ç®€åŒ–ï¼Œgetter/setterã€æ„é€ å™¨ç¼–è¯‘æ—¶ç”Ÿæˆ | 1.18.24 |
| com.alibaba:fastjson                      | é˜¿é‡Œå·´å·´Jsonæ“ä½œå·¥å…·ç±»                    | 2.0.7   |

~~~xml
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
		 xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd">
	<modelVersion>4.0.0</modelVersion>
	<parent>
		<groupId>org.springframework.boot</groupId>
		<artifactId>spring-boot-starter-parent</artifactId>
		<version>2.3.12.RELEASE</version>
		<relativePath/> <!-- lookup parent from repository -->
	</parent>
	<groupId>com.maple</groupId>
	<artifactId>maple-demo</artifactId>
	<version>0.0.1-SNAPSHOT</version>
	<name>maple-demo</name>
	<description>Demo project for Spring Boot</description>

	<properties>
		<java-version>1.8</java-version>
		<lombok-version>1.18.24</lombok-version>
		<druid-version>1.2.11</druid-version>
		<mybatis-plus-version>3.5.2</mybatis-plus-version>
		<velocity-version>2.3</velocity-version>
		<fastjson-version>2.0.7</fastjson-version>
		<mysql-connector-version>8.0.29</mysql-connector-version>
	</properties>

	<dependencies>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter</artifactId>
		</dependency>

		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-test</artifactId>
			<scope>test</scope>
			<exclusions>
				<exclusion>
					<groupId>org.junit.vintage</groupId>
					<artifactId>junit-vintage-engine</artifactId>
				</exclusion>
			</exclusions>
		</dependency>

		<!-- å¼•å…¥webç›¸å…³ -->
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-web</artifactId>
		</dependency>

		<!--ä½¿ç”¨Mysqlæ•°æ®åº“-->
		<dependency>
			<groupId>mysql</groupId>
			<artifactId>mysql-connector-java</artifactId>
			<version>${mysql-connector-version}</version>
		</dependency>
		<!--ä½¿ç”¨é˜¿é‡Œå·´å·´druidæ•°æ®åº“è¿æ¥æ± -->
		<dependency>
			<groupId>com.alibaba</groupId>
			<artifactId>druid</artifactId>
			<version>${druid-version}</version>
		</dependency>

		<!-- mybatis-plusçš„ä¾èµ– -->
		<dependency>
			<groupId>com.baomidou</groupId>
			<artifactId>mybatis-plus-boot-starter</artifactId>
			<version>${mybatis-plus-version}</version>
		</dependency>
		<!-- mybatis-plusçš„è‡ªåŠ¨ç”Ÿæˆä»£ç æ’ä»¶ -->
		<dependency>
			<groupId>com.baomidou</groupId>
			<artifactId>mybatis-plus-generator</artifactId>
			<version>${mybatis-plus-version}</version>
		</dependency>
		<dependency>
			<groupId>org.apache.velocity</groupId>
			<artifactId>velocity-engine-core</artifactId>
			<version>${velocity-version}</version>
		</dependency>

		<!--Lombokç®¡ç†Getter/Setter/logç­‰-->
		<dependency>
			<groupId>org.projectlombok</groupId>
			<artifactId>lombok</artifactId>
			<scope>provided</scope>
			<version>${lombok-version}</version>
		</dependency>

		<!-- å¤„ç†JSON -->
		<dependency>
			<groupId>com.alibaba</groupId>
			<artifactId>fastjson</artifactId>
			<version>${fastjson-version}</version>
		</dependency>
	</dependencies>

	<build>
		<plugins>
			<plugin>
				<groupId>org.springframework.boot</groupId>
				<artifactId>spring-boot-maven-plugin</artifactId>
			</plugin>
		</plugins>
	</build>
</project>
~~~

#### 2.1.1 å¼•å…¥Mysqlé…ç½®

é¦–å…ˆæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªMysqlæ•°æ®åº“mapleï¼Œå­—ç¬¦é›†é€‰æ‹©utf8ã€‚è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨çš„å·¥å…·æ˜¯Navicat Premium 11ã€‚å½“ç„¶å…¶ä»–å·¥å…·éƒ½æ˜¯ä¸€æ ·ï¼Œæ²¡æœ‰ç‰¹ä½¿è¦æ±‚ã€‚

![image-20220710141353991](http://file.xiaoxiaofeng.site/blog/image/2022/07/10/20220710141354.png) 

åˆ›å»ºä¸€å¼ usc_userè¡¨ï¼Œå½“ç„¶æœ‰å¾ˆå¤šå­—æ®µæˆ‘ä»¬å¯èƒ½æš‚ä¸”ä¸éœ€è¦ï¼Œæš‚ä¸”ä¿ç•™ï¼š

~~~mysql
CREATE TABLE `usc_user` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT 'ç”¨æˆ·ID',
  `open_id` varchar(255) CHARACTER DEFAULT NULL COMMENT 'å°ç¨‹åºçš„openId',
  `dept_id` bigint(20) DEFAULT NULL COMMENT 'éƒ¨é—¨ID',
  `account` varchar(30) CHARACTER DEFAULT NULL COMMENT 'ç”¨æˆ·è´¦å·',
  `user_name` varchar(30) CHARACTER DEFAULT NULL COMMENT 'ç”¨æˆ·å§“å',
  `nick_name` varchar(30) CHARACTER DEFAULT NULL COMMENT 'ç”¨æˆ·æ˜µç§°',
  `user_type` varchar(2) CHARACTER DEFAULT '00' COMMENT 'ç”¨æˆ·ç±»å‹ï¼ˆ00ç³»ç»Ÿç”¨æˆ·,01å°ç¨‹åºç”¨æˆ·ï¼‰',
  `email` varchar(50) DEFAULT '' COMMENT 'ç”¨æˆ·é‚®ç®±',
  `phone` varchar(11) CHARACTER DEFAULT '' COMMENT 'æ‰‹æœºå·ç ',
  `sex` char(1) DEFAULT '0' COMMENT 'ç”¨æˆ·æ€§åˆ«ï¼ˆ0ç”· 1å¥³ 2æœªçŸ¥ï¼‰',
  `avatar` varchar(100) DEFAULT '' COMMENT 'å¤´åƒåœ°å€',
  `salt` varchar(32) CHARACTER DEFAULT NULL COMMENT 'ç”¨æˆ·åŠ å¯†ç›å€¼',
  `password` varchar(100) DEFAULT '' COMMENT 'å¯†ç ',
  `status` char(1) DEFAULT '0' COMMENT 'å¸å·çŠ¶æ€ï¼ˆ0æ­£å¸¸ 1åœç”¨ï¼‰',
  `login_ip` varchar(128) DEFAULT '' COMMENT 'æœ€åç™»å½•IP',
  `login_date` datetime DEFAULT NULL COMMENT 'æœ€åç™»å½•æ—¶é—´',
  `create_id` bigint(20) DEFAULT NULL COMMENT 'åˆ›å»ºäººid',
  `create_name` varchar(64) DEFAULT '' COMMENT 'åˆ›å»ºè€…',
  `create_time` datetime DEFAULT NULL COMMENT 'åˆ›å»ºæ—¶é—´',
  `update_id` bigint(20) DEFAULT NULL COMMENT 'ä¿®æ”¹äººid',
  `update_name` varchar(64) DEFAULT '' COMMENT 'æ›´æ–°è€…',
  `update_time` datetime DEFAULT NULL COMMENT 'æ›´æ–°æ—¶é—´',
  `is_deleted` tinyint(1) DEFAULT '0' COMMENT 'åˆ é™¤æ ‡å¿—',
  `remark` varchar(500) DEFAULT NULL COMMENT 'å¤‡æ³¨',
  PRIMARY KEY (`id`) USING BTREE,
  UNIQUE KEY `UNI_USER_NAME` (`user_name`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT='ç”¨æˆ·ä¸­å¿ƒ-ç”¨æˆ·ä¿¡æ¯è¡¨';
~~~

åˆ›å»ºå¥½æ•°æ®åº“åï¼Œé…ç½®æˆ‘ä»¬é¡¹ç›®çš„application.ymlæ–‡ä»¶

~~~yml
spring:
  application:
    name: maple-admin
  # é…ç½®æ•°æ®åº“è¿æ¥
  datasource:
    url: jdbc:mysql://127.0.0.1:3306/maple?useUnicode=yes&characterEncoding=UTF-8&useSSL=false&serverTimezone=UTC # æ•°æ®åº“è¿æ¥åœ°å€åŠå¸¸ç”¨é…ç½®
    driverClassName: com.mysql.cj.jdbc.Driver # æ•°æ®åº“è¿æ¥é©±åŠ¨
    username: root # æ•°æ®åº“ç”¨æˆ·
    password: 123456 # æ•°æ®åº“ç”¨æˆ·å¯†ç 
    # é…ç½®druidæ•°æ®åº“è¿æ¥æ± ---------------------------------------
    type: com.alibaba.druid.pool.DruidDataSource
    initialSize: 5        # åˆå§‹åŒ–å¤§å°ï¼Œæœ€å°ï¼Œæœ€å¤§
    minIdle: 5
    maxActive: 20
    maxWait: 60000        # é…ç½®è·å–è¿æ¥ç­‰å¾…è¶…æ—¶çš„æ—¶é—´
    timeBetweenEvictionRunsMillis: 60000  # é…ç½®é—´éš”å¤šä¹…æ‰è¿›è¡Œä¸€æ¬¡æ£€æµ‹ï¼Œæ£€æµ‹éœ€è¦å…³é—­çš„ç©ºé—²è¿æ¥ï¼Œå•ä½æ˜¯æ¯«ç§’
    minEvictableIdleTimeMillis: 300000    # é…ç½®ä¸€ä¸ªè¿æ¥åœ¨æ± ä¸­æœ€å°ç”Ÿå­˜çš„æ—¶é—´ï¼Œå•ä½æ˜¯æ¯«ç§’
    validationQuery: SELECT 'x'           # æ ¡éªŒSQLï¼ŒOracleé…ç½® spring.datasource.validationQuery=SELECT 1 FROM DUALï¼Œå¦‚æœä¸é…validationQueryé¡¹ï¼Œåˆ™ä¸‹é¢ä¸‰é¡¹é…ç½®æ— ç”¨
    testWhileIdle: true
    testOnBorrow: false 
    testOnReturn: false
    poolPreparedStatements: true   # æ‰“å¼€PSCacheï¼Œå¹¶ä¸”æŒ‡å®šæ¯ä¸ªè¿æ¥ä¸ŠPSCacheçš„å¤§å°
    maxPoolPreparedStatementPerConnectionSize: 20
    filters: stat,wall,log4j       # é…ç½®ç›‘æ§ç»Ÿè®¡æ‹¦æˆªçš„filtersï¼Œå»æ‰åç›‘æ§ç•Œé¢sqlæ— æ³•ç»Ÿè®¡ï¼Œ'wall'ç”¨äºé˜²ç«å¢™
    #connectionProperties: druid.stat.mergeSql=true;druid.stat.slowSqlMillis=5000  # é€šè¿‡connectPropertieså±æ€§æ¥æ‰“å¼€mergeSqlåŠŸèƒ½ï¼›æ…¢SQLè®°å½•
    useGlobalDataSourceStat: true  # åˆå¹¶å¤šä¸ªDruidDataSourceçš„ç›‘æ§æ•°æ®
~~~

è‡³æ­¤ï¼Œæˆ‘ä»¬çš„æ•°æ®åº“é…ç½®å·²ç»å®Œæˆã€‚æ¥ä¸‹æ¥æˆ‘ä»¬é…ç½®ä¸€ä¸‹Mybatis-plusã€‚

#### 2.1.2 å¼•å…¥MyBatis-Plusé…ç½®

##### é…ç½®MyBatis-Plus

* MyBatis æ˜¯ä¸€æ¬¾ä¼˜ç§€çš„æŒä¹…å±‚æ¡†æ¶ï¼Œå®ƒæ”¯æŒè‡ªå®šä¹‰ SQLã€å­˜å‚¨è¿‡ç¨‹ä»¥åŠé«˜çº§æ˜ å°„ã€‚MyBatis å…é™¤äº†å‡ ä¹æ‰€æœ‰çš„ JDBC ä»£ç ä»¥åŠè®¾ç½®å‚æ•°å’Œè·å–ç»“æœé›†çš„å·¥ä½œã€‚MyBatis å¯ä»¥é€šè¿‡ç®€å•çš„ XML æˆ–æ³¨è§£æ¥é…ç½®å’Œæ˜ å°„åŸå§‹ç±»å‹ã€æ¥å£å’Œ Java POJOï¼ˆPlain Old Java Objectsï¼Œæ™®é€šè€å¼ Java å¯¹è±¡ï¼‰ä¸ºæ•°æ®åº“ä¸­çš„è®°å½•ã€‚
* MyBatis-Plusæ˜¯åŸºäºMyBatisæ¡†æ¶è¿›ä¸€æ­¥çš„å°è£…ï¼Œå¢å¼ºäº†MyBatisçš„åŠŸèƒ½ï¼Œåªéœ€ç®€å•é…ç½®ï¼Œå³å¯å¿«é€Ÿè¿›è¡Œå•è¡¨ CRUD æ“ä½œï¼Œä»è€ŒèŠ‚çœå¤§é‡æ—¶é—´ï¼Œä»¥åŠä¸€äº›å¸¸ç”¨å·¥å…·çš„å°è£…ã€‚

* MyBatisä¸­æ–‡æ–‡æ¡£åœ°å€ï¼šhttps://mybatis.org/mybatis-3/zh/index.html
* MyBatis-Pluså®˜æ–¹åœ°å€ï¼šhttps://baomidou.com/

æ¥ä¸‹æ¥æˆ‘ä»¬å°±ä¸€èµ·é…ç½®ä¸€ä¸‹MyBatis-Plusï¼š

> è¿™é‡Œæˆ‘ä»¬ä¼šä½¿ç”¨Mybatis-plusç”Ÿæˆä»£ç ã€åˆ†é¡µã€é€»è¾‘åˆ é™¤ã€å¸¸ç”¨å­—æ®µè‡ªåŠ¨æ³¨å…¥æ•°æ®ç­‰æ’ä»¶ã€‚

é¦–å…ˆæ˜¯application.yml

~~~yml
# é…ç½®mybatis-plusçš„xmlå’Œbeançš„ç›®å½•
mybatis-plus:
  mapper-locations: classpath:mapper/*.xml
  configuration:
    map-underscore-to-camel-case: true    # å¼€å¯é©¼å³°åŠŸèƒ½
    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl    # æ—¥å¿—æ‰“å°åŠŸèƒ½
  global-config:  #é€»è¾‘åˆ é™¤é…ç½®
    db-config:
      logic-delete-value: 1 # é€»è¾‘å·²åˆ é™¤å€¼(é»˜è®¤ä¸º 1)
      logic-not-delete-value: 0 # é€»è¾‘æœªåˆ é™¤å€¼(é»˜è®¤ä¸º 0)
~~~

ç„¶åæˆ‘ä»¬åœ¨com.maple.demoä¸‹åˆ›å»ºconfigç›®å½•å­˜æ”¾æˆ‘ä»¬çš„ç³»ç»Ÿé…ç½®ï¼Œåœ¨configç›®å½•åˆ›å»ºMybatisPlusConfig.javaæ–‡ä»¶

è¿™é‡Œé…ç½®ä¸‹Mybaitsçš„è‡ªåŠ¨å¡«å……æœºåˆ¶å’Œdruidç›‘æ§é¡µé¢

~~~java
package com.maple.demo.config;

import com.alibaba.druid.support.http.StatViewServlet;
import com.baomidou.mybatisplus.core.handlers.MetaObjectHandler;
import org.apache.ibatis.reflection.MetaObject;
import org.mybatis.spring.annotation.MapperScan;
import org.springframework.boot.web.servlet.ServletRegistrationBean;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.transaction.annotation.EnableTransactionManagement;

import javax.servlet.Servlet;
import java.util.Date;

/**
 * Mybatis plusé…ç½®
 *
 * @author ç¬‘å°æ«
 * @date 2022/7/10
 */
@EnableTransactionManagement
@Configuration
@MapperScan("com.maple.demo.mapper")
public class MybatisPlusConfig implements MetaObjectHandler {

    /**
     * æ–°å¢æ—¶,è‡ªåŠ¨å¡«å……æ•°æ®
     */
    @Override
    public void insertFill(MetaObject metaObject) {
        this.setFieldValByName("isDeleted", false, metaObject);
        this.setFieldValByName("createId", 1L, metaObject);
        this.setFieldValByName("createName", "å ä½ç¬¦", metaObject);
        this.setFieldValByName("createTime", new Date(), metaObject);
        this.setFieldValByName("updateId", 1L, metaObject);
        this.setFieldValByName("updateName", "å ä½ç¬¦", metaObject);
        this.setFieldValByName("updateTime", new Date(), metaObject);
    }

    /**
     * ä¿®æ”¹æ—¶ï¼Œè‡ªåŠ¨å¡«å……æ•°æ®
     */
    @Override
    public void updateFill(MetaObject metaObject) {
        this.setFieldValByName("updateId", 1L, metaObject);
        this.setFieldValByName("updateName", "å ä½ç¬¦", metaObject);
        this.setFieldValByName("updateTime", new Date(), metaObject);
    }

    /**
     * é…ç½®druidç›‘æ§æœåŠ¡å™¨
     *
     * @return è¿”å›ç›‘æ§æ³¨å†Œçš„servletå¯¹è±¡
     */
    @Bean
    public ServletRegistrationBean<Servlet> statViewServlet() {
        ServletRegistrationBean<Servlet> servletRegistrationBean = new ServletRegistrationBean<>(new StatViewServlet(), "/druid/*");
        // æ·»åŠ IPç™½åå•ï¼Œå¦‚æœä¸éœ€è¦é»‘åå•ã€ç™½åå•çš„åŠŸèƒ½ï¼Œæ³¨é‡Šæ‰å³å¯
        servletRegistrationBean.addInitParameter("allow", "192.168.25.125,127.0.0.1");
        // æ·»åŠ IPé»‘åå•ï¼Œå½“ç™½åå•å’Œé»‘åå•é‡å¤æ—¶ï¼Œé»‘åå•ä¼˜å…ˆçº§æ›´é«˜
        servletRegistrationBean.addInitParameter("deny", "192.168.25.123");
        // æ·»åŠ æ§åˆ¶å°ç®¡ç†ç”¨æˆ·
        servletRegistrationBean.addInitParameter("loginUsername", "druid");
        servletRegistrationBean.addInitParameter("loginPassword", "123456");
        // æ˜¯å¦èƒ½å¤Ÿé‡ç½®æ•°æ®
        servletRegistrationBean.addInitParameter("resetEnable", "false");
        return servletRegistrationBean;
    }
}
~~~

å…¶ä¸­ï¼ŒcreateIdã€createNameæš‚æ—¶ä½¿ç”¨å ä½ç¬¦ï¼ŒåæœŸç»“åˆç™»å½•åä»JWTé‡Œé¢è·å–ã€‚

##### é…ç½®è‡ªåŠ¨ç”Ÿæˆä»£ç æ’ä»¶

é…ç½®MyBatis-Plusä»£ç ç”Ÿæˆå·¥å…·ï¼Œåœ¨com.maple.demoç›®å½•ä¸‹åˆ›å»ºutilç›®å½•ï¼Œç”¨äºå­˜æ”¾å·¥å…·ç±»ã€‚ç„¶ååˆ›å»ºGenerator.javaï¼Œä»£ç å¦‚ä¸‹

~~~java
package com.maple.demo.util;

import com.baomidou.mybatisplus.annotation.DbType;
import com.baomidou.mybatisplus.annotation.FieldFill;
import com.baomidou.mybatisplus.generator.AutoGenerator;
import com.baomidou.mybatisplus.generator.config.*;
import com.baomidou.mybatisplus.generator.config.converts.MySqlTypeConvert;
import com.baomidou.mybatisplus.generator.config.po.TableFill;
import com.baomidou.mybatisplus.generator.config.rules.DbColumnType;
import com.baomidou.mybatisplus.generator.config.rules.NamingStrategy;
import java.util.ArrayList;
import java.util.List;

/**
 * MyBatis-Plusä»£ç ç”Ÿæˆå·¥å…·
 * @author ç¬‘å°æ«
 * @date 2019/4/25
 */
public class Generator {

    public static void main(String[] args) {

        String auth = "Maple";
        String packageName = "com.maple.demo";
        String path = "D:";
        String url = "127.0.0.1:3306/maple";
        String username = "root";
        String password = "123456";
        generateTest(auth, packageName, path, url, username, password);
    }

    private static void generateTest(String auth, String packageName, String path,
                                     String url, String username, String password) {
        //å…¨å±€é…ç½®
        GlobalConfig config = new GlobalConfig();
        //è®¾ç½®æ˜¯å¦æ”¯æŒARæ¨¡å¼
        config.setActiveRecord(true)
                //è®¾ç½®ç”Ÿæˆä»£ç çš„ä½œè€…
                .setAuthor(auth)
                //è®¾ç½®è¾“å‡ºä»£ç çš„ä½ç½®
                .setOutputDir(path)
                // XML äºŒçº§ç¼“å­˜
                .setEnableCache(false)
                // XML ResultMap
                .setBaseResultMap(true)
                // XML columList
                .setBaseColumnList(true)
                //.setKotlin(true) æ˜¯å¦ç”Ÿæˆ kotlin ä»£ç 
                // æ˜¯å¦ä½¿ç”¨Swagger2
                .setSwagger2(true)
                // è®¾ç½®æ˜¯å¦è¦†ç›–åŸæ¥çš„ä»£ç 
                .setFileOverride(false);

        //******************************æ•°æ®æºé…ç½®***************************************
        //æ•°æ®åº“è¿æ¥url
        String dbUrl = "jdbc:mysql://" + url + "?useUnicode=true&characterEncoding=UTF-8&useJDBCCompliantTimezoneShift=true&useLegacyDatetimeCode=false&serverTimezone=UTC";
        //æ•°æ®æºé…ç½®
        DataSourceConfig dataSourceConfig = new DataSourceConfig();
        //æ•°æ®åº“ç±»å‹ æšä¸¾
        dataSourceConfig.setDbType(DbType.MYSQL)
                //è®¾ç½®url
                .setUrl(dbUrl)
                //è®¾ç½®ç”¨æˆ·å
                .setUsername(username)
                //è®¾ç½®å¯†ç 
                .setPassword(password)
                //è®¾ç½®æ•°æ®åº“é©±åŠ¨
                .setDriverName("com.mysql.cj.jdbc.Driver")
                // è‡ªå®šä¹‰æ•°æ®åº“è¡¨å­—æ®µç±»å‹è½¬æ¢ã€å¯é€‰ã€‘
                .setTypeConvert(new MySqlTypeConvert() {
                    @Override
                    public DbColumnType processTypeConvert(GlobalConfig globalConfig, String fieldType) {
                        System.out.println("è½¬æ¢ç±»å‹ï¼š" + fieldType);
                        //å°†æ•°æ®åº“ä¸­datetimeè½¬æ¢æˆdate
                        String datetime = "datetime";
                        if (fieldType.toLowerCase().contains(datetime)) {
                            return DbColumnType.DATE;
                        }
                        return (DbColumnType) super.processTypeConvert(globalConfig, fieldType);
                    }
                });

        //******************************ç­–ç•¥é…ç½®******************************************************
        // è‡ªå®šä¹‰éœ€è¦å¡«å……çš„å­—æ®µ æ•°æ®åº“ä¸­çš„å­—æ®µ
        List<TableFill> tableFillList = new ArrayList<>();
        tableFillList.add(new TableFill("update_id", FieldFill.INSERT_UPDATE));
        tableFillList.add(new TableFill("update_name", FieldFill.INSERT_UPDATE));
        tableFillList.add(new TableFill("update_time", FieldFill.INSERT_UPDATE));
        tableFillList.add(new TableFill("create_id", FieldFill.INSERT));
        tableFillList.add(new TableFill("create_name", FieldFill.INSERT));
        tableFillList.add(new TableFill("create_time", FieldFill.INSERT));
        tableFillList.add(new TableFill("is_deleted", FieldFill.INSERT));
        //ç­–ç•¥é…ç½®
        StrategyConfig strategyConfig = new StrategyConfig();
        strategyConfig
                //å…¨å±€å¤§å†™å‘½åæ˜¯å¦å¼€å¯
                .setCapitalMode(true)
                //ã€å®ä½“ã€‘æ˜¯å¦ä¸ºlombokæ¨¡å‹
                .setEntityLombokModel(true)
                //è¡¨åç”Ÿæˆç­–ç•¥  ä¸‹åˆ’çº¿è½¬é©¼å³°
                .setNaming(NamingStrategy.underline_to_camel)
                //ç”Ÿæˆçš„å»æ‰å‰ç¼€ï¼Œå¯ä»¥é…ç½®å¤šä¸ª
                .setTablePrefix("sys_","usc_","ld_","web_")
                //è‡ªåŠ¨å¡«å……è®¾ç½®
                .setTableFillList(tableFillList)
                //é€»è¾‘åˆ é™¤å­—æ®µé…ç½®
                .setLogicDeleteFieldName("is_deleted")
                .setRestControllerStyle(true)
                //ä¿®æ”¹æ›¿æ¢æˆä½ éœ€è¦çš„è¡¨åï¼Œå¤šä¸ªè¡¨åä¼ æ•°ç»„
                .setInclude(".*.");
        //é›†æˆæ³¨å…¥è®¾ç½®
        //æ³¨å…¥å…¨å±€è®¾ç½®
        new AutoGenerator().setGlobalConfig(config)
                //æ³¨å…¥æ•°æ®æºé…ç½®
                .setDataSource(dataSourceConfig)
                //æ³¨å…¥ç­–ç•¥é…ç½®
                .setStrategy(strategyConfig)
                //è®¾ç½®åŒ…åä¿¡æ¯
                .setPackageInfo(
                        new PackageConfig()
                                //æå–å…¬å…±çˆ¶çº§åŒ…å
                                .setParent(packageName)
                                //è®¾ç½®controllerä¿¡æ¯
                                .setController("controller")
                                //è®¾ç½®å®ä½“ç±»ä¿¡æ¯
                                .setEntity("bean")
                                .setMapper("mapper")
                                .setXml("mapper")
                )
                //è®¾ç½®è‡ªå®šä¹‰æ¨¡æ¿
                .setTemplate(
                        new TemplateConfig()
                                //.setXml(null)//æŒ‡å®šè‡ªå®šä¹‰æ¨¡æ¿è·¯å¾„, ä½ç½®ï¼š/resources/templates/entity2.java.ftl(æˆ–è€…æ˜¯.vm)
                                //æ³¨æ„ä¸è¦å¸¦ä¸Š.ftl(æˆ–è€…æ˜¯.vm), ä¼šæ ¹æ®ä½¿ç”¨çš„æ¨¡æ¿å¼•æ“è‡ªåŠ¨è¯†åˆ«
                                // è‡ªå®šä¹‰æ¨¡æ¿é…ç½®ï¼Œæ¨¡æ¿å¯ä»¥å‚è€ƒæºç  /mybatis-plus/src/main/resources/template ä½¿ç”¨ copy
                                // è‡³æ‚¨é¡¹ç›® src/main/resources/template ç›®å½•ä¸‹ï¼Œæ¨¡æ¿åç§°ä¹Ÿå¯è‡ªå®šä¹‰å¦‚ä¸‹é…ç½®ï¼š
                                // .setController("...");
                                // .setEntity("...");
                                // .setMapper("...");
                                // .setXml("...");
                                // .setService("...");
                                .setServiceImpl("templates/serviceImpl.java")
                )
                //å¼€å§‹æ‰§è¡Œä»£ç ç”Ÿæˆ
                .execute();
    }
}
~~~

é…ç½®å®Œä¹‹åï¼Œæˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹å¯¹åº”çš„é…ç½®æ–‡ä»¶
![image-20220710142855442](http://file.xiaoxiaofeng.site/blog/image/2022/07/10/20220710142855.png)

ç„¶ååœ¨è¯¥æ–‡ä»¶ä¸Šå³é”®ï¼Œæ‰§è¡Œè¯¥Mainæ–¹æ³•

![image-20220710142736663](http://file.xiaoxiaofeng.site/blog/image/2022/07/10/20220710142736.png)

 ç„¶åä¼šç”Ÿæˆåœ¨D:ä¸‹çš„comæ–‡ä»¶å¤¹ä¸‹ï¼Œæˆ‘ä»¬å°†ä»£ç å¤åˆ¶åˆ°æˆ‘ä»¬çš„é¡¹ç›®ä¸­ï¼Œæ­¤æ—¶çš„é¡¹ç›®ä»£ç ç»“æ„å¦‚ä¸‹å¦‚ï¼š
![image-20220710142756907](http://file.xiaoxiaofeng.site/blog/image/2022/07/10/20220710142757.png)