## åŠŸèƒ½èƒŒæ™¯

ç®€å•çš„è¯´ä¸‹è¿™ä¸ªåŠŸèƒ½çš„èƒŒæ™¯éœ€æ±‚å§ï¼Œæœ‰ç±»ä¼¼éœ€æ±‚çš„å¯ä»¥å¤ç”¨ï¼Œæœç„¶å¯¼å…¥è¿˜æ²¡å†™å®Œï¼Œå¯¼å‡ºçš„åŠŸèƒ½æ¥è¸µè€Œæ¥ï¼Œä¸€å—å†™äº†å§

* å®ç°excelå¯¼å‡ºï¼ˆä¾æ—§åºŸè¯...ï¼‰
* å¤šä¸ªsheeté¡µä¸€èµ·å¯¼å‡º
* ç¬¬ä¸€ä¸ªsheeté¡µæ•°æ®è¡¨å¤´ä¿¡æ¯æœ‰ä¸¤è¡Œ
* æ ·å¼ç¨å¾®ç¾è§‚ï¼Œåˆ—å®½å¯ä»¥è‡ªå®šä¹‰ç­‰
* æ•°æ®é‡ç¨å¾®æœ‰äº›å¤§ï¼ˆå¤šä¸ªsheeté¡µæ€»é‡50wå·¦å³ï¼‰

## é¡¹ç›®å¼•å…¥ä¾èµ–

å¦‚æœæ˜¯ä»ä¸Šä¸€ç¯‡çœ‹è¿‡æ¥çš„ï¼Œå°±ä¸ç”¨çœ‹é¡¹ç›®å¼•å…¥äº†ğŸ™ˆ

gradle:

~~~
compile "com.alibaba:easyexcel:3.1.0"
~~~

maven:

~~~
<dependency>
    <groupId>com.alibaba</groupId>
    <artifactId>easyexcel</artifactId>
    <version>3.1.0</version>
</dependency>
~~~

æ³¨æ„ï¼š 3+ç‰ˆæœ¬çš„çš„easyexcelï¼Œä½¿ç”¨poi 5+ç‰ˆæœ¬æ—¶ï¼Œéœ€è¦æ‰‹åŠ¨æ’é™¤ï¼špoi-ooxml-schemasï¼Œä¾‹å¦‚ï¼š

~~~
<dependency>
    <groupId>com.alibaba</groupId>
    <artifactId>easyexcel</artifactId>
    <version>3.1.0</version>
    <exclusions>
        <exclusion>
            <artifactId>poi-ooxml-schemas</artifactId>
            <groupId>org.apache.poi</groupId>
        </exclusion>
    </exclusions>
</dependency>
~~~

## é¡¹ç›®ç¼–ç 

å¦‚å¤šä¸ªè¡¨æ ¼æ ·å¼ç›¸åŒï¼Œå¯ç¼–å†™ä¸€ä¸ªçˆ¶ç±»ï¼Œå°†æ ·å¼å®šä¹‰åœ¨çˆ¶ç±»ä¸Šï¼Œå­ç±»ç»§æ‰¿çˆ¶ç±»å³å¯ã€‚

* åœ¨`config.bean.excel`åŒ…ä¸‹å®šä¹‰ç»é”€å•†ä¿¡æ¯å¯¹è±¡`ExportCompany.java`ï¼Œä»£ç å¦‚ä¸‹ğŸ‘‡

~~~java
package com.maple.demo.config.bean.excel;

import com.alibaba.excel.annotation.ExcelProperty;
import com.alibaba.excel.annotation.write.style.ColumnWidth;
import com.alibaba.excel.annotation.write.style.ContentFontStyle;
import com.alibaba.excel.annotation.write.style.HeadFontStyle;
import com.alibaba.excel.annotation.write.style.HeadStyle;
import com.alibaba.excel.enums.poi.FillPatternTypeEnum;
import lombok.AllArgsConstructor;
import lombok.Builder;
import lombok.Data;
import lombok.NoArgsConstructor;

import java.util.Date;

/**
 * @author ç¬‘å°æ«
 * @date 2022/7/22
 */
@Data
@Builder
@NoArgsConstructor
@AllArgsConstructor
@HeadStyle(fillPatternType = FillPatternTypeEnum.SOLID_FOREGROUND, fillForegroundColor = 40)
@HeadFontStyle(fontHeightInPoints = 12)
@ContentFontStyle(fontHeightInPoints = 11)
@ColumnWidth(20)
public class ExportCompany {

    // -------------------- åŸºæœ¬ä¿¡æ¯ start -------------

    @ExcelProperty({"åŸºæœ¬ä¿¡æ¯", "å…¬å¸åç§°"})
    private String companyName;

    @ExcelProperty({"åŸºæœ¬ä¿¡æ¯", "çœä»½"})
    private String province;

    @ExcelProperty({"åŸºæœ¬ä¿¡æ¯", "æˆç«‹æ—¶é—´"})
    private Date startDate;

    @ExcelProperty({"åŸºæœ¬ä¿¡æ¯", "ä¼ä¸šçŠ¶æ€"})
    private String entStatus;

    @ColumnWidth(30)
    @ExcelProperty({"åŸºæœ¬ä¿¡æ¯", "åšå®¢åœ°å€"})
    private String csdnAddress;

    // ---------------- åŸºæœ¬ä¿¡æ¯ end ---------------------

    // ---------------- ç»è¥ä¿¡æ¯ start ---------------------

    @ExcelProperty({"ç»è¥ä¿¡æ¯", "å‘˜å·¥æ•°"})
    private String employeeMaxCount;

    @ExcelProperty({"ç»è¥ä¿¡æ¯", "ç½‘ç«™åœ°å€"})
    private String netAddress;

    @ExcelProperty({"ç»è¥ä¿¡æ¯", "æ‰€å±åŒºåŸŸçœ"})
    private String businessProvinceName;

    @ExcelProperty({"ç»è¥ä¿¡æ¯", "æ‰€å±åŒºåŸŸå¸‚"})
    private String businessCityName;

    @ExcelProperty({"ç»è¥ä¿¡æ¯", "æ‰€å±åŒºåŸŸåŒºå¿"})
    private String businessAreaName;

    // ---------------- ç»è¥ä¿¡æ¯ end ---------------------
}
~~~

* åœ¨`config.bean.excel`åŒ…ä¸‹å®šä¹‰è”ç³»äººä¿¡æ¯å¯¹è±¡`ExportContact.java`ï¼Œä»£ç å¦‚ä¸‹ğŸ‘‡

~~~java
package com.maple.demo.config.bean.excel;

import com.alibaba.excel.annotation.ExcelProperty;
import com.alibaba.excel.annotation.write.style.ColumnWidth;
import com.alibaba.excel.annotation.write.style.ContentFontStyle;
import com.alibaba.excel.annotation.write.style.HeadFontStyle;
import com.alibaba.excel.annotation.write.style.HeadStyle;
import com.alibaba.excel.enums.poi.FillPatternTypeEnum;
import lombok.AllArgsConstructor;
import lombok.Builder;
import lombok.Data;
import lombok.NoArgsConstructor;

/**
 * @author ç¬‘å°æ«
 * @date 2022/7/22
 */
@Data
@Builder
@NoArgsConstructor
@AllArgsConstructor
@HeadStyle(fillPatternType = FillPatternTypeEnum.SOLID_FOREGROUND, fillForegroundColor = 40)
@HeadFontStyle(fontHeightInPoints = 12)
@ContentFontStyle(fontHeightInPoints = 11)
@ColumnWidth(20)
public class ExportContact {

    @ExcelProperty("å…¬å¸åç§°")
    private String companyName;

    @ExcelProperty("å§“å")
    private String name;

    @ExcelProperty("èº«ä»½è¯å·ç ")
    private String idCard;

    @ExcelProperty("ç”µè¯å·ç ")
    private String mobile;

    @ExcelProperty("èŒä½")
    private String contactPostName;
}
~~~

* åœ¨`controller`åŒ…ä¸‹ç¼–å†™`TestExportExcelController.java`è¿›è¡Œæµ‹è¯•ï¼Œä»£ç å¦‚ä¸‹ï¼š

~~~java
package com.maple.demo.controller;

import com.alibaba.excel.EasyExcelFactory;
import com.alibaba.excel.ExcelWriter;
import com.alibaba.excel.write.metadata.WriteSheet;
import com.maple.demo.config.bean.excel.ExportCompany;
import com.maple.demo.config.bean.excel.ExportContact;
import io.swagger.annotations.Api;
import lombok.extern.slf4j.Slf4j;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

import javax.servlet.http.HttpServletResponse;
import java.io.OutputStream;
import java.net.URLEncoder;
import java.util.ArrayList;
import java.util.Date;
import java.util.List;

/**
 * @author ç¬‘å°æ«
 * @date 2022/7/22
 */
@Slf4j
@RestController
@RequestMapping("/example")
@Api(tags = "å®ä¾‹æ¼”ç¤º-å¯¼å‡ºExcel")
public class TestExportExcelController {


    @GetMapping("/exportExcel")
    public void exportExcel(HttpServletResponse response) {
        try (OutputStream out = response.getOutputStream()) {
            response.setContentType("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet");
            response.setCharacterEncoding("utf-8");
            String fileName = URLEncoder.encode("ç¬‘å°æ«æµ‹è¯•å¯¼å‡º", "UTF-8").replaceAll("\\+", "%20");
            response.setHeader("Content-disposition", "attachment;filename*=utf-8''" + fileName + ".xlsx");
            handleExcel(out);
            out.flush();
        } catch (Exception e) {
            log.error(e.getMessage());
        }
    }

    private void handleExcel(OutputStream out) {
        try (ExcelWriter excelWriter = EasyExcelFactory.write(out).build()) {
            WriteSheet dealerSheet = EasyExcelFactory.writerSheet(0, "ç»é”€å•†ä¿¡æ¯").head(ExportCompany.class).build();
            WriteSheet contactSheet = EasyExcelFactory.writerSheet(1, "è”ç³»äºº").head(ExportContact.class).build();
            excelWriter.write(getCompany(), dealerSheet);
            excelWriter.write(getContact(), contactSheet);
        }
    }

    private List<ExportCompany> getCompany() {
        List<ExportCompany> companyList = new ArrayList<>();
        for (int i = 0; i < 5; i++) {
            companyList.add(ExportCompany.builder()
                    .companyName("ç¬‘å°æ«å…¬å¸" + i)
                    .province("ä¸Šæµ·å¸‚")
                    .businessProvinceName("å±±ä¸œçœ")
                    .businessCityName("ä¸´æ²‚å¸‚")
                    .businessAreaName("æ²³ä¸œåŒº")
                    .entStatus("è¥ä¸š")
                    .netAddress("www.xiaoxiaofeng.site")
                    .csdnAddress("https://zhangfz.blog.csdn.net")
                    .employeeMaxCount("100")
                    .startDate(new Date())
                    .build());
        }
        return companyList;
    }

    private List<ExportContact> getContact() {
        List<ExportContact> contactList = new ArrayList<>();
        for (int i = 0; i < 5; i++) {
            contactList.add(ExportContact.builder()
                    .companyName("ç¬‘å°æ«å…¬å¸" + i)
                    .name("ç¬‘å°æ«" + i)
                    .mobile("183000000000")
                    .idCard("371324199011111111")
                    .contactPostName("åç«¯")
                    .build());
        }
        return contactList;
    }
}
~~~

## æµ‹è¯•ç»“æœ

æµè§ˆå™¨è¯·æ±‚ï¼šhttp://localhost:8080/example/exportExcel

ç»é”€å•†sheeté¡µä¿¡æ¯ï¼š

![image-20220610102736604](http://file.xiaoxiaofeng.site/blog/image/image-20220610102736604.png)

è”ç³»äººsheeté¡µä¿¡æ¯ï¼š

![image-20220610102750478](http://file.xiaoxiaofeng.site/blog/image/image-20220610102750478.png)



## ç›¸å…³å±æ€§è§£è¯»

![image-20220610104915216](http://file.xiaoxiaofeng.site/blog/image/image-20220610104915216.png)

### æ³¨è§£

- `ExcelProperty` index æŒ‡å®šå†™åˆ°ç¬¬å‡ åˆ—ï¼Œé»˜è®¤æ ¹æ®æˆå‘˜å˜é‡æ’åºã€‚`value`æŒ‡å®šå†™å…¥çš„åç§°ï¼Œé»˜è®¤æˆå‘˜å˜é‡çš„åå­—ï¼Œå¤šä¸ª`value`å¯ä»¥å‚ç…§å¿«é€Ÿå¼€å§‹ä¸­çš„å¤æ‚å¤´
- `ExcelIgnore` é»˜è®¤æ‰€æœ‰å­—æ®µéƒ½ä¼šå†™å…¥excelï¼Œè¿™ä¸ªæ³¨è§£ä¼šå¿½ç•¥è¿™ä¸ªå­—æ®µ
- `DateTimeFormat` æ—¥æœŸè½¬æ¢ï¼Œå°†`Date`å†™åˆ°excelä¼šè°ƒç”¨è¿™ä¸ªæ³¨è§£ã€‚é‡Œé¢çš„`value`å‚ç…§`java.text.SimpleDateFormat`
- `NumberFormat` æ•°å­—è½¬æ¢ï¼Œç”¨`Number`å†™excelä¼šè°ƒç”¨è¿™ä¸ªæ³¨è§£ã€‚é‡Œé¢çš„`value`å‚ç…§`java.text.DecimalFormat`
- `ExcelIgnoreUnannotated` é»˜è®¤ä¸åŠ `ExcelProperty` çš„æ³¨è§£çš„éƒ½ä¼šå‚ä¸è¯»å†™ï¼ŒåŠ äº†ä¸ä¼šå‚ä¸

### å‚æ•°

#### é€šç”¨å‚æ•°

`WriteWorkbook`,`WriteSheet` ,`WriteTable`éƒ½ä¼šæœ‰çš„å‚æ•°ï¼Œå¦‚æœä¸ºç©ºï¼Œé»˜è®¤ä½¿ç”¨ä¸Šçº§ã€‚

- `converter` è½¬æ¢å™¨ï¼Œé»˜è®¤åŠ è½½äº†å¾ˆå¤šè½¬æ¢å™¨ã€‚ä¹Ÿå¯ä»¥è‡ªå®šä¹‰ã€‚
- `writeHandler` å†™çš„å¤„ç†å™¨ã€‚å¯ä»¥å®ç°`WorkbookWriteHandler`,`SheetWriteHandler`,`RowWriteHandler`,`CellWriteHandler`ï¼Œåœ¨å†™å…¥excelçš„ä¸åŒé˜¶æ®µä¼šè°ƒç”¨
- `relativeHeadRowIndex` è·ç¦»å¤šå°‘è¡Œåå¼€å§‹ã€‚ä¹Ÿå°±æ˜¯å¼€å¤´ç©ºå‡ è¡Œ
- `needHead` æ˜¯å¦å¯¼å‡ºå¤´
- `head`  ä¸`clazz`äºŒé€‰ä¸€ã€‚å†™å…¥æ–‡ä»¶çš„å¤´åˆ—è¡¨ï¼Œå»ºè®®ä½¿ç”¨classã€‚
- `clazz` ä¸`head`äºŒé€‰ä¸€ã€‚å†™å…¥æ–‡ä»¶çš„å¤´å¯¹åº”çš„classï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æ³¨è§£ã€‚
- `autoTrim` å­—ç¬¦ä¸²ã€è¡¨å¤´ç­‰æ•°æ®è‡ªåŠ¨trim

#### WriteWorkbookï¼ˆç†è§£æˆexcelå¯¹è±¡ï¼‰å‚æ•°

- `excelType` å½“å‰excelçš„ç±»å‹ é»˜è®¤`xlsx`
- `outputStream` ä¸`file`äºŒé€‰ä¸€ã€‚å†™å…¥æ–‡ä»¶çš„æµ
- `file` ä¸`outputStream`äºŒé€‰ä¸€ã€‚å†™å…¥çš„æ–‡ä»¶
- `templateInputStream` æ¨¡æ¿çš„æ–‡ä»¶æµ
- `templateFile` æ¨¡æ¿æ–‡ä»¶
- `autoCloseStream` è‡ªåŠ¨å…³é—­æµã€‚
- `password` å†™çš„æ—¶å€™æ˜¯å¦éœ€è¦ä½¿ç”¨å¯†ç 
- `useDefaultStyle` å†™çš„æ—¶å€™æ˜¯å¦æ˜¯ä½¿ç”¨é»˜è®¤å¤´

#### WriteSheetï¼ˆå°±æ˜¯excelçš„ä¸€ä¸ªSheetï¼‰å‚æ•°

- `sheetNo` éœ€è¦å†™å…¥çš„ç¼–ç ã€‚é»˜è®¤0
- `sheetName` éœ€è¦äº›çš„Sheetåç§°ï¼Œé»˜è®¤åŒ`sheetNo`

#### WriteTableï¼ˆå°±æŠŠexcelçš„ä¸€ä¸ªSheet,ä¸€å—åŒºåŸŸçœ‹ä¸€ä¸ªtableï¼‰å‚æ•°

- `tableNo` éœ€è¦å†™å…¥çš„ç¼–ç ã€‚é»˜è®¤0

## å†™åœ¨æœ€å

æœ¬æ–‡åªæ˜¯ç”¨åˆ°éƒ¨åˆ†åŠŸèƒ½ï¼Œç®€å•çš„åšäº†ä¸€ä¸‹æ€»ç»“ï¼Œæ›´å¤šçš„åŠŸèƒ½ï¼Œå¯ä»¥å»å®˜ç½‘æŸ¥é˜…ã€‚

å®˜æ–¹æ–‡æ¡£ï¼šhttps://www.yuque.com/easyexcel/doc/read

ä½¿ç”¨EasyExcelå¯¼å…¥excelï¼š

## å…³äºç¬‘å°æ«ğŸ’•

> æœ¬ç« åˆ°è¿™é‡Œç»“æŸäº†ï¼Œå–œæ¬¢çš„æœ‹å‹å…³æ³¨ä¸€ä¸‹æˆ‘å‘¦ğŸ˜˜ğŸ˜˜ï¼Œå¤§ä¼™çš„æ”¯æŒï¼Œå°±æ˜¯æˆ‘åšæŒå†™ä¸‹å»çš„åŠ¨åŠ›ã€‚
> è€è§„çŸ©ï¼Œæ‡‚äº†å°±ç‚¹èµæ”¶è—ï¼›ä¸æ‡‚å°±é—®ï¼Œæ—¥å¸¸åœ¨çº¿ï¼Œæˆ‘ä¼šå°±ä¼šå›å¤å“ˆ~ğŸ¤ª
> åç»­æ–‡ç« ä¼šé™†ç»­æ›´æ–°ï¼Œæ–‡æ¡£ä¼šåŒæ­¥åœ¨å¾®ä¿¡å…¬ä¼—å·ã€ä¸ªäººåšå®¢ã€CSDNå’ŒGitHubä¿æŒåŒæ­¥æ›´æ–°ã€‚ğŸ˜¬
> å¾®ä¿¡å…¬ä¼—å·ï¼šç¬‘å°æ«
> ç¬‘å°æ«ä¸ªäººåšå®¢ï¼š[https://www.xiaoxiaofeng.com](https://www.xiaoxiaofeng.com)
> CSDNï¼š[https://zhangfz.blog.csdn.net](https://zhangfz.blog.csdn.net)
> æœ¬æ–‡æºç ï¼š[https://github.com/hack-feng/maple-demo](https://github.com/hack-feng/maple-demo) 
